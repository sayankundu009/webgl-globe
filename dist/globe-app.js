(function(){"use strict";Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&function(){Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!=null)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t}}();function Br(){}Object.assign(Br.prototype,{addEventListener:function(e,t){this._listeners===void 0&&(this._listeners={});var n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)},hasEventListener:function(e,t){if(this._listeners===void 0)return!1;var n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1},removeEventListener:function(e,t){if(this._listeners!==void 0){var n=this._listeners,r=n[e];if(r!==void 0){var a=r.indexOf(t);a!==-1&&r.splice(a,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var t=this._listeners,n=t[e.type];if(n!==void 0){e.target=this;for(var r=n.slice(0),a=0,s=r.length;a<s;a++)r[a].call(this,e)}}}});var Zd="88",Jd=0,qs=1,ic=2,Qd=0,ac=1,Kd=2,Pa=0,ri=1,Ia=2,sc=1,zu=0,oc=1,Di=2,Gu=0,Da=1,Hu=2,uc=3,fc=4,hc=5,cc=100,$d=101,ev=102,lc=103,pc=104,tv=200,nv=201,rv=202,iv=203,dc=204,vc=205,av=206,sv=207,ov=208,uv=209,fv=210,hv=0,cv=1,lv=2,Vu=3,pv=4,dv=5,vv=6,mv=7,js=0,gv=1,yv=2,Wu=0,mc=1,_v=2,xv=3,wv=4,ku=300,Xu=301,Yu=302,gc=303,qu=304,yc=305,ju=306,Zu=307,zr=1e3,Un=1001,Oi=1002,Fn=1003,Ju=1004,Qu=1005,En=1006,_c=1007,Zs=1008,Ku=1009,bv=1010,Ev=1011,Js=1012,Mv=1013,xc=1014,Oa=1015,$u=1016,Tv=1017,Sv=1018,Av=1019,Qs=1020,Lv=1021,Ua=1022,Gr=1023,Rv=1024,Cv=1025,Ui=1026,Fa=1027,wc=2001,bc=2002,Ec=2003,Mc=2004,Tc=2100,Sc=2101,Ac=2102,Lc=2103,Pv=2151,Iv=2200,Dv=2201,Ov=2202,Ks=2300,$s=2301,ef=2302,Fi=2400,Ni=2401,eo=2402,Rc=0,Uv=1,Fv=2,to=3e3,Nv=3001,Cc=3007,Bv=3002,zv=3004,Gv=3005,Hv=3006,Vv=3200,Wv=3201,Ke={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),t=0,n;return function(){for(var a="",s=0;s<36;s++)s===8||s===13||s===18||s===23?a+="-":s===14?a+="4":(t<=2&&(t=33554432+Math.random()*16777216|0),n=t&15,t=t>>4,a+=e[s===19?n&3|8:n]);return a}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,a){return r+(e-t)*(a-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(e*6-15)+10))},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Ke.DEG2RAD},radToDeg:function(e){return e*Ke.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function me(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(me.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(me.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new me,t=new me;return function(r,a){return e.set(r,r),t.set(a,a),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=this.x-e.x,s=this.y-e.y;return this.x=a*n-s*r+e.x,this.y=a*r+s*n+e.y,this}});function Ve(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Ve.prototype,{isMatrix4:!0,set:function(e,t,n,r,a,s,u,f,h,l,p,d,v,m,y,x){var b=this.elements;return b[0]=e,b[4]=t,b[8]=n,b[12]=r,b[1]=a,b[5]=s,b[9]=u,b[13]=f,b[2]=h,b[6]=l,b[10]=p,b[14]=d,b[3]=v,b[7]=m,b[11]=y,b[15]=x,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Ve().fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new I;return function(n){var r=this.elements,a=n.elements,s=1/e.setFromMatrixColumn(n,0).length(),u=1/e.setFromMatrixColumn(n,1).length(),f=1/e.setFromMatrixColumn(n,2).length();return r[0]=a[0]*s,r[1]=a[1]*s,r[2]=a[2]*s,r[4]=a[4]*u,r[5]=a[5]*u,r[6]=a[6]*u,r[8]=a[8]*f,r[9]=a[9]*f,r[10]=a[10]*f,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,a=e.z,s=Math.cos(n),u=Math.sin(n),f=Math.cos(r),h=Math.sin(r),l=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){var d=s*l,v=s*p,m=u*l,y=u*p;t[0]=f*l,t[4]=-f*p,t[8]=h,t[1]=v+m*h,t[5]=d-y*h,t[9]=-u*f,t[2]=y-d*h,t[6]=m+v*h,t[10]=s*f}else if(e.order==="YXZ"){var x=f*l,b=f*p,w=h*l,E=h*p;t[0]=x+E*u,t[4]=w*u-b,t[8]=s*h,t[1]=s*p,t[5]=s*l,t[9]=-u,t[2]=b*u-w,t[6]=E+x*u,t[10]=s*f}else if(e.order==="ZXY"){var x=f*l,b=f*p,w=h*l,E=h*p;t[0]=x-E*u,t[4]=-s*p,t[8]=w+b*u,t[1]=b+w*u,t[5]=s*l,t[9]=E-x*u,t[2]=-s*h,t[6]=u,t[10]=s*f}else if(e.order==="ZYX"){var d=s*l,v=s*p,m=u*l,y=u*p;t[0]=f*l,t[4]=m*h-v,t[8]=d*h+y,t[1]=f*p,t[5]=y*h+d,t[9]=v*h-m,t[2]=-h,t[6]=u*f,t[10]=s*f}else if(e.order==="YZX"){var T=s*f,M=s*h,P=u*f,O=u*h;t[0]=f*l,t[4]=O-T*p,t[8]=P*p+M,t[1]=p,t[5]=s*l,t[9]=-u*l,t[2]=-h*l,t[6]=M*p+P,t[10]=T-O*p}else if(e.order==="XZY"){var T=s*f,M=s*h,P=u*f,O=u*h;t[0]=f*l,t[4]=-p,t[8]=h*l,t[1]=T*p+O,t[5]=s*l,t[9]=M*p-P,t[2]=P*p-M,t[6]=u*l,t[10]=O*p+T}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,n=e._x,r=e._y,a=e._z,s=e._w,u=n+n,f=r+r,h=a+a,l=n*u,p=n*f,d=n*h,v=r*f,m=r*h,y=a*h,x=s*u,b=s*f,w=s*h;return t[0]=1-(v+y),t[4]=p-w,t[8]=d+b,t[1]=p+w,t[5]=1-(l+y),t[9]=m-x,t[2]=d-b,t[6]=m+x,t[10]=1-(l+v),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new I,t=new I,n=new I;return function(a,s,u){var f=this.elements;return n.subVectors(a,s),n.lengthSq()===0&&(n.z=1),n.normalize(),e.crossVectors(u,n),e.lengthSq()===0&&(Math.abs(u.z)===1?n.x+=1e-4:n.z+=1e-4,n.normalize(),e.crossVectors(u,n)),e.normalize(),t.crossVectors(n,e),f[0]=e.x,f[4]=t.x,f[8]=n.x,f[1]=e.y,f[5]=t.y,f[9]=n.y,f[2]=e.z,f[6]=t.z,f[10]=n.z,this}}(),multiply:function(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,a=this.elements,s=n[0],u=n[4],f=n[8],h=n[12],l=n[1],p=n[5],d=n[9],v=n[13],m=n[2],y=n[6],x=n[10],b=n[14],w=n[3],E=n[7],T=n[11],M=n[15],P=r[0],O=r[4],U=r[8],W=r[12],B=r[1],V=r[5],X=r[9],re=r[13],z=r[2],D=r[6],ee=r[10],K=r[14],te=r[3],$=r[7],ue=r[11],he=r[15];return a[0]=s*P+u*B+f*z+h*te,a[4]=s*O+u*V+f*D+h*$,a[8]=s*U+u*X+f*ee+h*ue,a[12]=s*W+u*re+f*K+h*he,a[1]=l*P+p*B+d*z+v*te,a[5]=l*O+p*V+d*D+v*$,a[9]=l*U+p*X+d*ee+v*ue,a[13]=l*W+p*re+d*K+v*he,a[2]=m*P+y*B+x*z+b*te,a[6]=m*O+y*V+x*D+b*$,a[10]=m*U+y*X+x*ee+b*ue,a[14]=m*W+y*re+x*K+b*he,a[3]=w*P+E*B+T*z+M*te,a[7]=w*O+E*V+T*D+M*$,a[11]=w*U+E*X+T*ee+M*ue,a[15]=w*W+E*re+T*K+M*he,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new I;return function(n){for(var r=0,a=n.count;r<a;r++)e.x=n.getX(r),e.y=n.getY(r),e.z=n.getZ(r),e.applyMatrix4(this),n.setXYZ(r,e.x,e.y,e.z);return n}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],a=e[12],s=e[1],u=e[5],f=e[9],h=e[13],l=e[2],p=e[6],d=e[10],v=e[14],m=e[3],y=e[7],x=e[11],b=e[15];return m*(+a*f*p-r*h*p-a*u*d+n*h*d+r*u*v-n*f*v)+y*(+t*f*v-t*h*d+a*s*d-r*s*v+r*h*l-a*f*l)+x*(+t*h*p-t*u*v-a*s*p+n*s*v+a*u*l-n*h*l)+b*(-r*u*l-t*f*p+t*u*d+r*s*p-n*s*d+n*f*l)},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,r=e.elements,a=r[0],s=r[1],u=r[2],f=r[3],h=r[4],l=r[5],p=r[6],d=r[7],v=r[8],m=r[9],y=r[10],x=r[11],b=r[12],w=r[13],E=r[14],T=r[15],M=m*E*d-w*y*d+w*p*x-l*E*x-m*p*T+l*y*T,P=b*y*d-v*E*d-b*p*x+h*E*x+v*p*T-h*y*T,O=v*w*d-b*m*d+b*l*x-h*w*x-v*l*T+h*m*T,U=b*m*p-v*w*p-b*l*y+h*w*y+v*l*E-h*m*E,W=a*M+s*P+u*O+f*U;if(W===0){var B="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(B);return console.warn(B),this.identity()}var V=1/W;return n[0]=M*V,n[1]=(w*y*f-m*E*f-w*u*x+s*E*x+m*u*T-s*y*T)*V,n[2]=(l*E*f-w*p*f+w*u*d-s*E*d-l*u*T+s*p*T)*V,n[3]=(m*p*f-l*y*f-m*u*d+s*y*d+l*u*x-s*p*x)*V,n[4]=P*V,n[5]=(v*E*f-b*y*f+b*u*x-a*E*x-v*u*T+a*y*T)*V,n[6]=(b*p*f-h*E*f-b*u*d+a*E*d+h*u*T-a*p*T)*V,n[7]=(h*y*f-v*p*f+v*u*d-a*y*d-h*u*x+a*p*x)*V,n[8]=O*V,n[9]=(b*m*f-v*w*f-b*s*x+a*w*x+v*s*T-a*m*T)*V,n[10]=(h*w*f-b*l*f+b*s*d-a*w*d-h*s*T+a*l*T)*V,n[11]=(v*l*f-h*m*f-v*s*d+a*m*d+h*s*x-a*l*x)*V,n[12]=U*V,n[13]=(v*w*u-b*m*u+b*s*y-a*w*y-v*s*E+a*m*E)*V,n[14]=(b*l*u-h*w*u-b*s*p+a*w*p+h*s*E-a*l*E)*V,n[15]=(h*m*u-v*l*u+v*s*p-a*m*p-h*s*y+a*l*y)*V,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,a=e.z;return t[0]*=n,t[4]*=r,t[8]*=a,t[1]*=n,t[5]*=r,t[9]*=a,t[2]*=n,t[6]*=r,t[10]*=a,t[3]*=n,t[7]*=r,t[11]*=a,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=1-n,s=e.x,u=e.y,f=e.z,h=a*s,l=a*u;return this.set(h*s+n,h*u-r*f,h*f+r*u,0,h*u+r*f,l*u+n,l*f-r*s,0,h*f-r*u,l*f+r*s,a*f*f+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:function(){var e=new I,t=new Ve;return function(r,a,s){var u=this.elements,f=e.set(u[0],u[1],u[2]).length(),h=e.set(u[4],u[5],u[6]).length(),l=e.set(u[8],u[9],u[10]).length(),p=this.determinant();p<0&&(f=-f),r.x=u[12],r.y=u[13],r.z=u[14],t.copy(this);var d=1/f,v=1/h,m=1/l;return t.elements[0]*=d,t.elements[1]*=d,t.elements[2]*=d,t.elements[4]*=v,t.elements[5]*=v,t.elements[6]*=v,t.elements[8]*=m,t.elements[9]*=m,t.elements[10]*=m,a.setFromRotationMatrix(t),s.x=f,s.y=h,s.z=l,this}}(),makePerspective:function(e,t,n,r,a,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var u=this.elements,f=2*a/(t-e),h=2*a/(n-r),l=(t+e)/(t-e),p=(n+r)/(n-r),d=-(s+a)/(s-a),v=-2*s*a/(s-a);return u[0]=f,u[4]=0,u[8]=l,u[12]=0,u[1]=0,u[5]=h,u[9]=p,u[13]=0,u[2]=0,u[6]=0,u[10]=d,u[14]=v,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this},makeOrthographic:function(e,t,n,r,a,s){var u=this.elements,f=1/(t-e),h=1/(n-r),l=1/(s-a),p=(t+e)*f,d=(n+r)*h,v=(s+a)*l;return u[0]=2*f,u[4]=0,u[8]=0,u[12]=-p,u[1]=0,u[5]=2*h,u[9]=0,u[13]=-d,u[2]=0,u[6]=0,u[10]=-2*l,u[14]=-v,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});function qt(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=r!==void 0?r:1}Object.assign(qt,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,a,s,u){var f=n[r+0],h=n[r+1],l=n[r+2],p=n[r+3],d=a[s+0],v=a[s+1],m=a[s+2],y=a[s+3];if(p!==y||f!==d||h!==v||l!==m){var x=1-u,b=f*d+h*v+l*m+p*y,w=b>=0?1:-1,E=1-b*b;if(E>Number.EPSILON){var T=Math.sqrt(E),M=Math.atan2(T,b*w);x=Math.sin(x*M)/T,u=Math.sin(u*M)/T}var P=u*w;if(f=f*x+d*P,h=h*x+v*P,l=l*x+m*P,p=p*x+y*P,x===1-u){var O=1/Math.sqrt(f*f+h*h+l*l+p*p);f*=O,h*=O,l*=O,p*=O}}e[t]=f,e[t+1]=h,e[t+2]=l,e[t+3]=p}}),Object.defineProperties(qt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(qt.prototype,{set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,a=e._z,s=e.order,u=Math.cos,f=Math.sin,h=u(n/2),l=u(r/2),p=u(a/2),d=f(n/2),v=f(r/2),m=f(a/2);return s==="XYZ"?(this._x=d*l*p+h*v*m,this._y=h*v*p-d*l*m,this._z=h*l*m+d*v*p,this._w=h*l*p-d*v*m):s==="YXZ"?(this._x=d*l*p+h*v*m,this._y=h*v*p-d*l*m,this._z=h*l*m-d*v*p,this._w=h*l*p+d*v*m):s==="ZXY"?(this._x=d*l*p-h*v*m,this._y=h*v*p+d*l*m,this._z=h*l*m+d*v*p,this._w=h*l*p-d*v*m):s==="ZYX"?(this._x=d*l*p-h*v*m,this._y=h*v*p+d*l*m,this._z=h*l*m-d*v*p,this._w=h*l*p+d*v*m):s==="YZX"?(this._x=d*l*p+h*v*m,this._y=h*v*p+d*l*m,this._z=h*l*m-d*v*p,this._w=h*l*p-d*v*m):s==="XZY"&&(this._x=d*l*p-h*v*m,this._y=h*v*p-d*l*m,this._z=h*l*m+d*v*p,this._w=h*l*p+d*v*m),t!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t=e.elements,n=t[0],r=t[4],a=t[8],s=t[1],u=t[5],f=t[9],h=t[2],l=t[6],p=t[10],d=n+u+p,v;return d>0?(v=.5/Math.sqrt(d+1),this._w=.25/v,this._x=(l-f)*v,this._y=(a-h)*v,this._z=(s-r)*v):n>u&&n>p?(v=2*Math.sqrt(1+n-u-p),this._w=(l-f)/v,this._x=.25*v,this._y=(r+s)/v,this._z=(a+h)/v):u>p?(v=2*Math.sqrt(1+u-n-p),this._w=(a-h)/v,this._x=(r+s)/v,this._y=.25*v,this._z=(f+l)/v):(v=2*Math.sqrt(1+p-n-u),this._w=(s-r)/v,this._x=(a+h)/v,this._y=(f+l)/v,this._z=.25*v),this.onChangeCallback(),this},setFromUnitVectors:function(){var e=new I,t,n=1e-6;return function(a,s){return e===void 0&&(e=new I),t=a.dot(s)+1,t<n?(t=0,Math.abs(a.x)>Math.abs(a.z)?e.set(-a.y,a.x,0):e.set(0,-a.z,a.y)):e.crossVectors(a,s),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,a=e._z,s=e._w,u=t._x,f=t._y,h=t._z,l=t._w;return this._x=n*l+s*u+r*h-a*f,this._y=r*l+s*f+a*u-n*h,this._z=a*l+s*h+n*f-r*u,this._w=s*l-n*u-r*f-a*h,this.onChangeCallback(),this},slerp:function(e,t){if(t===0)return this;if(t===1)return this.copy(e);var n=this._x,r=this._y,a=this._z,s=this._w,u=s*e._w+n*e._x+r*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=s,this._x=n,this._y=r,this._z=a,this;var f=Math.sqrt(1-u*u);if(Math.abs(f)<.001)return this._w=.5*(s+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(a+this._z),this;var h=Math.atan2(f,u),l=Math.sin((1-t)*h)/f,p=Math.sin(t*h)/f;return this._w=s*l+this._w*p,this._x=n*l+this._x*p,this._y=r*l+this._y*p,this._z=a*l+this._z*p,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return t===void 0&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}});function I(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}Object.assign(I.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new qt;return function(n){return n&&n.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(n))}}(),applyAxisAngle:function(){var e=new qt;return function(n,r){return this.applyQuaternion(e.setFromAxisAngle(n,r))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*r,this.y=a[1]*t+a[4]*n+a[7]*r,this.z=a[2]*t+a[5]*n+a[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements,s=1/(a[3]*t+a[7]*n+a[11]*r+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*r+a[12])*s,this.y=(a[1]*t+a[5]*n+a[9]*r+a[13])*s,this.z=(a[2]*t+a[6]*n+a[10]*r+a[14])*s,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,a=e.x,s=e.y,u=e.z,f=e.w,h=f*t+s*r-u*n,l=f*n+u*t-a*r,p=f*r+a*n-s*t,d=-a*t-s*n-u*r;return this.x=h*f+d*-a+l*-u-p*-s,this.y=l*f+d*-s+p*-a-h*-u,this.z=p*f+d*-u+h*-s-l*-a,this},project:function(){var e=new Ve;return function(n){return e.multiplyMatrices(n.projectionMatrix,e.getInverse(n.matrixWorld)),this.applyMatrix4(e)}}(),unproject:function(){var e=new Ve;return function(n){return e.multiplyMatrices(n.matrixWorld,e.getInverse(n.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r,this.y=a[1]*t+a[5]*n+a[9]*r,this.z=a[2]*t+a[6]*n+a[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new I,t=new I;return function(r,a){return e.set(r,r,r),t.set(a,a,a),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,a=e.z,s=t.x,u=t.y,f=t.z;return this.x=r*f-a*u,this.y=a*s-n*f,this.z=n*u-r*s,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new I;return function(n){return e.copy(this).projectOnVector(n),this.sub(e)}}(),reflect:function(){var e=new I;return function(n){return this.sub(e.copy(n).multiplyScalar(2*this.dot(n)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Ke.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,t*4)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});function Mn(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Mn.prototype,{isMatrix3:!0,set:function(e,t,n,r,a,s,u,f,h){var l=this.elements;return l[0]=e,l[1]=r,l[2]=u,l[3]=t,l[4]=a,l[5]=f,l[6]=n,l[7]=s,l[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new I;return function(n){for(var r=0,a=n.count;r<a;r++)e.x=n.getX(r),e.y=n.getY(r),e.z=n.getZ(r),e.applyMatrix3(this),n.setXYZ(r,e.x,e.y,e.z);return n}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,a=this.elements,s=n[0],u=n[3],f=n[6],h=n[1],l=n[4],p=n[7],d=n[2],v=n[5],m=n[8],y=r[0],x=r[3],b=r[6],w=r[1],E=r[4],T=r[7],M=r[2],P=r[5],O=r[8];return a[0]=s*y+u*w+f*M,a[3]=s*x+u*E+f*P,a[6]=s*b+u*T+f*O,a[1]=h*y+l*w+p*M,a[4]=h*x+l*E+p*P,a[7]=h*b+l*T+p*O,a[2]=d*y+v*w+m*M,a[5]=d*x+v*E+m*P,a[8]=d*b+v*T+m*O,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],s=e[4],u=e[5],f=e[6],h=e[7],l=e[8];return t*s*l-t*u*h-n*a*l+n*u*f+r*a*h-r*s*f},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,a=n[0],s=n[1],u=n[2],f=n[3],h=n[4],l=n[5],p=n[6],d=n[7],v=n[8],m=v*h-l*d,y=l*p-v*f,x=d*f-h*p,b=a*m+s*y+u*x;if(b===0){var w="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(w);return console.warn(w),this.identity()}var E=1/b;return r[0]=m*E,r[1]=(u*d-v*s)*E,r[2]=(l*s-u*h)*E,r[3]=y*E,r[4]=(v*a-u*p)*E,r[5]=(u*f-l*a)*E,r[6]=x*E,r[7]=(s*p-d*a)*E,r[8]=(h*a-s*f)*E,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,a,s,u){var f=Math.cos(a),h=Math.sin(a);this.set(n*f,n*h,-n*(f*s+h*u)+s+e,-r*h,r*f,-r*(-h*s+f*u)+u+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,a=r[0],s=r[3],u=r[6],f=r[1],h=r[4],l=r[7];return r[0]=t*a+n*f,r[3]=t*s+n*h,r[6]=t*u+n*l,r[1]=-n*a+t*f,r[4]=-n*s+t*h,r[7]=-n*u+t*l,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var kv=0;function Ut(e,t,n,r,a,s,u,f,h,l){Object.defineProperty(this,"id",{value:kv++}),this.uuid=Ke.generateUUID(),this.name="",this.image=e!==void 0?e:Ut.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=t!==void 0?t:Ut.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:Un,this.wrapT=r!==void 0?r:Un,this.magFilter=a!==void 0?a:En,this.minFilter=s!==void 0?s:Zs,this.anisotropy=h!==void 0?h:1,this.format=u!==void 0?u:Gr,this.type=f!==void 0?f:Ku,this.offset=new me(0,0),this.repeat=new me(1,1),this.center=new me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=l!==void 0?l:to,this.version=0,this.onUpdate=null}Ut.DEFAULT_IMAGE=void 0,Ut.DEFAULT_MAPPING=ku,Object.defineProperty(Ut.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(Ut.prototype,Br.prototype,{constructor:Ut,isTexture:!0,clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];function n(s){var u;if(s instanceof HTMLCanvasElement)u=s;else{u=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),u.width=s.width,u.height=s.height;var f=u.getContext("2d");s instanceof ImageData?f.putImageData(s,0,0):f.drawImage(s,0,0,s.width,s.height)}return u.width>2048||u.height>2048?u.toDataURL("image/jpeg",.6):u.toDataURL("image/png")}var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(this.image!==void 0){var a=this.image;a.uuid===void 0&&(a.uuid=Ke.generateUUID()),!t&&e.images[a.uuid]===void 0&&(e.images[a.uuid]={uuid:a.uuid,url:n(a)}),r.image=a.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===ku){if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case zr:e.x=e.x-Math.floor(e.x);break;case Un:e.x=e.x<0?0:1;break;case Oi:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case zr:e.y=e.y-Math.floor(e.y);break;case Un:e.y=e.y<0?0:1;break;case Oi:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}this.flipY&&(e.y=1-e.y)}}});function At(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=r!==void 0?r:1}Object.assign(At.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,a=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r+s[12]*a,this.y=s[1]*t+s[5]*n+s[9]*r+s[13]*a,this.z=s[2]*t+s[6]*n+s[10]*r+s[14]*a,this.w=s[3]*t+s[7]*n+s[11]*r+s[15]*a,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,a,s=.01,u=.1,f=e.elements,h=f[0],l=f[4],p=f[8],d=f[1],v=f[5],m=f[9],y=f[2],x=f[6],b=f[10];if(Math.abs(l-d)<s&&Math.abs(p-y)<s&&Math.abs(m-x)<s){if(Math.abs(l+d)<u&&Math.abs(p+y)<u&&Math.abs(m+x)<u&&Math.abs(h+v+b-3)<u)return this.set(1,0,0,0),this;t=Math.PI;var w=(h+1)/2,E=(v+1)/2,T=(b+1)/2,M=(l+d)/4,P=(p+y)/4,O=(m+x)/4;return w>E&&w>T?w<s?(n=0,r=.707106781,a=.707106781):(n=Math.sqrt(w),r=M/n,a=P/n):E>T?E<s?(n=.707106781,r=0,a=.707106781):(r=Math.sqrt(E),n=M/r,a=O/r):T<s?(n=.707106781,r=.707106781,a=0):(a=Math.sqrt(T),n=P/a,r=O/a),this.set(n,r,a,t),this}var U=Math.sqrt((x-m)*(x-m)+(p-y)*(p-y)+(d-l)*(d-l));return Math.abs(U)<.001&&(U=1),this.x=(x-m)/U,this.y=(p-y)/U,this.z=(d-l)/U,this.w=Math.acos((h+v+b-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(r,a){return e===void 0&&(e=new At,t=new At),e.set(r,r,r,r),t.set(a,a,a,a),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}});function Na(e,t,n){this.uuid=Ke.generateUUID(),this.width=e,this.height=t,this.scissor=new At(0,0,e,t),this.scissorTest=!1,this.viewport=new At(0,0,e,t),n=n||{},n.minFilter===void 0&&(n.minFilter=En),this.texture=new Ut(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!0,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}Object.assign(Na.prototype,Br.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Ba(e,t,n){Na.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}Ba.prototype=Object.create(Na.prototype),Ba.prototype.constructor=Ba,Ba.prototype.isWebGLRenderTargetCube=!0;function Bi(e,t,n,r,a,s,u,f,h,l,p,d){Ut.call(this,null,s,u,f,h,l,r,a,p,d),this.image={data:e,width:t,height:n},this.magFilter=h!==void 0?h:Fn,this.minFilter=l!==void 0?l:Fn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}Bi.prototype=Object.create(Ut.prototype),Bi.prototype.constructor=Bi,Bi.prototype.isDataTexture=!0;function ii(e,t,n,r,a,s,u,f,h,l){e=e!==void 0?e:[],t=t!==void 0?t:Xu,Ut.call(this,e,t,n,r,a,s,u,f,h,l),this.flipY=!1}ii.prototype=Object.create(Ut.prototype),ii.prototype.constructor=ii,ii.prototype.isCubeTexture=!0,Object.defineProperty(ii.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Pc=new Ut,Ic=new ii;function Dc(){this.seq=[],this.map={}}var Oc=[],Uc=[],Fc=new Float32Array(16),Nc=new Float32Array(9);function zi(e,t,n){var r=e[0];if(r<=0||r>0)return e;var a=t*n,s=Oc[a];if(s===void 0&&(s=new Float32Array(a),Oc[a]=s),t!==0){r.toArray(s,0);for(var u=1,f=0;u!==t;++u)f+=n,e[u].toArray(s,f)}return s}function Bc(e,t){var n=Uc[t];n===void 0&&(n=new Int32Array(t),Uc[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocTextureUnit();return n}function Xv(e,t){e.uniform1f(this.addr,t)}function Yv(e,t){e.uniform1i(this.addr,t)}function qv(e,t){t.x===void 0?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function jv(e,t){t.x!==void 0?e.uniform3f(this.addr,t.x,t.y,t.z):t.r!==void 0?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function Zv(e,t){t.x===void 0?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function Jv(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function Qv(e,t){t.elements===void 0?e.uniformMatrix3fv(this.addr,!1,t):(Nc.set(t.elements),e.uniformMatrix3fv(this.addr,!1,Nc))}function Kv(e,t){t.elements===void 0?e.uniformMatrix4fv(this.addr,!1,t):(Fc.set(t.elements),e.uniformMatrix4fv(this.addr,!1,Fc))}function $v(e,t,n){var r=n.allocTextureUnit();e.uniform1i(this.addr,r),n.setTexture2D(t||Pc,r)}function em(e,t,n){var r=n.allocTextureUnit();e.uniform1i(this.addr,r),n.setTextureCube(t||Ic,r)}function zc(e,t){e.uniform2iv(this.addr,t)}function Gc(e,t){e.uniform3iv(this.addr,t)}function Hc(e,t){e.uniform4iv(this.addr,t)}function tm(e){switch(e){case 5126:return Xv;case 35664:return qv;case 35665:return jv;case 35666:return Zv;case 35674:return Jv;case 35675:return Qv;case 35676:return Kv;case 35678:case 36198:return $v;case 35680:return em;case 5124:case 35670:return Yv;case 35667:case 35671:return zc;case 35668:case 35672:return Gc;case 35669:case 35673:return Hc}}function nm(e,t){e.uniform1fv(this.addr,t)}function rm(e,t){e.uniform1iv(this.addr,t)}function im(e,t){e.uniform2fv(this.addr,zi(t,this.size,2))}function am(e,t){e.uniform3fv(this.addr,zi(t,this.size,3))}function sm(e,t){e.uniform4fv(this.addr,zi(t,this.size,4))}function om(e,t){e.uniformMatrix2fv(this.addr,!1,zi(t,this.size,4))}function um(e,t){e.uniformMatrix3fv(this.addr,!1,zi(t,this.size,9))}function fm(e,t){e.uniformMatrix4fv(this.addr,!1,zi(t,this.size,16))}function hm(e,t,n){var r=t.length,a=Bc(n,r);e.uniform1iv(this.addr,a);for(var s=0;s!==r;++s)n.setTexture2D(t[s]||Pc,a[s])}function cm(e,t,n){var r=t.length,a=Bc(n,r);e.uniform1iv(this.addr,a);for(var s=0;s!==r;++s)n.setTextureCube(t[s]||Ic,a[s])}function lm(e){switch(e){case 5126:return nm;case 35664:return im;case 35665:return am;case 35666:return sm;case 35674:return om;case 35675:return um;case 35676:return fm;case 35678:return hm;case 35680:return cm;case 5124:case 35670:return rm;case 35667:case 35671:return zc;case 35668:case 35672:return Gc;case 35669:case 35673:return Hc}}function pm(e,t,n){this.id=e,this.addr=n,this.setValue=tm(t.type)}function dm(e,t,n){this.id=e,this.addr=n,this.size=t.size,this.setValue=lm(t.type)}function Vc(e){this.id=e,Dc.call(this)}Vc.prototype.setValue=function(e,t){for(var n=this.seq,r=0,a=n.length;r!==a;++r){var s=n[r];s.setValue(e,t[s.id])}};var tf=/([\w\d_]+)(\])?(\[|\.)?/g;function Wc(e,t){e.seq.push(t),e.map[t.id]=t}function vm(e,t,n){var r=e.name,a=r.length;for(tf.lastIndex=0;;){var s=tf.exec(r),u=tf.lastIndex,f=s[1],h=s[2]==="]",l=s[3];if(h&&(f=f|0),l===void 0||l==="["&&u+2===a){Wc(n,l===void 0?new pm(f,e,t):new dm(f,e,t));break}else{var p=n.map,d=p[f];d===void 0&&(d=new Vc(f),Wc(n,d)),n=d}}}function ai(e,t,n){Dc.call(this),this.renderer=n;for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),a=0;a<r;++a){var s=e.getActiveUniform(t,a),u=s.name,f=e.getUniformLocation(t,u);vm(s,f,this)}}ai.prototype.setValue=function(e,t,n){var r=this.map[t];r!==void 0&&r.setValue(e,n,this.renderer)},ai.prototype.setOptional=function(e,t,n){var r=t[n];r!==void 0&&this.setValue(e,n,r)},ai.upload=function(e,t,n,r){for(var a=0,s=t.length;a!==s;++a){var u=t[a],f=n[u.id];f.needsUpdate!==!1&&u.setValue(e,f.value,r)}},ai.seqWithValue=function(e,t){for(var n=[],r=0,a=e.length;r!==a;++r){var s=e[r];s.id in t&&n.push(s)}return n};var mm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ue(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}Object.assign(Ue.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(t,n,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(n-t)*6*r:r<1/2?n:r<2/3?t+(n-t)*6*(2/3-r):t}return function(n,r,a){if(n=Ke.euclideanModulo(n,1),r=Ke.clamp(r,0,1),a=Ke.clamp(a,0,1),r===0)this.r=this.g=this.b=a;else{var s=a<=.5?a*(1+r):a+r-a*r,u=2*a-s;this.r=e(u,s,n+1/3),this.g=e(u,s,n),this.b=e(u,s,n-1/3)}return this}}(),setStyle:function(e){function t(d){d!==void 0&&parseFloat(d)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,a=n[1],s=n[2];switch(a){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){var u=parseFloat(r[1])/360,f=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(u,f,h)}break}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var l=n[1],p=l.length;if(p===3)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(p===6)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}if(e&&e.length>0){var l=mm[e];l!==void 0?this.setHex(l):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return t===void 0&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){t===void 0&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t=e||{h:0,s:0,l:0},n=this.r,r=this.g,a=this.b,s=Math.max(n,r,a),u=Math.min(n,r,a),f,h,l=(u+s)/2;if(u===s)f=0,h=0;else{var p=s-u;switch(h=l<=.5?p/(s+u):p/(2-s-u),s){case n:f=(r-a)/p+(r<a?6:0);break;case r:f=(a-n)/p+2;break;case a:f=(n-r)/p+4;break}f/=6}return t.h=f,t.s=h,t.l=l,t},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(e,t,n){var r=this.getHSL();return r.h+=e,r.s+=t,r.l+=n,this.setHSL(r.h,r.s,r.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return t===void 0&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Fe={common:{diffuse:{value:new Ue(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Mn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new me(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ue(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Ue(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Mn}}},Tn={merge:function(e){for(var t={},n=0;n<e.length;n++){var r=this.clone(e[n]);for(var a in r)t[a]=r[a]}return t},clone:function(e){var t={};for(var n in e){t[n]={};for(var r in e[n]){var a=e[n][r];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture)?t[n][r]=a.clone():Array.isArray(a)?t[n][r]=a.slice():t[n][r]=a}}return t}},gm=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif
`,ym=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif
`,_m=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif
`,xm=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( PHYSICAL )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif
`,wm=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,bm=`
vec3 transformed = vec3( position );
`,Em=`
vec3 objectNormal = vec3( normal );
`,Mm=`float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	if( decayExponent > 0.0 ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		float maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		return distanceFalloff * maxDistanceCutoffFactor;
#else
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
#endif
	}
	return 1.0;
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float theta = acos( dot( N, V ) );
	vec2 uv = vec2(
		sqrt( saturate( roughness ) ),
		saturate( theta / ( 0.5 * PI ) ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.86267 + (0.49788 + 0.01436 * y ) * y;
	float b = 3.45068 + (4.18814 + y) * y;
	float v = a / b;
	float theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	vec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );
	return result;
}
vec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;
	return specularColor * AB.x + AB.y;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
`,Tm=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif
`,Sm=`#if NUM_CLIPPING_PLANES > 0
	for ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {
		vec4 plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
		
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {
			vec4 plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	
	#endif
#endif
`,Am=`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( PHYSICAL ) && ! defined( PHONG )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif
`,Lm=`#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )
	varying vec3 vViewPosition;
#endif
`,Rm=`#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )
	vViewPosition = - mvPosition.xyz;
#endif
`,Cm=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,Pm=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif
`,Im=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,Dm=`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,Om=`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#define saturate(a) clamp( a, 0.0, 1.0 )
#define whiteCompliment(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
`,Um=`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_textureSize (1024.0)
int getFaceFromDirection(vec3 direction) {
	vec3 absDirection = abs(direction);
	int face = -1;
	if( absDirection.x > absDirection.z ) {
		if(absDirection.x > absDirection.y )
			face = direction.x > 0.0 ? 0 : 3;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	else {
		if(absDirection.z > absDirection.y )
			face = direction.z > 0.0 ? 2 : 5;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	return face;
}
#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)
#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))
vec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {
	float scale = exp2(cubeUV_maxLods1 - roughnessLevel);
	float dxRoughness = dFdx(roughness);
	float dyRoughness = dFdy(roughness);
	vec3 dx = dFdx( vec * scale * dxRoughness );
	vec3 dy = dFdy( vec * scale * dyRoughness );
	float d = max( dot( dx, dx ), dot( dy, dy ) );
	d = clamp(d, 1.0, cubeUV_rangeClamp);
	float mipLevel = 0.5 * log2(d);
	return vec2(floor(mipLevel), fract(mipLevel));
}
#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)
#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)
vec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {
	mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;
	float a = 16.0 * cubeUV_rcpTextureSize;
	vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );
	vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;
	float powScale = exp2_packed.x * exp2_packed.y;
	float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;
	float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;
	bool bRes = mipLevel == 0.0;
	scale =  bRes && (scale < a) ? a : scale;
	vec3 r;
	vec2 offset;
	int face = getFaceFromDirection(direction);
	float rcpPowScale = 1.0 / powScale;
	if( face == 0) {
		r = vec3(direction.x, -direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 1) {
		r = vec3(direction.y, direction.x, direction.z);
		offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 2) {
		r = vec3(direction.z, direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 3) {
		r = vec3(direction.x, direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else if( face == 4) {
		r = vec3(direction.y, direction.x, -direction.z);
		offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else {
		r = vec3(direction.z, -direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	r = normalize(r);
	float texelOffset = 0.5 * cubeUV_rcpTextureSize;
	vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;
	vec2 base = offset + vec2( texelOffset );
	return base + s * ( scale - 2.0 * texelOffset );
}
#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)
vec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {
	float roughnessVal = roughness* cubeUV_maxLods3;
	float r1 = floor(roughnessVal);
	float r2 = r1 + 1.0;
	float t = fract(roughnessVal);
	vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);
	float s = mipInfo.y;
	float level0 = mipInfo.x;
	float level1 = level0 + 1.0;
	level1 = level1 > 5.0 ? 5.0 : level1;
	level0 += min( floor( s + 0.5 ), 5.0 );
	vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);
	vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));
	vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);
	vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));
	vec4 result = mix(color10, color20, t);
	return vec4(result.rgb, 1.0);
}
#endif
`,Fm=`vec3 transformedNormal = normalMatrix * objectNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
`,Nm=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif
`,Bm=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );
#endif
`,zm=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif
`,Gm=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif
`,Hm=`  gl_FragColor = linearToOutputTexel( gl_FragColor );
`,Vm=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.xyz * value.w * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.x, max( value.g, value.b ) );
	float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M            = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.x, max( value.g, value.b ) );
	float D      = max( maxRange / maxRGB, 1.0 );
	D            = min( floor( D ) / 255.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;
	Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract(Le);
	vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;
	return vec4( max(vRGB, 0.0), 1.0 );
}
`,Wm=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToVertex, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	envColor = envMapTexelToLinear( envColor );
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif
`,km=`#if defined( USE_ENVMAP ) || defined( PHYSICAL )
	uniform float reflectivity;
	uniform float envMapIntensity;
#endif
#ifdef USE_ENVMAP
	#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )
		varying vec3 vWorldPosition;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	uniform float flipEnvMap;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif
`,Xm=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif
`,Ym=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif
`,qm=`
#ifdef USE_FOG
fogDepth = -mvPosition.z;
#endif`,jm=`#ifdef USE_FOG
  varying float fogDepth;
#endif
`,Zm=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif
`,Jm=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif
`,Qm=`#ifdef TOON
	uniform sampler2D gradientMap;
	vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
		float dotNL = dot( normal, lightDirection );
		vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
		#ifdef USE_GRADIENTMAP
			return texture2D( gradientMap, coord ).rgb;
		#else
			return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
		#endif
	}
#endif
`,Km=`#ifdef USE_LIGHTMAP
	reflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
#endif
`,$m=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,eg=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif
`,tg=`uniform vec3 ambientLightColor;
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltcMat;	uniform sampler2D ltcMag;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif
#if defined( USE_ENVMAP ) && defined( PHYSICAL )
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			vec4 envMapColor = textureCubeUV( queryVec, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );
		#else
			vec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			vec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif
`,ng=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,rg=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	#ifdef TOON
		vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#else
		float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
		vec3 irradiance = dotNL * directLight.color;
	#endif
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)
`,ig=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );
#ifdef STANDARD
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
	material.clearCoat = saturate( clearCoat );	material.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );
#endif
`,ag=`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
	#ifndef STANDARD
		float clearCoat;
		float clearCoatRoughness;
	#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearCoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos - halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos + halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos + halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos - halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		float norm = texture2D( ltcMag, uv ).a;
		vec4 t = texture2D( ltcMat, uv );
		mat3 mInv = mat3(
			vec3(   1,   0, t.y ),
			vec3(   0, t.z,   0 ),
			vec3( t.w,   0, t.x )
		);
		reflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifndef STANDARD
		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );
	#else
		float clearCoatDHR = 0.0;
	#endif
	reflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );
	reflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	#ifndef STANDARD
		reflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );
	#endif
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	#ifndef STANDARD
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		float dotNL = dotNV;
		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );
	#else
		float clearCoatDHR = 0.0;
	#endif
	reflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );
	#ifndef STANDARD
		reflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );
	#endif
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )
#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}
`,sg=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = normalize( vViewPosition );
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#ifdef USE_LIGHTMAP
		vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
	#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )
		irradiance += getLightProbeIndirectIrradiance( geometry, 8 );
	#endif
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	vec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );
	#ifndef STANDARD
		vec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );
	#else
		vec3 clearCoatRadiance = vec3( 0.0 );
	#endif
	RE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );
#endif
`,og=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ug=`#ifdef USE_LOGDEPTHBUF
	uniform float logDepthBufFC;
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
	#endif
#endif
`,fg=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
	#endif
	uniform float logDepthBufFC;
#endif`,hg=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
	#else
		gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
		gl_Position.z *= gl_Position.w;
	#endif
#endif
`,cg=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif
`,lg=`#ifdef USE_MAP
	uniform sampler2D map;
#endif
`,pg=`#ifdef USE_MAP
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
`,dg=`#ifdef USE_MAP
	uniform mat3 uvTransform;
	uniform sampler2D map;
#endif
`,vg=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif
`,mg=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,gg=`#ifdef USE_MORPHNORMALS
	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];
	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];
	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];
	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];
#endif
`,yg=`#ifdef USE_MORPHTARGETS
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,_g=`#ifdef USE_MORPHTARGETS
	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];
	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];
	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];
	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];
	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];
	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];
	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];
	#endif
#endif
`,xg=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
#endif
#ifdef USE_NORMALMAP
	normal = perturbNormal2Arb( -vViewPosition, normal );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif
`,wg=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 S = normalize( q0 * st1.t - q1 * st0.t );
		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );
		vec3 N = normalize( surf_norm );
		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
		mapN.xy = normalScale * mapN.xy;
		mat3 tsn = mat3( S, T, N );
		return normalize( tsn * mapN );
	}
#endif
`,bg=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`,Eg=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif
`,Mg=`vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );
gl_Position = projectionMatrix * mvPosition;
`,Tg=`#if defined( DITHERING )
  gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif
`,Sg=`#if defined( DITHERING )
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif
`,Ag=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif
`,Lg=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Rg=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];
	#endif
	#if NUM_SPOT_LIGHTS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];
	#endif
	#if NUM_POINT_LIGHTS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {
		const vec2 offset = vec2( 0.0, 1.0 );
		vec2 texelSize = vec2( 1.0 ) / size;
		vec2 centroidUV = floor( uv * size + 0.5 ) / size;
		float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );
		float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );
		float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );
		float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );
		vec2 f = fract( uv * size + 0.5 );
		float a = mix( lb, lt, f.y );
		float b = mix( rb, rt, f.y );
		float c = mix( a, b, f.x );
		return c;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			shadow = (
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 9.0 );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif
`,Cg=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];
	#endif
	#if NUM_SPOT_LIGHTS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];
	#endif
	#if NUM_POINT_LIGHTS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];
	#endif
#endif
`,Pg=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHTS > 0
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHTS > 0
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif
`,Ig=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
	DirectionalLight directionalLight;
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHTS > 0
	SpotLight spotLight;
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHTS > 0
	PointLight pointLight;
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}
`,Dg=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Og=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif
`,Ug=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif
`,Fg=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
#endif
`,Ng=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Bg=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,zg=`#if defined( TONE_MAPPING )
  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif
`,Gg=`#ifndef saturate
	#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
`,Hg=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	varying vec2 vUv;
#endif`,Vg=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
`,Wg=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,kg=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Xg=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
#endif`,Yg=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = uv2;
#endif`,qg=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );
#endif
`,jg=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldPosition;
void main() {
	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );
	gl_FragColor.a *= opacity;
}
`,Zg=`varying vec3 vWorldPosition;
#include <common>
void main() {
	vWorldPosition = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}
`,Jg=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}
`,Qg=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}
`,Kg=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}
`,$g=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}
`,ey=`uniform sampler2D tEquirect;
varying vec3 vWorldPosition;
#include <common>
void main() {
	vec3 direction = normalize( vWorldPosition );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	gl_FragColor = texture2D( tEquirect, sampleUV );
}
`,ty=`varying vec3 vWorldPosition;
#include <common>
void main() {
	vWorldPosition = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}
`,ny=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,ry=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}
`,iy=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		reflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,ay=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}
`,sy=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <bsdfs>
#include <lights_pars>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,oy=`#define LAMBERT
varying vec3 vLightFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,uy=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_template>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,fy=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,hy=`#define PHYSICAL
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifndef STANDARD
	uniform float clearCoat;
	uniform float clearCoatRoughness;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <lights_pars>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_template>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,cy=`#define PHYSICAL
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,ly=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	#include <normal_fragment>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}
`,py=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}
`,dy=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <packing>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,vy=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <project_vertex>
	#ifdef USE_SIZEATTENUATION
		gl_PointSize = size * ( scale / - mvPosition.z );
	#else
		gl_PointSize = size;
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,my=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <fog_fragment>
}
`,gy=`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,wt={alphamap_fragment:gm,alphamap_pars_fragment:ym,alphatest_fragment:_m,aomap_fragment:xm,aomap_pars_fragment:wm,begin_vertex:bm,beginnormal_vertex:Em,bsdfs:Mm,bumpmap_pars_fragment:Tm,clipping_planes_fragment:Sm,clipping_planes_pars_fragment:Am,clipping_planes_pars_vertex:Lm,clipping_planes_vertex:Rm,color_fragment:Cm,color_pars_fragment:Pm,color_pars_vertex:Im,color_vertex:Dm,common:Om,cube_uv_reflection_fragment:Um,defaultnormal_vertex:Fm,displacementmap_pars_vertex:Nm,displacementmap_vertex:Bm,emissivemap_fragment:zm,emissivemap_pars_fragment:Gm,encodings_fragment:Hm,encodings_pars_fragment:Vm,envmap_fragment:Wm,envmap_pars_fragment:km,envmap_pars_vertex:Xm,envmap_vertex:Ym,fog_vertex:qm,fog_pars_vertex:jm,fog_fragment:Zm,fog_pars_fragment:Jm,gradientmap_pars_fragment:Qm,lightmap_fragment:Km,lightmap_pars_fragment:$m,lights_lambert_vertex:eg,lights_pars:tg,lights_phong_fragment:ng,lights_phong_pars_fragment:rg,lights_physical_fragment:ig,lights_physical_pars_fragment:ag,lights_template:sg,logdepthbuf_fragment:og,logdepthbuf_pars_fragment:ug,logdepthbuf_pars_vertex:fg,logdepthbuf_vertex:hg,map_fragment:cg,map_pars_fragment:lg,map_particle_fragment:pg,map_particle_pars_fragment:dg,metalnessmap_fragment:vg,metalnessmap_pars_fragment:mg,morphnormal_vertex:gg,morphtarget_pars_vertex:yg,morphtarget_vertex:_g,normal_fragment:xg,normalmap_pars_fragment:wg,packing:bg,premultiplied_alpha_fragment:Eg,project_vertex:Mg,dithering_fragment:Tg,dithering_pars_fragment:Sg,roughnessmap_fragment:Ag,roughnessmap_pars_fragment:Lg,shadowmap_pars_fragment:Rg,shadowmap_pars_vertex:Cg,shadowmap_vertex:Pg,shadowmask_pars_fragment:Ig,skinbase_vertex:Dg,skinning_pars_vertex:Og,skinning_vertex:Ug,skinnormal_vertex:Fg,specularmap_fragment:Ng,specularmap_pars_fragment:Bg,tonemapping_fragment:zg,tonemapping_pars_fragment:Gg,uv_pars_fragment:Hg,uv_pars_vertex:Vg,uv_vertex:Wg,uv2_pars_fragment:kg,uv2_pars_vertex:Xg,uv2_vertex:Yg,worldpos_vertex:qg,cube_frag:jg,cube_vert:Zg,depth_frag:Jg,depth_vert:Qg,distanceRGBA_frag:Kg,distanceRGBA_vert:$g,equirect_frag:ey,equirect_vert:ty,linedashed_frag:ny,linedashed_vert:ry,meshbasic_frag:iy,meshbasic_vert:ay,meshlambert_frag:sy,meshlambert_vert:oy,meshphong_frag:uy,meshphong_vert:fy,meshphysical_frag:hy,meshphysical_vert:cy,normal_frag:ly,normal_vert:py,points_frag:dy,points_vert:vy,shadow_frag:my,shadow_vert:gy},Gi={basic:{uniforms:Tn.merge([Fe.common,Fe.specularmap,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.fog]),vertexShader:wt.meshbasic_vert,fragmentShader:wt.meshbasic_frag},lambert:{uniforms:Tn.merge([Fe.common,Fe.specularmap,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.emissivemap,Fe.fog,Fe.lights,{emissive:{value:new Ue(0)}}]),vertexShader:wt.meshlambert_vert,fragmentShader:wt.meshlambert_frag},phong:{uniforms:Tn.merge([Fe.common,Fe.specularmap,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.emissivemap,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,Fe.gradientmap,Fe.fog,Fe.lights,{emissive:{value:new Ue(0)},specular:{value:new Ue(1118481)},shininess:{value:30}}]),vertexShader:wt.meshphong_vert,fragmentShader:wt.meshphong_frag},standard:{uniforms:Tn.merge([Fe.common,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.emissivemap,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,Fe.roughnessmap,Fe.metalnessmap,Fe.fog,Fe.lights,{emissive:{value:new Ue(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:wt.meshphysical_vert,fragmentShader:wt.meshphysical_frag},points:{uniforms:Tn.merge([Fe.points,Fe.fog]),vertexShader:wt.points_vert,fragmentShader:wt.points_frag},dashed:{uniforms:Tn.merge([Fe.common,Fe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wt.linedashed_vert,fragmentShader:wt.linedashed_frag},depth:{uniforms:Tn.merge([Fe.common,Fe.displacementmap]),vertexShader:wt.depth_vert,fragmentShader:wt.depth_frag},normal:{uniforms:Tn.merge([Fe.common,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,{opacity:{value:1}}]),vertexShader:wt.normal_vert,fragmentShader:wt.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:wt.cube_vert,fragmentShader:wt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wt.equirect_vert,fragmentShader:wt.equirect_frag},distanceRGBA:{uniforms:Tn.merge([Fe.common,Fe.displacementmap,{referencePosition:{value:new I},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wt.distanceRGBA_vert,fragmentShader:wt.distanceRGBA_frag},shadow:{uniforms:Tn.merge([Fe.lights,Fe.fog,{color:{value:new Ue(0)},opacity:{value:1}}]),vertexShader:wt.shadow_vert,fragmentShader:wt.shadow_frag}};Gi.physical={uniforms:Tn.merge([Gi.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:wt.meshphysical_vert,fragmentShader:wt.meshphysical_frag};function nf(e,t){this.min=e!==void 0?e:new me(1/0,1/0),this.max=t!==void 0?t:new me(-1/0,-1/0)}Object.assign(nf.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new me;return function(n,r){var a=e.copy(r).multiplyScalar(.5);return this.min.copy(n).sub(a),this.max.copy(n).add(a),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){var t=e||new me;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new me;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){var n=t||new me;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){var n=t||new me;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new me;return function(n){var r=e.copy(n).clamp(this.min,this.max);return r.sub(n).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});function yy(e,t,n,r,a){var s,u,f,h,l,p,d,v;function m(){var x=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),b=new Uint16Array([0,1,2,0,2,3]);s=t.createBuffer(),u=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,x,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferData(t.ELEMENT_ARRAY_BUFFER,b,t.STATIC_DRAW),d=t.createTexture(),v=t.createTexture(),n.bindTexture(t.TEXTURE_2D,d),t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),n.bindTexture(t.TEXTURE_2D,v),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),f={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","	vUV = uv;","	vec2 pos = position;","	if ( renderType == 2 ) {","		vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","		visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","		visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","		visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","		visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","		visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","		visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","		visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","		visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","		vVisibility =        visibility.r / 9.0;","		vVisibility *= 1.0 - visibility.g / 9.0;","		vVisibility *=       visibility.b / 9.0;","		vVisibility *= 1.0 - visibility.a / 9.0;","		pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","		pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","	}","	gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join(`
`),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","	if ( renderType == 0 ) {","		gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","	} else if ( renderType == 1 ) {","		gl_FragColor = texture2D( map, vUV );","	} else {","		vec4 texture = texture2D( map, vUV );","		texture.a *= opacity * vVisibility;","		gl_FragColor = texture;","		gl_FragColor.rgb *= color;","	}","}"].join(`
`)},h=y(f),l={vertex:t.getAttribLocation(h,"position"),uv:t.getAttribLocation(h,"uv")},p={renderType:t.getUniformLocation(h,"renderType"),map:t.getUniformLocation(h,"map"),occlusionMap:t.getUniformLocation(h,"occlusionMap"),opacity:t.getUniformLocation(h,"opacity"),color:t.getUniformLocation(h,"color"),scale:t.getUniformLocation(h,"scale"),rotation:t.getUniformLocation(h,"rotation"),screenPosition:t.getUniformLocation(h,"screenPosition")}}this.render=function(x,b,w,E){if(x.length!==0){var T=new I,M=E.w/E.z,P=E.z*.5,O=E.w*.5,U=16/E.w,W=new me(U*M,U),B=new I(1,1,0),V=new me(1,1),X=new nf;X.min.set(E.x,E.y),X.max.set(E.x+(E.z-16),E.y+(E.w-16)),h===void 0&&m(),n.useProgram(h),n.initAttributes(),n.enableAttribute(l.vertex),n.enableAttribute(l.uv),n.disableUnusedAttributes(),t.uniform1i(p.occlusionMap,0),t.uniform1i(p.map,1),t.bindBuffer(t.ARRAY_BUFFER,s),t.vertexAttribPointer(l.vertex,2,t.FLOAT,!1,2*8,0),t.vertexAttribPointer(l.uv,2,t.FLOAT,!1,2*8,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),n.disable(t.CULL_FACE),n.buffers.depth.setMask(!1);for(var re=0,z=x.length;re<z;re++){U=16/E.w,W.set(U*M,U);var D=x[re];if(T.set(D.matrixWorld.elements[12],D.matrixWorld.elements[13],D.matrixWorld.elements[14]),T.applyMatrix4(w.matrixWorldInverse),T.applyMatrix4(w.projectionMatrix),B.copy(T),V.x=E.x+B.x*P+P-8,V.y=E.y+B.y*O+O-8,X.containsPoint(V)===!0){n.activeTexture(t.TEXTURE0),n.bindTexture(t.TEXTURE_2D,null),n.activeTexture(t.TEXTURE1),n.bindTexture(t.TEXTURE_2D,d),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,V.x,V.y,16,16,0),t.uniform1i(p.renderType,0),t.uniform2f(p.scale,W.x,W.y),t.uniform3f(p.screenPosition,B.x,B.y,B.z),n.disable(t.BLEND),n.enable(t.DEPTH_TEST),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),n.activeTexture(t.TEXTURE0),n.bindTexture(t.TEXTURE_2D,v),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,V.x,V.y,16,16,0),t.uniform1i(p.renderType,1),n.disable(t.DEPTH_TEST),n.activeTexture(t.TEXTURE1),n.bindTexture(t.TEXTURE_2D,d),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),D.positionScreen.copy(B),D.customUpdateCallback?D.customUpdateCallback(D):D.updateLensFlares(),t.uniform1i(p.renderType,2),n.enable(t.BLEND);for(var ee=0,K=D.lensFlares.length;ee<K;ee++){var te=D.lensFlares[ee];te.opacity>.001&&te.scale>.001&&(B.x=te.x,B.y=te.y,B.z=te.z,U=te.size*te.scale/E.w,W.x=U*M,W.y=U,t.uniform3f(p.screenPosition,B.x,B.y,B.z),t.uniform2f(p.scale,W.x,W.y),t.uniform1f(p.rotation,te.rotation),t.uniform1f(p.opacity,te.opacity),t.uniform3f(p.color,te.color.r,te.color.g,te.color.b),n.setBlending(te.blending,te.blendEquation,te.blendSrc,te.blendDst),r.setTexture2D(te.texture,1),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}}}n.enable(t.CULL_FACE),n.enable(t.DEPTH_TEST),n.buffers.depth.setMask(!0),n.reset()}};function y(x){var b=t.createProgram(),w=t.createShader(t.FRAGMENT_SHADER),E=t.createShader(t.VERTEX_SHADER),T="precision "+a.precision+` float;
`;return t.shaderSource(w,T+x.fragmentShader),t.shaderSource(E,T+x.vertexShader),t.compileShader(w),t.compileShader(E),t.attachShader(b,w),t.attachShader(b,E),t.linkProgram(b),b}}function no(e,t,n,r,a,s,u,f,h){Ut.call(this,e,t,n,r,a,s,u,f,h),this.needsUpdate=!0}no.prototype=Object.create(Ut.prototype),no.prototype.constructor=no;function _y(e,t,n,r,a){var s,u,f,h,l,p,d=new I,v=new qt,m=new I;function y(){var w=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),E=new Uint16Array([0,1,2,0,2,3]);s=t.createBuffer(),u=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,w,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferData(t.ELEMENT_ARRAY_BUFFER,E,t.STATIC_DRAW),f=x(),h={position:t.getAttribLocation(f,"position"),uv:t.getAttribLocation(f,"uv")},l={uvOffset:t.getUniformLocation(f,"uvOffset"),uvScale:t.getUniformLocation(f,"uvScale"),rotation:t.getUniformLocation(f,"rotation"),scale:t.getUniformLocation(f,"scale"),color:t.getUniformLocation(f,"color"),map:t.getUniformLocation(f,"map"),opacity:t.getUniformLocation(f,"opacity"),modelViewMatrix:t.getUniformLocation(f,"modelViewMatrix"),projectionMatrix:t.getUniformLocation(f,"projectionMatrix"),fogType:t.getUniformLocation(f,"fogType"),fogDensity:t.getUniformLocation(f,"fogDensity"),fogNear:t.getUniformLocation(f,"fogNear"),fogFar:t.getUniformLocation(f,"fogFar"),fogColor:t.getUniformLocation(f,"fogColor"),fogDepth:t.getUniformLocation(f,"fogDepth"),alphaTest:t.getUniformLocation(f,"alphaTest")};var T=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");T.width=8,T.height=8;var M=T.getContext("2d");M.fillStyle="white",M.fillRect(0,0,8,8),p=new no(T)}this.render=function(w,E,T){if(w.length!==0){f===void 0&&y(),n.useProgram(f),n.initAttributes(),n.enableAttribute(h.position),n.enableAttribute(h.uv),n.disableUnusedAttributes(),n.disable(t.CULL_FACE),n.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,s),t.vertexAttribPointer(h.position,2,t.FLOAT,!1,2*8,0),t.vertexAttribPointer(h.uv,2,t.FLOAT,!1,2*8,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.uniformMatrix4fv(l.projectionMatrix,!1,T.projectionMatrix.elements),n.activeTexture(t.TEXTURE0),t.uniform1i(l.map,0);var M=0,P=0,O=E.fog;O?(t.uniform3f(l.fogColor,O.color.r,O.color.g,O.color.b),O.isFog?(t.uniform1f(l.fogNear,O.near),t.uniform1f(l.fogFar,O.far),t.uniform1i(l.fogType,1),M=1,P=1):O.isFogExp2&&(t.uniform1f(l.fogDensity,O.density),t.uniform1i(l.fogType,2),M=2,P=2)):(t.uniform1i(l.fogType,0),M=0,P=0);for(var U=0,W=w.length;U<W;U++){var B=w[U];B.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,B.matrixWorld),B.z=-B.modelViewMatrix.elements[14]}w.sort(b);for(var V=[],U=0,W=w.length;U<W;U++){var B=w[U],X=B.material;if(X.visible!==!1){B.onBeforeRender(e,E,T,void 0,X,void 0),t.uniform1f(l.alphaTest,X.alphaTest),t.uniformMatrix4fv(l.modelViewMatrix,!1,B.modelViewMatrix.elements),B.matrixWorld.decompose(d,v,m),V[0]=m.x,V[1]=m.y;var re=0;E.fog&&X.fog&&(re=P),M!==re&&(t.uniform1i(l.fogType,re),M=re),X.map!==null?(t.uniform2f(l.uvOffset,X.map.offset.x,X.map.offset.y),t.uniform2f(l.uvScale,X.map.repeat.x,X.map.repeat.y)):(t.uniform2f(l.uvOffset,0,0),t.uniform2f(l.uvScale,1,1)),t.uniform1f(l.opacity,X.opacity),t.uniform3f(l.color,X.color.r,X.color.g,X.color.b),t.uniform1f(l.rotation,X.rotation),t.uniform2fv(l.scale,V),n.setBlending(X.blending,X.blendEquation,X.blendSrc,X.blendDst,X.blendEquationAlpha,X.blendSrcAlpha,X.blendDstAlpha,X.premultipliedAlpha),n.buffers.depth.setTest(X.depthTest),n.buffers.depth.setMask(X.depthWrite),n.buffers.color.setMask(X.colorWrite),r.setTexture2D(X.map||p,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),B.onAfterRender(e,E,T,void 0,X,void 0)}}n.enable(t.CULL_FACE),n.reset()}};function x(){var w=t.createProgram(),E=t.createShader(t.VERTEX_SHADER),T=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(E,["precision "+a.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","	vUV = uvOffset + uv * uvScale;","	vec2 alignedPosition = position * scale;","	vec2 rotatedPosition;","	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","	vec4 mvPosition;","	mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","	mvPosition.xy += rotatedPosition;","	gl_Position = projectionMatrix * mvPosition;","	fogDepth = - mvPosition.z;","}"].join(`
`)),t.shaderSource(T,["precision "+a.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","	vec4 texture = texture2D( map, vUV );","	gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","	if ( gl_FragColor.a < alphaTest ) discard;","	if ( fogType > 0 ) {","		float fogFactor = 0.0;","		if ( fogType == 1 ) {","			fogFactor = smoothstep( fogNear, fogFar, fogDepth );","		} else {","			const float LOG2 = 1.442695;","			fogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","			fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","		}","		gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","	}","}"].join(`
`)),t.compileShader(E),t.compileShader(T),t.attachShader(w,E),t.attachShader(w,T),t.linkProgram(w),w}function b(w,E){return w.renderOrder!==E.renderOrder?w.renderOrder-E.renderOrder:w.z!==E.z?E.z-w.z:E.id-w.id}}var xy=0;function at(){Object.defineProperty(this,"id",{value:xy++}),this.uuid=Ke.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Da,this.side=Pa,this.flatShading=!1,this.vertexColors=zu,this.opacity=1,this.transparent=!1,this.blendSrc=dc,this.blendDst=vc,this.blendEquation=cc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Vu,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}Object.assign(at.prototype,Br.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var t in e){var n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===sc;continue}var r=this[t];if(r===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):t==="overdraw"?this[t]=Number(n):this[t]=n}},toJSON:function(e){var t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearCoat!==void 0&&(n.clearCoat=this.clearCoat),this.clearCoatRoughness!==void 0&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(n.size=this.size),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Da&&(n.blending=this.blending),this.flatShading===!0&&(n.flatShading=this.flatShading),this.side!==Pa&&(n.side=this.side),this.vertexColors!==zu&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,this.rotation!==0&&(n.rotation=this.rotation),this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.skinning===!0&&(n.skinning=!0),this.visible===!1&&(n.visible=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function r(u){var f=[];for(var h in u){var l=u[h];delete l.metadata,f.push(l)}return f}if(t){var a=r(e.textures),s=r(e.images);a.length>0&&(n.textures=a),s.length>0&&(n.images=s)}return n},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(t!==null){var r=t.length;n=new Array(r);for(var a=0;a!==r;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function si(e){at.call(this),this.type="MeshDepthMaterial",this.depthPacking=Vv,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}si.prototype=Object.create(at.prototype),si.prototype.constructor=si,si.prototype.isMeshDepthMaterial=!0,si.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this};function oi(e){at.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new I,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}oi.prototype=Object.create(at.prototype),oi.prototype.constructor=oi,oi.prototype.isMeshDistanceMaterial=!0,oi.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function Hr(e,t){this.min=e!==void 0?e:new I(1/0,1/0,1/0),this.max=t!==void 0?t:new I(-1/0,-1/0,-1/0)}Object.assign(Hr.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,a=-1/0,s=-1/0,u=-1/0,f=0,h=e.length;f<h;f+=3){var l=e[f],p=e[f+1],d=e[f+2];l<t&&(t=l),p<n&&(n=p),d<r&&(r=d),l>a&&(a=l),p>s&&(s=p),d>u&&(u=d)}return this.min.set(t,n,r),this.max.set(a,s,u),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,a=-1/0,s=-1/0,u=-1/0,f=0,h=e.count;f<h;f++){var l=e.getX(f),p=e.getY(f),d=e.getZ(f);l<t&&(t=l),p<n&&(n=p),d<r&&(r=d),l>a&&(a=l),p>s&&(s=p),d>u&&(u=d)}return this.min.set(t,n,r),this.max.set(a,s,u),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new I;return function(n,r){var a=e.copy(r).multiplyScalar(.5);return this.min.copy(n).sub(a),this.max.copy(n).add(a),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){var t=e||new I;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new I;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,n,r=new I;function a(s){var u=s.geometry;if(u!==void 0){if(u.isGeometry){var f=u.vertices;for(t=0,n=f.length;t<n;t++)r.copy(f[t]),r.applyMatrix4(s.matrixWorld),e.expandByPoint(r)}else if(u.isBufferGeometry){var h=u.attributes.position;if(h!==void 0)for(t=0,n=h.count;t<n;t++)r.fromBufferAttribute(h,t).applyMatrix4(s.matrixWorld),e.expandByPoint(r)}}}return function(u){return e=this,u.updateMatrixWorld(!0),u.traverse(a),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){var n=t||new I;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new I;return function(n){return this.clampPoint(n.center,e),e.distanceToSquared(n.center)<=n.radius*n.radius}}(),intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=e.constant&&n>=e.constant},clampPoint:function(e,t){var n=t||new I;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new I;return function(n){var r=e.copy(n).clamp(this.min,this.max);return r.sub(n).length()}}(),getBoundingSphere:function(){var e=new I;return function(n){var r=n||new fr;return this.getCenter(r.center),r.radius=this.getSize(e).length()*.5,r}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new I,new I,new I,new I,new I,new I,new I,new I];return function(n){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(n),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(n),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(n),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(n),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(n),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(n),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(n),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(n),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});function fr(e,t){this.center=e!==void 0?e:new I,this.radius=t!==void 0?t:0}Object.assign(fr.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new Hr;return function(n,r){var a=this.center;r!==void 0?a.copy(r):e.setFromPoints(n).getCenter(a);for(var s=0,u=0,f=n.length;u<f;u++)s=Math.max(s,a.distanceToSquared(n[u]));return this.radius=Math.sqrt(s),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e),r=t||new I;return r.copy(e),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(e){var t=e||new Hr;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});function Kn(e,t){this.normal=e!==void 0?e:new I(1,0,0),this.constant=t!==void 0?t:0}Object.assign(Kn.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new I,t=new I;return function(r,a,s){var u=e.subVectors(s,a).cross(t.subVectors(r,a)).normalize();return this.setFromNormalAndCoplanarPoint(u,r),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){var n=t||new I;return n.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new I;return function(n,r){var a=r||new I,s=n.delta(e),u=this.normal.dot(s);if(u===0)return this.distanceToPoint(n.start)===0?a.copy(n.start):void 0;var f=-(n.start.dot(this.normal)+this.constant)/u;if(!(f<0||f>1))return a.copy(s).multiplyScalar(f).add(n.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){var t=e||new I;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new I,t=new Mn;return function(r,a){var s=a||t.getNormalMatrix(r),u=this.coplanarPoint(e).applyMatrix4(r),f=this.normal.applyMatrix3(s).normalize();return this.constant=-u.dot(f),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});function rf(e,t,n,r,a,s){this.planes=[e!==void 0?e:new Kn,t!==void 0?t:new Kn,n!==void 0?n:new Kn,r!==void 0?r:new Kn,a!==void 0?a:new Kn,s!==void 0?s:new Kn]}Object.assign(rf.prototype,{set:function(e,t,n,r,a,s){var u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(n),u[3].copy(r),u[4].copy(a),u[5].copy(s),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],a=n[1],s=n[2],u=n[3],f=n[4],h=n[5],l=n[6],p=n[7],d=n[8],v=n[9],m=n[10],y=n[11],x=n[12],b=n[13],w=n[14],E=n[15];return t[0].setComponents(u-r,p-f,y-d,E-x).normalize(),t[1].setComponents(u+r,p+f,y+d,E+x).normalize(),t[2].setComponents(u+a,p+h,y+v,E+b).normalize(),t[3].setComponents(u-a,p-h,y-v,E-b).normalize(),t[4].setComponents(u-s,p-l,y-m,E-w).normalize(),t[5].setComponents(u+s,p+l,y+m,E+w).normalize(),this},intersectsObject:function(){var e=new fr;return function(n){var r=n.geometry;return r.boundingSphere===null&&r.computeBoundingSphere(),e.copy(r.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new fr;return function(n){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(n.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,a=0;a<6;a++){var s=t[a].distanceToPoint(n);if(s<r)return!1}return!0},intersectsBox:function(){var e=new I,t=new I;return function(r){for(var a=this.planes,s=0;s<6;s++){var u=a[s];e.x=u.normal.x>0?r.min.x:r.max.x,t.x=u.normal.x>0?r.max.x:r.min.x,e.y=u.normal.y>0?r.min.y:r.max.y,t.y=u.normal.y>0?r.max.y:r.min.y,e.z=u.normal.z>0?r.min.z:r.max.z,t.z=u.normal.z>0?r.max.z:r.min.z;var f=u.distanceToPoint(e),h=u.distanceToPoint(t);if(f<0&&h<0)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});function kc(e,t,n){for(var r=new rf,a=new Ve,s=new me,u=new me(n,n),f=new I,h=new I,l=1,p=2,d=(l|p)+1,v=new Array(d),m=new Array(d),y={},x=[new I(1,0,0),new I(-1,0,0),new I(0,0,1),new I(0,0,-1),new I(0,1,0),new I(0,-1,0)],b=[new I(0,1,0),new I(0,1,0),new I(0,1,0),new I(0,1,0),new I(0,0,1),new I(0,0,-1)],w=[new At,new At,new At,new At,new At,new At],E=0;E!==d;++E){var T=(E&l)!==0,M=(E&p)!==0,P=new si({depthPacking:Wv,morphTargets:T,skinning:M});v[E]=P;var O=new oi({morphTargets:T,skinning:M});m[E]=O}var U=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ac,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(V,X,re){if(U.enabled!==!1&&!(U.autoUpdate===!1&&U.needsUpdate===!1)&&V.length!==0){var z=e.context,D=e.state;D.disable(z.BLEND),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);for(var ee,K=0,te=V.length;K<te;K++){var $=V[K],ue=$.shadow,he=$&&$.isPointLight;if(ue===void 0){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}var oe=ue.camera;if(s.copy(ue.mapSize),s.min(u),he){var ve=s.x,pe=s.y;w[0].set(ve*2,pe,ve,pe),w[1].set(0,pe,ve,pe),w[2].set(ve*3,pe,ve,pe),w[3].set(ve,pe,ve,pe),w[4].set(ve*3,0,ve,pe),w[5].set(ve,0,ve,pe),s.x*=4,s.y*=2}if(ue.map===null){var Ae={minFilter:Fn,magFilter:Fn,format:Gr};ue.map=new Na(s.x,s.y,Ae),ue.map.texture.name=$.name+".shadowMap",oe.updateProjectionMatrix()}ue.isSpotLightShadow&&ue.update($);var Z=ue.map,Ce=ue.matrix;h.setFromMatrixPosition($.matrixWorld),oe.position.copy(h),he?(ee=6,Ce.makeTranslation(-h.x,-h.y,-h.z)):(ee=1,f.setFromMatrixPosition($.target.matrixWorld),oe.lookAt(f),oe.updateMatrixWorld(),Ce.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Ce.multiply(oe.projectionMatrix),Ce.multiply(oe.matrixWorldInverse)),e.setRenderTarget(Z),e.clear();for(var J=0;J<ee;J++){if(he){f.copy(oe.position),f.add(x[J]),oe.up.copy(b[J]),oe.lookAt(f),oe.updateMatrixWorld();var Pe=w[J];D.viewport(Pe)}a.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),r.setFromMatrix(a),B(X,re,oe,he)}}U.needsUpdate=!1}};function W(V,X,re,z,D,ee){var K=V.geometry,te=null,$=v,ue=V.customDepthMaterial;if(re&&($=m,ue=V.customDistanceMaterial),ue)te=ue;else{var he=!1;X.morphTargets&&(K&&K.isBufferGeometry?he=K.morphAttributes&&K.morphAttributes.position&&K.morphAttributes.position.length>0:K&&K.isGeometry&&(he=K.morphTargets&&K.morphTargets.length>0)),V.isSkinnedMesh&&X.skinning===!1&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",V);var oe=V.isSkinnedMesh&&X.skinning,ve=0;he&&(ve|=l),oe&&(ve|=p),te=$[ve]}if(e.localClippingEnabled&&X.clipShadows===!0&&X.clippingPlanes.length!==0){var pe=te.uuid,Ae=X.uuid,Z=y[pe];Z===void 0&&(Z={},y[pe]=Z);var Ce=Z[Ae];Ce===void 0&&(Ce=te.clone(),Z[Ae]=Ce),te=Ce}te.visible=X.visible,te.wireframe=X.wireframe;var J=X.side;return U.renderSingleSided&&J==Ia&&(J=Pa),U.renderReverseSided&&(J===Pa?J=ri:J===ri&&(J=Pa)),te.side=J,te.clipShadows=X.clipShadows,te.clippingPlanes=X.clippingPlanes,te.clipIntersection=X.clipIntersection,te.wireframeLinewidth=X.wireframeLinewidth,te.linewidth=X.linewidth,re&&te.isMeshDistanceMaterial&&(te.referencePosition.copy(z),te.nearDistance=D,te.farDistance=ee),te}function B(V,X,re,z){if(V.visible!==!1){var D=V.layers.test(X.layers);if(D&&(V.isMesh||V.isLine||V.isPoints)&&V.castShadow&&(!V.frustumCulled||r.intersectsObject(V))){V.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,V.matrixWorld);var ee=t.update(V),K=V.material;if(Array.isArray(K))for(var te=ee.groups,$=0,ue=te.length;$<ue;$++){var he=te[$],oe=K[he.materialIndex];if(oe&&oe.visible){var ve=W(V,oe,z,h,re.near,re.far);e.renderBufferDirect(re,null,ee,ve,V,he)}}else if(K.visible){var ve=W(V,K,z,h,re.near,re.far);e.renderBufferDirect(re,null,ee,ve,V,null)}}for(var pe=V.children,Ae=0,Z=pe.length;Ae<Z;Ae++)B(pe[Ae],X,re,z)}}}function wy(e){var t={};function n(f,h){var l=f.array,p=f.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,d=e.createBuffer();e.bindBuffer(h,d),e.bufferData(h,l,p),f.onUploadCallback();var v=e.FLOAT;return l instanceof Float32Array?v=e.FLOAT:l instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):l instanceof Uint16Array?v=e.UNSIGNED_SHORT:l instanceof Int16Array?v=e.SHORT:l instanceof Uint32Array?v=e.UNSIGNED_INT:l instanceof Int32Array?v=e.INT:l instanceof Int8Array?v=e.BYTE:l instanceof Uint8Array&&(v=e.UNSIGNED_BYTE),{buffer:d,type:v,bytesPerElement:l.BYTES_PER_ELEMENT,version:f.version}}function r(f,h,l){var p=h.array,d=h.updateRange;e.bindBuffer(l,f),h.dynamic===!1?e.bufferData(l,p,e.STATIC_DRAW):d.count===-1?e.bufferSubData(l,0,p):d.count===0?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(l,d.offset*p.BYTES_PER_ELEMENT,p.subarray(d.offset,d.offset+d.count)),d.count=-1)}function a(f){return f.isInterleavedBufferAttribute&&(f=f.data),t[f.uuid]}function s(f){f.isInterleavedBufferAttribute&&(f=f.data);var h=t[f.uuid];h&&(e.deleteBuffer(h.buffer),delete t[f.uuid])}function u(f,h){f.isInterleavedBufferAttribute&&(f=f.data);var l=t[f.uuid];l===void 0?t[f.uuid]=n(f,h):l.version<f.version&&(r(l.buffer,f,h),l.version=f.version)}return{get:a,remove:s,update:u}}function ui(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||ui.DefaultOrder}ui.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ui.DefaultOrder="XYZ",Object.defineProperties(ui.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(ui.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Ke.clamp,a=e.elements,s=a[0],u=a[4],f=a[8],h=a[1],l=a[5],p=a[9],d=a[2],v=a[6],m=a[10];return t=t||this._order,t==="XYZ"?(this._y=Math.asin(r(f,-1,1)),Math.abs(f)<.99999?(this._x=Math.atan2(-p,m),this._z=Math.atan2(-u,s)):(this._x=Math.atan2(v,l),this._z=0)):t==="YXZ"?(this._x=Math.asin(-r(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(f,m),this._z=Math.atan2(h,l)):(this._y=Math.atan2(-d,s),this._z=0)):t==="ZXY"?(this._x=Math.asin(r(v,-1,1)),Math.abs(v)<.99999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-u,l)):(this._y=0,this._z=Math.atan2(h,s))):t==="ZYX"?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(v,m),this._z=Math.atan2(h,s)):(this._x=0,this._z=Math.atan2(-u,l))):t==="YZX"?(this._z=Math.asin(r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-p,l),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(f,m))):t==="XZY"?(this._z=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(v,l),this._y=Math.atan2(f,s)):(this._x=Math.atan2(-p,m),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,n!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new Ve;return function(n,r,a){return e.makeRotationFromQuaternion(n),this.setFromRotationMatrix(e,r,a)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new qt;return function(n){return e.setFromEuler(this),this.setFromQuaternion(e,n)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new I(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}});function Xc(){this.mask=1}Object.assign(Xc.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return(this.mask&e.mask)!==0}});var by=0;function we(){Object.defineProperty(this,"id",{value:by++}),this.uuid=Ke.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=we.DefaultUp.clone();var e=new I,t=new ui,n=new qt,r=new I(1,1,1);function a(){n.setFromEuler(t,!1)}function s(){t.setFromQuaternion(n,void 0,!1)}t.onChange(a),n.onChange(s),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Ve},normalMatrix:{value:new Mn}}),this.matrix=new Ve,this.matrixWorld=new Ve,this.matrixAutoUpdate=we.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Xc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}we.DefaultUp=new I(0,1,0),we.DefaultMatrixAutoUpdate=!0,Object.assign(we.prototype,Br.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new qt;return function(n,r){return e.setFromAxisAngle(n,r),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new qt;return function(n,r){return e.setFromAxisAngle(n,r),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new I(1,0,0);return function(n){return this.rotateOnAxis(e,n)}}(),rotateY:function(){var e=new I(0,1,0);return function(n){return this.rotateOnAxis(e,n)}}(),rotateZ:function(){var e=new I(0,0,1);return function(n){return this.rotateOnAxis(e,n)}}(),translateOnAxis:function(){var e=new I;return function(n,r){return e.copy(n).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new I(1,0,0);return function(n){return this.translateOnAxis(e,n)}}(),translateY:function(){var e=new I(0,1,0);return function(n){return this.translateOnAxis(e,n)}}(),translateZ:function(){var e=new I(0,0,1);return function(n){return this.translateOnAxis(e,n)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new Ve;return function(n){return n.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new Ve,t=new I;return function(r,a,s){r.isVector3?t.copy(r):t.set(r,a,s),this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return n!==-1&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var a=this.children[n],s=a.getObjectByProperty(e,t);if(s!==void 0)return s}},getWorldPosition:function(e){var t=e||new I;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new I,t=new I;return function(r){var a=r||new qt;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,a,t),a}}(),getWorldRotation:function(){var e=new qt;return function(n){var r=n||new ui;return this.getWorldQuaternion(e),r.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new I,t=new qt;return function(r){var a=r||new I;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,a),a}}(),getWorldDirection:function(){var e=new qt;return function(n){var r=n||new I;return this.getWorldQuaternion(e),r.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},toJSON:function(e){var t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.matrix=this.matrix.toArray();function a(m,y){return m[y.uuid]===void 0&&(m[y.uuid]=y.toJSON(e)),y.uuid}if(this.geometry!==void 0&&(r.geometry=a(e.geometries,this.geometry)),this.material!==void 0)if(Array.isArray(this.material)){for(var s=[],u=0,f=this.material.length;u<f;u++)s.push(a(e.materials,this.material[u]));r.material=s}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(var u=0;u<this.children.length;u++)r.children.push(this.children[u].toJSON(e).object)}if(t){var h=v(e.geometries),l=v(e.materials),p=v(e.textures),d=v(e.images);h.length>0&&(n.geometries=h),l.length>0&&(n.materials=l),p.length>0&&(n.textures=p),d.length>0&&(n.images=d)}return n.object=r,n;function v(m){var y=[];for(var x in m){var b=m[x];delete b.metadata,y.push(b)}return y}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(t===void 0&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});function wr(){we.call(this),this.type="Camera",this.matrixWorldInverse=new Ve,this.projectionMatrix=new Ve}wr.prototype=Object.assign(Object.create(we.prototype),{constructor:wr,isCamera:!0,copy:function(e,t){return we.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new qt;return function(n){var r=n||new I;return this.getWorldQuaternion(e),r.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){we.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function za(e,t,n,r,a,s){wr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=a!==void 0?a:.1,this.far=s!==void 0?s:2e3,this.updateProjectionMatrix()}za.prototype=Object.assign(Object.create(wr.prototype),{constructor:za,isOrthographicCamera:!0,copy:function(e,t){return wr.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,a,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,a=n-e,s=n+e,u=r+t,f=r-t;if(this.view!==null&&this.view.enabled){var h=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),p=(this.right-this.left)/this.view.width,d=(this.top-this.bottom)/this.view.height;a+=p*(this.view.offsetX/h),s=a+p*(this.view.width/h),u-=d*(this.view.offsetY/l),f=u-d*(this.view.height/l)}this.projectionMatrix.makeOrthographic(a,s,u,f,this.near,this.far)},toJSON:function(e){var t=we.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}});function fi(e,t,n,r,a,s){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new I,this.vertexNormals=Array.isArray(r)?r:[],this.color=a&&a.isColor?a:new Ue,this.vertexColors=Array.isArray(a)?a:[],this.materialIndex=s!==void 0?s:0}Object.assign(fi.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Ey=0;function We(){Object.defineProperty(this,"id",{value:Ey+=2}),this.uuid=Ke.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(We.prototype,Br.prototype,{isGeometry:!0,applyMatrix:function(e){for(var t=new Mn().getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++){var a=this.vertices[n];a.applyMatrix4(e)}for(var n=0,r=this.faces.length;n<r;n++){var s=this.faces[n];s.normal.applyMatrix3(t).normalize();for(var u=0,f=s.vertexNormals.length;u<f;u++)s.vertexNormals[u].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new Ve;return function(n){return e.makeRotationX(n),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Ve;return function(n){return e.makeRotationY(n),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Ve;return function(n){return e.makeRotationZ(n),this.applyMatrix(e),this}}(),translate:function(){var e=new Ve;return function(n,r,a){return e.makeTranslation(n,r,a),this.applyMatrix(e),this}}(),scale:function(){var e=new Ve;return function(n,r,a){return e.makeScale(n,r,a),this.applyMatrix(e),this}}(),lookAt:function(){var e=new we;return function(n){e.lookAt(n),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,n=e.index!==null?e.index.array:void 0,r=e.attributes,a=r.position.array,s=r.normal!==void 0?r.normal.array:void 0,u=r.color!==void 0?r.color.array:void 0,f=r.uv!==void 0?r.uv.array:void 0,h=r.uv2!==void 0?r.uv2.array:void 0;h!==void 0&&(this.faceVertexUvs[1]=[]);for(var l=[],p=[],d=[],v=0,m=0;v<a.length;v+=3,m+=2)t.vertices.push(new I(a[v],a[v+1],a[v+2])),s!==void 0&&l.push(new I(s[v],s[v+1],s[v+2])),u!==void 0&&t.colors.push(new Ue(u[v],u[v+1],u[v+2])),f!==void 0&&p.push(new me(f[m],f[m+1])),h!==void 0&&d.push(new me(h[m],h[m+1]));function y(M,P,O,U){var W=s!==void 0?[l[M].clone(),l[P].clone(),l[O].clone()]:[],B=u!==void 0?[t.colors[M].clone(),t.colors[P].clone(),t.colors[O].clone()]:[],V=new fi(M,P,O,W,B,U);t.faces.push(V),f!==void 0&&t.faceVertexUvs[0].push([p[M].clone(),p[P].clone(),p[O].clone()]),h!==void 0&&t.faceVertexUvs[1].push([d[M].clone(),d[P].clone(),d[O].clone()])}var x=e.groups;if(x.length>0)for(var v=0;v<x.length;v++)for(var b=x[v],w=b.start,E=b.count,m=w,T=w+E;m<T;m+=3)n!==void 0?y(n[m],n[m+1],n[m+2],b.materialIndex):y(m,m+1,m+2,b.materialIndex);else if(n!==void 0)for(var v=0;v<n.length;v+=3)y(n[v],n[v+1],n[v+2]);else for(var v=0;v<a.length/3;v+=3)y(v,v+1,v+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=t===0?1:1/t,r=new Ve;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new I,t=new I,n=0,r=this.faces.length;n<r;n++){var a=this.faces[n],s=this.vertices[a.a],u=this.vertices[a.b],f=this.vertices[a.c];e.subVectors(f,u),t.subVectors(s,u),e.cross(t),e.normalize(),a.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);var t,n,r,a,s,u;for(u=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)u[t]=new I;if(e){var f,h,l,p=new I,d=new I;for(r=0,a=this.faces.length;r<a;r++)s=this.faces[r],f=this.vertices[s.a],h=this.vertices[s.b],l=this.vertices[s.c],p.subVectors(l,h),d.subVectors(f,h),p.cross(d),u[s.a].add(p),u[s.b].add(p),u[s.c].add(p)}else for(this.computeFaceNormals(),r=0,a=this.faces.length;r<a;r++)s=this.faces[r],u[s.a].add(s.normal),u[s.b].add(s.normal),u[s.c].add(s.normal);for(t=0,n=this.vertices.length;t<n;t++)u[t].normalize();for(r=0,a=this.faces.length;r<a;r++){s=this.faces[r];var v=s.vertexNormals;v.length===3?(v[0].copy(u[s.a]),v[1].copy(u[s.b]),v[2].copy(u[s.c])):(v[0]=u[s.a].clone(),v[1]=u[s.b].clone(),v[2]=u[s.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){n=this.faces[e];var r=n.vertexNormals;r.length===3?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,a;for(n=0,r=this.faces.length;n<r;n++)for(a=this.faces[n],a.__originalFaceNormal?a.__originalFaceNormal.copy(a.normal):a.__originalFaceNormal=a.normal.clone(),a.__originalVertexNormals||(a.__originalVertexNormals=[]),e=0,t=a.vertexNormals.length;e<t;e++)a.__originalVertexNormals[e]?a.__originalVertexNormals[e].copy(a.vertexNormals[e]):a.__originalVertexNormals[e]=a.vertexNormals[e].clone();var s=new We;for(s.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var u=this.morphNormals[e].faceNormals,f=this.morphNormals[e].vertexNormals,l,p;for(n=0,r=this.faces.length;n<r;n++)l=new I,p={a:new I,b:new I,c:new I},u.push(l),f.push(p)}var h=this.morphNormals[e];s.vertices=this.morphTargets[e].vertices,s.computeFaceNormals(),s.computeVertexNormals();var l,p;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],l=h.faceNormals[n],p=h.vertexNormals[n],l.copy(a.normal),p.a.copy(a.vertexNormals[0]),p.b.copy(a.vertexNormals[1]),p.c.copy(a.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],a.normal=a.__originalFaceNormal,a.vertexNormals=a.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,n=0,r=t.length;n<r;n++)n>0&&(e+=t[n].distanceTo(t[n-1])),this.lineDistances[n]=e},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Hr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new fr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var r,a=this.vertices.length,s=this.vertices,u=e.vertices,f=this.faces,h=e.faces,l=this.faceVertexUvs[0],p=e.faceVertexUvs[0],d=this.colors,v=e.colors;n===void 0&&(n=0),t!==void 0&&(r=new Mn().getNormalMatrix(t));for(var m=0,y=u.length;m<y;m++){var x=u[m],b=x.clone();t!==void 0&&b.applyMatrix4(t),s.push(b)}for(var m=0,y=v.length;m<y;m++)d.push(v[m].clone());for(m=0,y=h.length;m<y;m++){var w=h[m],E,T,M,P=w.vertexNormals,O=w.vertexColors;E=new fi(w.a+a,w.b+a,w.c+a),E.normal.copy(w.normal),r!==void 0&&E.normal.applyMatrix3(r).normalize();for(var U=0,W=P.length;U<W;U++)T=P[U].clone(),r!==void 0&&T.applyMatrix3(r).normalize(),E.vertexNormals.push(T);E.color.copy(w.color);for(var U=0,W=O.length;U<W;U++)M=O[U],E.vertexColors.push(M.clone());E.materialIndex=w.materialIndex+n,f.push(E)}for(m=0,y=p.length;m<y;m++){var B=p[m],V=[];if(B!==void 0){for(var U=0,W=B.length;U<W;U++)V.push(B[U].clone());l.push(V)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(){var e={},t=[],n=[],r,a,s=4,u=Math.pow(10,s),f,h,l,p,d,v;for(f=0,h=this.vertices.length;f<h;f++)r=this.vertices[f],a=Math.round(r.x*u)+"_"+Math.round(r.y*u)+"_"+Math.round(r.z*u),e[a]===void 0?(e[a]=f,t.push(this.vertices[f]),n[f]=t.length-1):n[f]=n[e[a]];var m=[];for(f=0,h=this.faces.length;f<h;f++){l=this.faces[f],l.a=n[l.a],l.b=n[l.b],l.c=n[l.c],p=[l.a,l.b,l.c];for(var y=0;y<3;y++)if(p[y]===p[(y+1)%3]){m.push(f);break}}for(f=m.length-1;f>=0;f--){var x=m[f];for(this.faces.splice(x,1),d=0,v=this.faceVertexUvs.length;d<v;d++)this.faceVertexUvs[d].splice(x,1)}var b=this.vertices.length-t.length;return this.vertices=t,b},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new I(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;function r(l,p){return l.materialIndex-p.materialIndex}e.sort(r);var a=this.faceVertexUvs[0],s=this.faceVertexUvs[1],u,f;a&&a.length===t&&(u=[]),s&&s.length===t&&(f=[]);for(var n=0;n<t;n++){var h=e[n]._id;u&&u.push(a[h]),f&&f.push(s[h])}u&&(this.faceVertexUvs[0]=u),f&&(this.faceVertexUvs[1]=f)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var t=this.parameters;for(var n in t)t[n]!==void 0&&(e[n]=t[n]);return e}for(var r=[],a=0;a<this.vertices.length;a++){var s=this.vertices[a];r.push(s.x,s.y,s.z)}for(var u=[],f=[],h={},l=[],p={},d=[],v={},a=0;a<this.faces.length;a++){var m=this.faces[a],y=!0,x=!1,b=this.faceVertexUvs[0][a]!==void 0,w=m.normal.length()>0,E=m.vertexNormals.length>0,T=m.color.r!==1||m.color.g!==1||m.color.b!==1,M=m.vertexColors.length>0,P=0;if(P=B(P,0,0),P=B(P,1,y),P=B(P,2,x),P=B(P,3,b),P=B(P,4,w),P=B(P,5,E),P=B(P,6,T),P=B(P,7,M),u.push(P),u.push(m.a,m.b,m.c),u.push(m.materialIndex),b){var O=this.faceVertexUvs[0][a];u.push(re(O[0]),re(O[1]),re(O[2]))}if(w&&u.push(V(m.normal)),E){var U=m.vertexNormals;u.push(V(U[0]),V(U[1]),V(U[2]))}if(T&&u.push(X(m.color)),M){var W=m.vertexColors;u.push(X(W[0]),X(W[1]),X(W[2]))}}function B(z,D,ee){return ee?z|1<<D:z&~(1<<D)}function V(z){var D=z.x.toString()+z.y.toString()+z.z.toString();return h[D]!==void 0||(h[D]=f.length/3,f.push(z.x,z.y,z.z)),h[D]}function X(z){var D=z.r.toString()+z.g.toString()+z.b.toString();return p[D]!==void 0||(p[D]=l.length,l.push(z.getHex())),p[D]}function re(z){var D=z.x.toString()+z.y.toString();return v[D]!==void 0||(v[D]=d.length/2,d.push(z.x,z.y)),v[D]}return e.data={},e.data.vertices=r,e.data.normals=f,l.length>0&&(e.data.colors=l),d.length>0&&(e.data.uvs=[d]),e.data.faces=u,e},clone:function(){return new We().copy(this)},copy:function(e){var t,n,r,a,s,u;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var f=e.vertices;for(t=0,n=f.length;t<n;t++)this.vertices.push(f[t].clone());var h=e.colors;for(t=0,n=h.length;t<n;t++)this.colors.push(h[t].clone());var l=e.faces;for(t=0,n=l.length;t<n;t++)this.faces.push(l[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var p=e.faceVertexUvs[t];for(this.faceVertexUvs[t]===void 0&&(this.faceVertexUvs[t]=[]),r=0,a=p.length;r<a;r++){var d=p[r],v=[];for(s=0,u=d.length;s<u;s++){var m=d[s];v.push(m.clone())}this.faceVertexUvs[t].push(v)}}var y=e.morphTargets;for(t=0,n=y.length;t<n;t++){var x={};if(x.name=y[t].name,y[t].vertices!==void 0)for(x.vertices=[],r=0,a=y[t].vertices.length;r<a;r++)x.vertices.push(y[t].vertices[r].clone());if(y[t].normals!==void 0)for(x.normals=[],r=0,a=y[t].normals.length;r<a;r++)x.normals.push(y[t].normals[r].clone());this.morphTargets.push(x)}var b=e.morphNormals;for(t=0,n=b.length;t<n;t++){var w={};if(b[t].vertexNormals!==void 0)for(w.vertexNormals=[],r=0,a=b[t].vertexNormals.length;r<a;r++){var E=b[t].vertexNormals[r],T={};T.a=E.a.clone(),T.b=E.b.clone(),T.c=E.c.clone(),w.vertexNormals.push(T)}if(b[t].faceNormals!==void 0)for(w.faceNormals=[],r=0,a=b[t].faceNormals.length;r<a;r++)w.faceNormals.push(b[t].faceNormals[r].clone());this.morphNormals.push(w)}var M=e.skinWeights;for(t=0,n=M.length;t<n;t++)this.skinWeights.push(M[t].clone());var P=e.skinIndices;for(t=0,n=P.length;t<n;t++)this.skinIndices.push(P[t].clone());var O=e.lineDistances;for(t=0,n=O.length;t<n;t++)this.lineDistances.push(O[t]);var U=e.boundingBox;U!==null&&(this.boundingBox=U.clone());var W=e.boundingSphere;return W!==null&&(this.boundingSphere=W.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function nt(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Ke.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}Object.defineProperty(nt.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(nt.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=e!==void 0?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,a=this.itemSize;r<a;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new Ue),t[n++]=s.r,t[n++]=s.g,t[n++]=s.b}return this},copyIndicesArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var s=e[r];t[n++]=s.a,t[n++]=s.b,t[n++]=s.c}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new me),t[n++]=s.x,t[n++]=s.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new I),t[n++]=s.x,t[n++]=s.y,t[n++]=s.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var s=e[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new At),t[n++]=s.x,t[n++]=s.y,t[n++]=s.z,t[n++]=s.w}return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,a){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=a,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}});function af(e,t,n){nt.call(this,new Int8Array(e),t,n)}af.prototype=Object.create(nt.prototype),af.prototype.constructor=af;function sf(e,t,n){nt.call(this,new Uint8Array(e),t,n)}sf.prototype=Object.create(nt.prototype),sf.prototype.constructor=sf;function of(e,t,n){nt.call(this,new Uint8ClampedArray(e),t,n)}of.prototype=Object.create(nt.prototype),of.prototype.constructor=of;function uf(e,t,n){nt.call(this,new Int16Array(e),t,n)}uf.prototype=Object.create(nt.prototype),uf.prototype.constructor=uf;function Ga(e,t,n){nt.call(this,new Uint16Array(e),t,n)}Ga.prototype=Object.create(nt.prototype),Ga.prototype.constructor=Ga;function ff(e,t,n){nt.call(this,new Int32Array(e),t,n)}ff.prototype=Object.create(nt.prototype),ff.prototype.constructor=ff;function Ha(e,t,n){nt.call(this,new Uint32Array(e),t,n)}Ha.prototype=Object.create(nt.prototype),Ha.prototype.constructor=Ha;function _e(e,t,n){nt.call(this,new Float32Array(e),t,n)}_e.prototype=Object.create(nt.prototype),_e.prototype.constructor=_e;function hf(e,t,n){nt.call(this,new Float64Array(e),t,n)}hf.prototype=Object.create(nt.prototype),hf.prototype.constructor=hf;function Yc(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(Yc.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,a=e.faces,s=0;s<a.length;s++){var u=a[s];u.materialIndex!==r&&(r=u.materialIndex,t!==void 0&&(t.count=s*3-t.start,n.push(t)),t={start:s*3,materialIndex:r})}t!==void 0&&(t.count=s*3-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t=e.faces,n=e.vertices,r=e.faceVertexUvs,a=r[0]&&r[0].length>0,s=r[1]&&r[1].length>0,u=e.morphTargets,f=u.length,h;if(f>0){h=[];for(var l=0;l<f;l++)h[l]=[];this.morphTargets.position=h}var p=e.morphNormals,d=p.length,v;if(d>0){v=[];for(var l=0;l<d;l++)v[l]=[];this.morphTargets.normal=v}for(var m=e.skinIndices,y=e.skinWeights,x=m.length===n.length,b=y.length===n.length,l=0;l<t.length;l++){var w=t[l];this.vertices.push(n[w.a],n[w.b],n[w.c]);var E=w.vertexNormals;if(E.length===3)this.normals.push(E[0],E[1],E[2]);else{var T=w.normal;this.normals.push(T,T,T)}var M=w.vertexColors;if(M.length===3)this.colors.push(M[0],M[1],M[2]);else{var P=w.color;this.colors.push(P,P,P)}if(a===!0){var O=r[0][l];O!==void 0?this.uvs.push(O[0],O[1],O[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new me,new me,new me))}if(s===!0){var O=r[1][l];O!==void 0?this.uvs2.push(O[0],O[1],O[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new me,new me,new me))}for(var U=0;U<f;U++){var W=u[U].vertices;h[U].push(W[w.a],W[w.b],W[w.c])}for(var U=0;U<d;U++){var B=p[U].vertexNormals[l];v[U].push(B.a,B.b,B.c)}x&&this.skinIndices.push(m[w.a],m[w.b],m[w.c]),b&&this.skinWeights.push(y[w.a],y[w.b],y[w.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});function cf(e){if(e.length===0)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}var My=1;function Re(){Object.defineProperty(this,"id",{value:My+=2}),this.uuid=Ke.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}Object.assign(Re.prototype,Br.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(cf(e)>65535?Ha:Ga)(e,1):this.index=e},addAttribute:function(e,t){if(!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)){console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new nt(arguments[1],arguments[2]));return}if(e==="index"){console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t);return}return this.attributes[e]=t,this},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;t!==void 0&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;if(n!==void 0){var r=new Mn().getNormalMatrix(e);r.applyToBufferAttribute(n),n.needsUpdate=!0}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(){var e=new Ve;return function(n){return e.makeRotationX(n),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Ve;return function(n){return e.makeRotationY(n),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Ve;return function(n){return e.makeRotationZ(n),this.applyMatrix(e),this}}(),translate:function(){var e=new Ve;return function(n,r,a){return e.makeTranslation(n,r,a),this.applyMatrix(e),this}}(),scale:function(){var e=new Ve;return function(n,r,a){return e.makeScale(n,r,a),this.applyMatrix(e),this}}(),lookAt:function(){var e=new we;return function(n){e.lookAt(n),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new _e(t.vertices.length*3,3),r=new _e(t.colors.length*3,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var a=new _e(t.lineDistances.length,1);this.addAttribute("lineDistance",a.copyArray(t.lineDistances))}t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];t.push(a.x,a.y,a.z||0)}return this.addAttribute("position",new _e(t,3)),this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var n=t.__directGeometry;if(t.elementsNeedUpdate===!0&&(n=void 0,t.elementsNeedUpdate=!1),n===void 0)return this.fromGeometry(t);n.verticesNeedUpdate=t.verticesNeedUpdate,n.normalsNeedUpdate=t.normalsNeedUpdate,n.colorsNeedUpdate=t.colorsNeedUpdate,n.uvsNeedUpdate=t.uvsNeedUpdate,n.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=n}var r;return t.verticesNeedUpdate===!0&&(r=this.attributes.position,r!==void 0&&(r.copyVector3sArray(t.vertices),r.needsUpdate=!0),t.verticesNeedUpdate=!1),t.normalsNeedUpdate===!0&&(r=this.attributes.normal,r!==void 0&&(r.copyVector3sArray(t.normals),r.needsUpdate=!0),t.normalsNeedUpdate=!1),t.colorsNeedUpdate===!0&&(r=this.attributes.color,r!==void 0&&(r.copyColorsArray(t.colors),r.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(r=this.attributes.uv,r!==void 0&&(r.copyVector2sArray(t.uvs),r.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(r=this.attributes.lineDistance,r!==void 0&&(r.copyArray(t.lineDistances),r.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new Yc().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(e.vertices.length*3);if(this.addAttribute("position",new nt(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(e.normals.length*3);this.addAttribute("normal",new nt(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(e.colors.length*3);this.addAttribute("color",new nt(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var a=new Float32Array(e.uvs.length*2);this.addAttribute("uv",new nt(a,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var s=new Float32Array(e.uvs2.length*2);this.addAttribute("uv2",new nt(s,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var u=cf(e.indices)>65535?Uint32Array:Uint16Array,f=new u(e.indices.length*3);this.setIndex(new nt(f,1).copyIndicesArray(e.indices))}this.groups=e.groups;for(var h in e.morphTargets){for(var l=[],p=e.morphTargets[h],d=0,v=p.length;d<v;d++){var m=p[d],y=new _e(m.length*3,3);l.push(y.copyVector3sArray(m))}this.morphAttributes[h]=l}if(e.skinIndices.length>0){var x=new _e(e.skinIndices.length*4,4);this.addAttribute("skinIndex",x.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var b=new _e(e.skinWeights.length*4,4);this.addAttribute("skinWeight",b.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Hr);var e=this.attributes.position;e!==void 0?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Hr,t=new I;return function(){this.boundingSphere===null&&(this.boundingSphere=new fr);var r=this.attributes.position;if(r){var a=this.boundingSphere.center;e.setFromBufferAttribute(r),e.getCenter(a);for(var s=0,u=0,f=r.count;u<f;u++)t.x=r.getX(u),t.y=r.getY(u),t.z=r.getZ(u),s=Math.max(s,a.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,n=this.groups;if(t.position){var r=t.position.array;if(t.normal===void 0)this.addAttribute("normal",new nt(new Float32Array(r.length),3));else for(var a=t.normal.array,s=0,u=a.length;s<u;s++)a[s]=0;var f=t.normal.array,h,l,p,d=new I,v=new I,m=new I,y=new I,x=new I;if(e){var b=e.array;n.length===0&&this.addGroup(0,b.length);for(var w=0,E=n.length;w<E;++w)for(var T=n[w],M=T.start,P=T.count,s=M,u=M+P;s<u;s+=3)h=b[s+0]*3,l=b[s+1]*3,p=b[s+2]*3,d.fromArray(r,h),v.fromArray(r,l),m.fromArray(r,p),y.subVectors(m,v),x.subVectors(d,v),y.cross(x),f[h]+=y.x,f[h+1]+=y.y,f[h+2]+=y.z,f[l]+=y.x,f[l+1]+=y.y,f[l+2]+=y.z,f[p]+=y.x,f[p+1]+=y.y,f[p+2]+=y.z}else for(var s=0,u=r.length;s<u;s+=9)d.fromArray(r,s),v.fromArray(r,s+3),m.fromArray(r,s+6),y.subVectors(m,v),x.subVectors(d,v),y.cross(x),f[s]=y.x,f[s+1]=y.y,f[s+2]=y.z,f[s+3]=y.x,f[s+4]=y.y,f[s+5]=y.z,f[s+6]=y.x,f[s+7]=y.y,f[s+8]=y.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0);var n=this.attributes;for(var r in n)if(e.attributes[r]!==void 0)for(var a=n[r],s=a.array,u=e.attributes[r],f=u.array,h=u.itemSize,l=0,p=h*t;l<f.length;l++,p++)s[p]=f[l];return this},normalizeNormals:function(){var e=new I;return function(){for(var n=this.attributes.normal,r=0,a=n.count;r<a;r++)e.x=n.getX(r),e.y=n.getY(r),e.z=n.getZ(r),e.normalize(),n.setXYZ(r,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Re,t=this.index.array,n=this.attributes;for(var r in n){for(var a=n[r],s=a.array,u=a.itemSize,f=new s.constructor(t.length*u),h=0,l=0,p=0,d=t.length;p<d;p++){h=t[p]*u;for(var v=0;v<u;v++)f[l++]=s[h++]}e.addAttribute(r,new nt(f,u))}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var t=this.parameters;for(var n in t)t[n]!==void 0&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;if(r!==null){var a=Array.prototype.slice.call(r.array);e.data.index={type:r.array.constructor.name,array:a}}var s=this.attributes;for(var n in s){var u=s[n],a=Array.prototype.slice.call(u.array);e.data.attributes[n]={itemSize:u.itemSize,type:u.array.constructor.name,array:a,normalized:u.normalized}}var f=this.groups;f.length>0&&(e.data.groups=JSON.parse(JSON.stringify(f)));var h=this.boundingSphere;return h!==null&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e},clone:function(){return new Re().copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var a=e.index;a!==null&&this.setIndex(a.clone());var s=e.attributes;for(t in s){var u=s[t];this.addAttribute(t,u.clone())}var f=e.morphAttributes;for(t in f){var h=[],l=f[t];for(n=0,r=l.length;n<r;n++)h.push(l[n].clone());this.morphAttributes[t]=h}var p=e.groups;for(n=0,r=p.length;n<r;n++){var d=p[n];this.addGroup(d.start,d.count,d.materialIndex)}var v=e.boundingBox;v!==null&&(this.boundingBox=v.clone());var m=e.boundingSphere;return m!==null&&(this.boundingSphere=m.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function ro(e,t,n,r,a,s){We.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:a,depthSegments:s},this.fromBufferGeometry(new Hi(e,t,n,r,a,s)),this.mergeVertices()}ro.prototype=Object.create(We.prototype),ro.prototype.constructor=ro;function Hi(e,t,n,r,a,s){Re.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:a,depthSegments:s};var u=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,a=Math.floor(a)||1,s=Math.floor(s)||1;var f=[],h=[],l=[],p=[],d=0,v=0;m("z","y","x",-1,-1,n,t,e,s,a,0),m("z","y","x",1,-1,n,t,-e,s,a,1),m("x","z","y",1,1,e,n,t,r,s,2),m("x","z","y",1,-1,e,n,-t,r,s,3),m("x","y","z",1,-1,e,t,n,r,a,4),m("x","y","z",-1,-1,e,t,-n,r,a,5),this.setIndex(f),this.addAttribute("position",new _e(h,3)),this.addAttribute("normal",new _e(l,3)),this.addAttribute("uv",new _e(p,2));function m(y,x,b,w,E,T,M,P,O,U,W){var B=T/O,V=M/U,X=T/2,re=M/2,z=P/2,D=O+1,ee=U+1,K=0,te=0,$,ue,he=new I;for(ue=0;ue<ee;ue++){var oe=ue*V-re;for($=0;$<D;$++){var ve=$*B-X;he[y]=ve*w,he[x]=oe*E,he[b]=z,h.push(he.x,he.y,he.z),he[y]=0,he[x]=0,he[b]=P>0?1:-1,l.push(he.x,he.y,he.z),p.push($/O),p.push(1-ue/U),K+=1}}for(ue=0;ue<U;ue++)for($=0;$<O;$++){var pe=d+$+D*ue,Ae=d+$+D*(ue+1),Z=d+($+1)+D*(ue+1),Ce=d+($+1)+D*ue;f.push(pe,Ae,Ce),f.push(Ae,Z,Ce),te+=6}u.addGroup(v,te,W),v+=te,d+=K}}Hi.prototype=Object.create(Re.prototype),Hi.prototype.constructor=Hi;function io(e,t,n,r){We.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Vi(e,t,n,r)),this.mergeVertices()}io.prototype=Object.create(We.prototype),io.prototype.constructor=io;function Vi(e,t,n,r){Re.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},e=e||1,t=t||1;var a=e/2,s=t/2,u=Math.floor(n)||1,f=Math.floor(r)||1,h=u+1,l=f+1,p=e/u,d=t/f,v,m,y=[],x=[],b=[],w=[];for(m=0;m<l;m++){var E=m*d-s;for(v=0;v<h;v++){var T=v*p-a;x.push(T,-E,0),b.push(0,0,1),w.push(v/u),w.push(1-m/f)}}for(m=0;m<f;m++)for(v=0;v<u;v++){var M=v+h*m,P=v+h*(m+1),O=v+1+h*(m+1),U=v+1+h*m;y.push(M,P,U),y.push(P,O,U)}this.setIndex(y),this.addAttribute("position",new _e(x,3)),this.addAttribute("normal",new _e(b,3)),this.addAttribute("uv",new _e(w,2))}Vi.prototype=Object.create(Re.prototype),Vi.prototype.constructor=Vi;function vn(e){at.call(this),this.type="MeshBasicMaterial",this.color=new Ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=js,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}vn.prototype=Object.create(at.prototype),vn.prototype.constructor=vn,vn.prototype.isMeshBasicMaterial=!0,vn.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};function $n(e){at.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}$n.prototype=Object.create(at.prototype),$n.prototype.constructor=$n,$n.prototype.isShaderMaterial=!0,$n.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Tn.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},$n.prototype.toJSON=function(e){var t=at.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t};function Wi(e,t){this.origin=e!==void 0?e:new I,this.direction=t!==void 0?t:new I}Object.assign(Wi.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){var n=t||new I;return n.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new I;return function(n){return this.origin.copy(this.at(n,e)),this}}(),closestPointToPoint:function(e,t){var n=t||new I;n.subVectors(e,this.origin);var r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new I;return function(n){var r=e.subVectors(n,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(n):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(n))}}(),distanceSqToSegment:function(){var e=new I,t=new I,n=new I;return function(a,s,u,f){e.copy(a).add(s).multiplyScalar(.5),t.copy(s).sub(a).normalize(),n.copy(this.origin).sub(e);var h=a.distanceTo(s)*.5,l=-this.direction.dot(t),p=n.dot(this.direction),d=-n.dot(t),v=n.lengthSq(),m=Math.abs(1-l*l),y,x,b,w;if(m>0)if(y=l*d-p,x=l*p-d,w=h*m,y>=0)if(x>=-w)if(x<=w){var E=1/m;y*=E,x*=E,b=y*(y+l*x+2*p)+x*(l*y+x+2*d)+v}else x=h,y=Math.max(0,-(l*x+p)),b=-y*y+x*(x+2*d)+v;else x=-h,y=Math.max(0,-(l*x+p)),b=-y*y+x*(x+2*d)+v;else x<=-w?(y=Math.max(0,-(-l*h+p)),x=y>0?-h:Math.min(Math.max(-h,-d),h),b=-y*y+x*(x+2*d)+v):x<=w?(y=0,x=Math.min(Math.max(-h,-d),h),b=x*(x+2*d)+v):(y=Math.max(0,-(l*h+p)),x=y>0?h:Math.min(Math.max(-h,-d),h),b=-y*y+x*(x+2*d)+v);else x=l>0?-h:h,y=Math.max(0,-(l*x+p)),b=-y*y+x*(x+2*d)+v;return u&&u.copy(this.direction).multiplyScalar(y).add(this.origin),f&&f.copy(t).multiplyScalar(x).add(e),b}}(),intersectSphere:function(){var e=new I;return function(n,r){e.subVectors(n.center,this.origin);var a=e.dot(this.direction),s=e.dot(e)-a*a,u=n.radius*n.radius;if(s>u)return null;var f=Math.sqrt(u-s),h=a-f,l=a+f;return h<0&&l<0?null:h<0?this.at(l,r):this.at(h,r)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return n===null?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);if(t===0)return!0;var n=e.normal.dot(this.direction);return n*t<0},intersectBox:function(e,t){var n,r,a,s,u,f,h=1/this.direction.x,l=1/this.direction.y,p=1/this.direction.z,d=this.origin;return h>=0?(n=(e.min.x-d.x)*h,r=(e.max.x-d.x)*h):(n=(e.max.x-d.x)*h,r=(e.min.x-d.x)*h),l>=0?(a=(e.min.y-d.y)*l,s=(e.max.y-d.y)*l):(a=(e.max.y-d.y)*l,s=(e.min.y-d.y)*l),n>s||a>r||((a>n||n!==n)&&(n=a),(s<r||r!==r)&&(r=s),p>=0?(u=(e.min.z-d.z)*p,f=(e.max.z-d.z)*p):(u=(e.max.z-d.z)*p,f=(e.min.z-d.z)*p),n>f||u>r)||((u>n||n!==n)&&(n=u),(f<r||r!==r)&&(r=f),r<0)?null:this.at(n>=0?n:r,t)},intersectsBox:function(){var e=new I;return function(n){return this.intersectBox(n,e)!==null}}(),intersectTriangle:function(){var e=new I,t=new I,n=new I,r=new I;return function(s,u,f,h,l){t.subVectors(u,s),n.subVectors(f,s),r.crossVectors(t,n);var p=this.direction.dot(r),d;if(p>0){if(h)return null;d=1}else if(p<0)d=-1,p=-p;else return null;e.subVectors(this.origin,s);var v=d*this.direction.dot(n.crossVectors(e,n));if(v<0)return null;var m=d*this.direction.dot(t.cross(e));if(m<0||v+m>p)return null;var y=-d*e.dot(r);return y<0?null:this.at(y/p,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});function Va(e,t){this.start=e!==void 0?e:new I,this.end=t!==void 0?t:new I}Object.assign(Va.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){var t=e||new I;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new I;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var n=t||new I;return this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new I,t=new I;return function(r,a){e.subVectors(r,this.start),t.subVectors(this.end,this.start);var s=t.dot(t),u=t.dot(e),f=u/s;return a&&(f=Ke.clamp(f,0,1)),f}}(),closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t),a=n||new I;return this.delta(a).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});function Vr(e,t,n){this.a=e!==void 0?e:new I,this.b=t!==void 0?t:new I,this.c=n!==void 0?n:new I}Object.assign(Vr,{normal:function(){var e=new I;return function(n,r,a,s){var u=s||new I;u.subVectors(a,r),e.subVectors(n,r),u.cross(e);var f=u.lengthSq();return f>0?u.multiplyScalar(1/Math.sqrt(f)):u.set(0,0,0)}}(),barycoordFromPoint:function(){var e=new I,t=new I,n=new I;return function(a,s,u,f,h){e.subVectors(f,s),t.subVectors(u,s),n.subVectors(a,s);var l=e.dot(e),p=e.dot(t),d=e.dot(n),v=t.dot(t),m=t.dot(n),y=l*v-p*p,x=h||new I;if(y===0)return x.set(-2,-1,-1);var b=1/y,w=(v*d-p*m)*b,E=(l*m-p*d)*b;return x.set(1-w-E,E,w)}}(),containsPoint:function(){var e=new I;return function(n,r,a,s){var u=Vr.barycoordFromPoint(n,r,a,s,e);return u.x>=0&&u.y>=0&&u.x+u.y<=1}}()}),Object.assign(Vr.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new I,t=new I;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),e.cross(t).length()*.5}}(),midpoint:function(e){var t=e||new I;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return Vr.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new Kn;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return Vr.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Vr.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var e=new Kn,t=[new Va,new Va,new Va],n=new I,r=new I;return function(s,u){var f=u||new I,h=1/0;if(e.setFromCoplanarPoints(this.a,this.b,this.c),e.projectPoint(s,n),this.containsPoint(n)===!0)f.copy(n);else{t[0].set(this.a,this.b),t[1].set(this.b,this.c),t[2].set(this.c,this.a);for(var l=0;l<t.length;l++){t[l].closestPointToPoint(n,!0,r);var p=n.distanceToSquared(r);p<h&&(h=p,f.copy(r))}}return f}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});function jt(e,t){we.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new Re,this.material=t!==void 0?t:new vn({color:Math.random()*16777215}),this.drawMode=Rc,this.updateMorphTargets()}jt.prototype=Object.assign(Object.create(we.prototype),{constructor:jt,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return we.prototype.copy.call(this,e),this.drawMode=e.drawMode,e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry,t,n,r;if(e.isBufferGeometry){var a=e.morphAttributes,s=Object.keys(a);if(s.length>0){var u=a[s[0]];if(u!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,n=u.length;t<n;t++)r=u[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}else{var f=e.morphTargets;if(f!==void 0&&f.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,n=f.length;t<n;t++)r=f[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}},raycast:function(){var e=new Ve,t=new Wi,n=new fr,r=new I,a=new I,s=new I,u=new I,f=new I,h=new I,l=new me,p=new me,d=new me,v=new I,m=new I,y=new I;function x(E,T,M,P,O,U,W){return Vr.barycoordFromPoint(E,T,M,P,v),O.multiplyScalar(v.x),U.multiplyScalar(v.y),W.multiplyScalar(v.z),O.add(U).add(W),O.clone()}function b(E,T,M,P,O,U,W,B){var V;if(T.side===ri?V=P.intersectTriangle(W,U,O,!0,B):V=P.intersectTriangle(O,U,W,T.side!==Ia,B),V===null)return null;y.copy(B),y.applyMatrix4(E.matrixWorld);var X=M.ray.origin.distanceTo(y);return X<M.near||X>M.far?null:{distance:X,point:y.clone(),object:E}}function w(E,T,M,P,O,U,W,B){r.fromBufferAttribute(P,U),a.fromBufferAttribute(P,W),s.fromBufferAttribute(P,B);var V=b(E,E.material,T,M,r,a,s,m);return V&&(O&&(l.fromBufferAttribute(O,U),p.fromBufferAttribute(O,W),d.fromBufferAttribute(O,B),V.uv=x(m,r,a,s,l,p,d)),V.face=new fi(U,W,B,Vr.normal(r,a,s)),V.faceIndex=U),V}return function(T,M){var P=this.geometry,O=this.material,U=this.matrixWorld;if(O!==void 0&&(P.boundingSphere===null&&P.computeBoundingSphere(),n.copy(P.boundingSphere),n.applyMatrix4(U),T.ray.intersectsSphere(n)!==!1&&(e.getInverse(U),t.copy(T.ray).applyMatrix4(e),!(P.boundingBox!==null&&t.intersectsBox(P.boundingBox)===!1)))){var W;if(P.isBufferGeometry){var B,V,X,re=P.index,z=P.attributes.position,D=P.attributes.uv,ee,K;if(re!==null)for(ee=0,K=re.count;ee<K;ee+=3)B=re.getX(ee),V=re.getX(ee+1),X=re.getX(ee+2),W=w(this,T,t,z,D,B,V,X),W&&(W.faceIndex=Math.floor(ee/3),M.push(W));else if(z!==void 0)for(ee=0,K=z.count;ee<K;ee+=3)B=ee,V=ee+1,X=ee+2,W=w(this,T,t,z,D,B,V,X),W&&(W.index=B,M.push(W))}else if(P.isGeometry){var te,$,ue,he=Array.isArray(O),oe=P.vertices,ve=P.faces,pe,Ae=P.faceVertexUvs[0];Ae.length>0&&(pe=Ae);for(var Z=0,Ce=ve.length;Z<Ce;Z++){var J=ve[Z],Pe=he?O[J.materialIndex]:O;if(Pe!==void 0){if(te=oe[J.a],$=oe[J.b],ue=oe[J.c],Pe.morphTargets===!0){var de=P.morphTargets,Ie=this.morphTargetInfluences;r.set(0,0,0),a.set(0,0,0),s.set(0,0,0);for(var Ze=0,ft=de.length;Ze<ft;Ze++){var gt=Ie[Ze];if(gt!==0){var st=de[Ze].vertices;r.addScaledVector(u.subVectors(st[J.a],te),gt),a.addScaledVector(f.subVectors(st[J.b],$),gt),s.addScaledVector(h.subVectors(st[J.c],ue),gt)}}r.add(te),a.add($),s.add(ue),te=r,$=a,ue=s}if(W=b(this,Pe,T,t,te,$,ue,m),W){if(pe&&pe[Z]){var Je=pe[Z];l.copy(Je[0]),p.copy(Je[1]),d.copy(Je[2]),W.uv=x(m,te,$,ue,l,p,d)}W.face=J,W.faceIndex=Z,M.push(W)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Ty(e,t,n,r){var a=new Ue(0),s=0,u,f,h;function l(d,v,m,y){var x=v.background;x===null?p(a,s):x&&x.isColor&&(p(x,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),x&&x.isCubeTexture?(h===void 0&&(h=new jt(new Hi(1,1,1),new $n({uniforms:Gi.cube.uniforms,vertexShader:Gi.cube.vertexShader,fragmentShader:Gi.cube.fragmentShader,side:ri,depthTest:!0,depthWrite:!1,fog:!1})),h.geometry.removeAttribute("normal"),h.geometry.removeAttribute("uv"),h.onBeforeRender=function(b,w,E){this.matrixWorld.copyPosition(E.matrixWorld)},n.update(h.geometry)),h.material.uniforms.tCube.value=x,d.push(h,h.geometry,h.material,0,null)):x&&x.isTexture&&(u===void 0&&(u=new za(-1,1,1,-1,0,1),f=new jt(new Vi(2,2),new vn({depthTest:!1,depthWrite:!1,fog:!1})),n.update(f.geometry)),f.material.map=x,e.renderBufferDirect(u,null,f.geometry,f.material,f,null))}function p(d,v){t.buffers.color.setClear(d.r,d.g,d.b,v,r)}return{getClearColor:function(){return a},setClearColor:function(d,v){a.set(d),s=v!==void 0?v:1,p(a,s)},getClearAlpha:function(){return s},setClearAlpha:function(d){s=d,p(a,s)},render:l}}function Sy(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Ay(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Ly(){var e=[],t=0,n=[],r=[];function a(){t=0,n.length=0,r.length=0}function s(f,h,l,p,d){var v=e[t];v===void 0?(v={id:f.id,object:f,geometry:h,material:l,program:l.program,renderOrder:f.renderOrder,z:p,group:d},e[t]=v):(v.id=f.id,v.object=f,v.geometry=h,v.material=l,v.program=l.program,v.renderOrder=f.renderOrder,v.z=p,v.group=d),(l.transparent===!0?r:n).push(v),t++}function u(){n.length>1&&n.sort(Sy),r.length>1&&r.sort(Ay)}return{opaque:n,transparent:r,init:a,push:s,sort:u}}function Ry(){var e={};function t(r,a){var s=r.id+","+a.id,u=e[s];return u===void 0&&(u=new Ly,e[s]=u),u}function n(){e={}}return{get:t,dispose:n}}function Cy(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Py(e){var t={},n=new Float32Array(8);function r(a,s,u,f){var h=a.morphTargetInfluences,l=h.length,p=t[s.id];if(p===void 0){p=[];for(var d=0;d<l;d++)p[d]=[d,0];t[s.id]=p}for(var v=u.morphTargets&&s.morphAttributes.position,m=u.morphNormals&&s.morphAttributes.normal,d=0;d<l;d++){var y=p[d];y[1]!==0&&(v&&s.removeAttribute("morphTarget"+d),m&&s.removeAttribute("morphNormal"+d))}for(var d=0;d<l;d++){var y=p[d];y[0]=d,y[1]=h[d]}p.sort(Cy);for(var d=0;d<8;d++){var y=p[d];if(y){var x=y[0],b=y[1];if(b){v&&s.addAttribute("morphTarget"+d,v[x]),m&&s.addAttribute("morphNormal"+d,m[x]),n[d]=b;continue}}n[d]=0}f.getUniforms().setValue(e,"morphTargetInfluences",n)}return{update:r}}function Iy(e,t,n){var r;function a(p){r=p}var s,u;function f(p){s=p.type,u=p.bytesPerElement}function h(p,d){e.drawElements(r,d,s,p*u),n.calls++,n.vertices+=d,r===e.TRIANGLES?n.faces+=d/3:r===e.POINTS&&(n.points+=d)}function l(p,d,v){var m=t.get("ANGLE_instanced_arrays");if(m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m.drawElementsInstancedANGLE(r,v,s,d*u,p.maxInstancedCount),n.calls++,n.vertices+=v*p.maxInstancedCount,r===e.TRIANGLES?n.faces+=p.maxInstancedCount*v/3:r===e.POINTS&&(n.points+=p.maxInstancedCount*v)}this.setMode=a,this.setIndex=f,this.render=h,this.renderInstances=l}function Dy(e,t,n){var r;function a(f){r=f}function s(f,h){e.drawArrays(r,f,h),n.calls++,n.vertices+=h,r===e.TRIANGLES?n.faces+=h/3:r===e.POINTS&&(n.points+=h)}function u(f,h,l){var p=t.get("ANGLE_instanced_arrays");if(p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}var d=f.attributes.position;d.isInterleavedBufferAttribute?(l=d.data.count,p.drawArraysInstancedANGLE(r,0,l,f.maxInstancedCount)):p.drawArraysInstancedANGLE(r,h,l,f.maxInstancedCount),n.calls++,n.vertices+=l*f.maxInstancedCount,r===e.TRIANGLES?n.faces+=f.maxInstancedCount*l/3:r===e.POINTS&&(n.points+=f.maxInstancedCount*l)}this.setMode=a,this.render=s,this.renderInstances=u}function Oy(e,t,n){var r={},a={};function s(l){var p=l.target,d=r[p.id];d.index!==null&&t.remove(d.index);for(var v in d.attributes)t.remove(d.attributes[v]);p.removeEventListener("dispose",s),delete r[p.id];var m=a[p.id];m&&(t.remove(m),delete a[p.id]),m=a[d.id],m&&(t.remove(m),delete a[d.id]),n.geometries--}function u(l,p){var d=r[p.id];return d||(p.addEventListener("dispose",s),p.isBufferGeometry?d=p:p.isGeometry&&(p._bufferGeometry===void 0&&(p._bufferGeometry=new Re().setFromObject(l)),d=p._bufferGeometry),r[p.id]=d,n.geometries++,d)}function f(l){var p=l.index,d=l.attributes;p!==null&&t.update(p,e.ELEMENT_ARRAY_BUFFER);for(var v in d)t.update(d[v],e.ARRAY_BUFFER);var m=l.morphAttributes;for(var v in m)for(var y=m[v],x=0,b=y.length;x<b;x++)t.update(y[x],e.ARRAY_BUFFER)}function h(l){var p=a[l.id];if(p)return p;var d=[],v=l.index,m=l.attributes;if(v!==null)for(var y=v.array,x=0,b=y.length;x<b;x+=3){var w=y[x+0],E=y[x+1],T=y[x+2];d.push(w,E,E,T,T,w)}else for(var y=m.position.array,x=0,b=y.length/3-1;x<b;x+=3){var w=x+0,E=x+1,T=x+2;d.push(w,E,E,T,T,w)}return p=new(cf(d)>65535?Ha:Ga)(d,1),t.update(p,e.ELEMENT_ARRAY_BUFFER),a[l.id]=p,p}return{get:u,update:f,getWireframeAttribute:h}}function Uy(){var e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new I,color:new Ue,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new me};break;case"SpotLight":n={position:new I,direction:new I,color:new Ue,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new me};break;case"PointLight":n={position:new I,color:new Ue,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new me,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new I,skyColor:new Ue,groundColor:new Ue};break;case"RectAreaLight":n={color:new Ue,position:new I,halfWidth:new I,halfHeight:new I};break}return e[t.id]=n,n}}}function Fy(){var e=new Uy,t={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new I,r=new Ve,a=new Ve;function s(u,f,h){for(var l=0,p=0,d=0,v=0,m=0,y=0,x=0,b=0,w=h.matrixWorldInverse,E=0,T=u.length;E<T;E++){var M=u[E],P=M.color,O=M.intensity,U=M.distance,W=M.shadow&&M.shadow.map?M.shadow.map.texture:null;if(M.isAmbientLight)l+=P.r*O,p+=P.g*O,d+=P.b*O;else if(M.isDirectionalLight){var B=e.get(M);if(B.color.copy(M.color).multiplyScalar(M.intensity),B.direction.setFromMatrixPosition(M.matrixWorld),n.setFromMatrixPosition(M.target.matrixWorld),B.direction.sub(n),B.direction.transformDirection(w),B.shadow=M.castShadow,M.castShadow){var V=M.shadow;B.shadowBias=V.bias,B.shadowRadius=V.radius,B.shadowMapSize=V.mapSize}t.directionalShadowMap[v]=W,t.directionalShadowMatrix[v]=M.shadow.matrix,t.directional[v]=B,v++}else if(M.isSpotLight){var B=e.get(M);if(B.position.setFromMatrixPosition(M.matrixWorld),B.position.applyMatrix4(w),B.color.copy(P).multiplyScalar(O),B.distance=U,B.direction.setFromMatrixPosition(M.matrixWorld),n.setFromMatrixPosition(M.target.matrixWorld),B.direction.sub(n),B.direction.transformDirection(w),B.coneCos=Math.cos(M.angle),B.penumbraCos=Math.cos(M.angle*(1-M.penumbra)),B.decay=M.distance===0?0:M.decay,B.shadow=M.castShadow,M.castShadow){var V=M.shadow;B.shadowBias=V.bias,B.shadowRadius=V.radius,B.shadowMapSize=V.mapSize}t.spotShadowMap[y]=W,t.spotShadowMatrix[y]=M.shadow.matrix,t.spot[y]=B,y++}else if(M.isRectAreaLight){var B=e.get(M);B.color.copy(P).multiplyScalar(O/(M.width*M.height)),B.position.setFromMatrixPosition(M.matrixWorld),B.position.applyMatrix4(w),a.identity(),r.copy(M.matrixWorld),r.premultiply(w),a.extractRotation(r),B.halfWidth.set(M.width*.5,0,0),B.halfHeight.set(0,M.height*.5,0),B.halfWidth.applyMatrix4(a),B.halfHeight.applyMatrix4(a),t.rectArea[x]=B,x++}else if(M.isPointLight){var B=e.get(M);if(B.position.setFromMatrixPosition(M.matrixWorld),B.position.applyMatrix4(w),B.color.copy(M.color).multiplyScalar(M.intensity),B.distance=M.distance,B.decay=M.distance===0?0:M.decay,B.shadow=M.castShadow,M.castShadow){var V=M.shadow;B.shadowBias=V.bias,B.shadowRadius=V.radius,B.shadowMapSize=V.mapSize,B.shadowCameraNear=V.camera.near,B.shadowCameraFar=V.camera.far}t.pointShadowMap[m]=W,t.pointShadowMatrix[m]=M.shadow.matrix,t.point[m]=B,m++}else if(M.isHemisphereLight){var B=e.get(M);B.direction.setFromMatrixPosition(M.matrixWorld),B.direction.transformDirection(w),B.direction.normalize(),B.skyColor.copy(M.color).multiplyScalar(O),B.groundColor.copy(M.groundColor).multiplyScalar(O),t.hemi[b]=B,b++}}t.ambient[0]=l,t.ambient[1]=p,t.ambient[2]=d,t.directional.length=v,t.spot.length=y,t.rectArea.length=x,t.point.length=m,t.hemi.length=b,t.hash=v+","+m+","+y+","+x+","+b+","+f.length}return{setup:s,state:t}}function Ny(e,t){var n={};function r(s){var u=t.frame,f=s.geometry,h=e.get(s,f);return n[h.id]!==u&&(f.isGeometry&&h.updateFromObject(s),e.update(h),n[h.id]=u),h}function a(){n={}}return{update:r,clear:a}}function By(e){for(var t=e.split(`
`),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join(`
`)}function qc(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),e.getShaderInfoLog(r)!==""&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(r),By(n)),r}var zy=0;function jc(e){switch(e){case to:return["Linear","( value )"];case Nv:return["sRGB","( value )"];case Bv:return["RGBE","( value )"];case zv:return["RGBM","( value, 7.0 )"];case Gv:return["RGBM","( value, 16.0 )"];case Hv:return["RGBD","( value, 256.0 )"];case Cc:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function lf(e,t){var n=jc(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Gy(e,t){var n=jc(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Hy(e,t){var n;switch(t){case mc:n="Linear";break;case _v:n="Reinhard";break;case xv:n="Uncharted2";break;case wv:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Vy(e,t,n){e=e||{};var r=[e.derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return r.filter(Wa).join(`
`)}function Wy(e){var t=[];for(var n in e){var r=e[n];r!==!1&&t.push("#define "+n+" "+r)}return t.join(`
`)}function ky(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),a=0;a<r;a++){var s=e.getActiveAttrib(t,a),u=s.name;n[u]=e.getAttribLocation(t,u)}return n}function Wa(e){return e!==""}function Zc(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function pf(e){var t=/^[ \t]*#include +<([\w\d.]+)>/gm;function n(r,a){var s=wt[a];if(s===void 0)throw new Error("Can not resolve #include <"+a+">");return pf(s)}return e.replace(t,n)}function Jc(e){var t=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function n(r,a,s,u){for(var f="",h=parseInt(a);h<parseInt(s);h++)f+=u.replace(/\[ i \]/g,"[ "+h+" ]");return f}return e.replace(t,n)}function Xy(e,t,n,r,a,s){var u=e.context,f=r.defines,h=a.vertexShader,l=a.fragmentShader,p="SHADOWMAP_TYPE_BASIC";s.shadowMapType===ac?p="SHADOWMAP_TYPE_PCF":s.shadowMapType===Kd&&(p="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",v="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(s.envMap){switch(r.envMap.mapping){case Xu:case Yu:d="ENVMAP_TYPE_CUBE";break;case ju:case Zu:d="ENVMAP_TYPE_CUBE_UV";break;case gc:case qu:d="ENVMAP_TYPE_EQUIREC";break;case yc:d="ENVMAP_TYPE_SPHERE";break}switch(r.envMap.mapping){case Yu:case qu:v="ENVMAP_MODE_REFRACTION";break}switch(r.combine){case js:m="ENVMAP_BLENDING_MULTIPLY";break;case gv:m="ENVMAP_BLENDING_MIX";break;case yv:m="ENVMAP_BLENDING_ADD";break}}var y=e.gammaFactor>0?e.gammaFactor:1,x=Vy(r.extensions,s,t),b=Wy(f),w=u.createProgram(),E,T;r.isRawShaderMaterial?(E=[b].filter(Wa).join(`
`),E.length>0&&(E+=`
`),T=[x,b].filter(Wa).join(`
`),T.length>0&&(T+=`
`)):(E=["precision "+s.precision+" float;","precision "+s.precision+" int;","#define SHADER_NAME "+a.name,b,s.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+s.maxBones,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+v:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.displacementMap&&s.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.flatShading?"#define FLAT_SHADED":"",s.skinning?"#define USE_SKINNING":"",s.useVertexTexture?"#define BONE_TEXTURE":"",s.morphTargets?"#define USE_MORPHTARGETS":"",s.morphNormals&&s.flatShading===!1?"#define USE_MORPHNORMALS":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+s.numClippingPlanes,s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+p:"",s.sizeAttenuation?"#define USE_SIZEATTENUATION":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Wa).join(`
`),T=[x,"precision "+s.precision+" float;","precision "+s.precision+" int;","#define SHADER_NAME "+a.name,b,s.alphaTest?"#define ALPHATEST "+s.alphaTest:"","#define GAMMA_FACTOR "+y,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+d:"",s.envMap?"#define "+v:"",s.envMap?"#define "+m:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.gradientMap?"#define USE_GRADIENTMAP":"",s.flatShading?"#define FLAT_SHADED":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+s.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(s.numClippingPlanes-s.numClipIntersection),s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+p:"",s.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",s.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",s.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",s.toneMapping!==Wu?"#define TONE_MAPPING":"",s.toneMapping!==Wu?wt.tonemapping_pars_fragment:"",s.toneMapping!==Wu?Hy("toneMapping",s.toneMapping):"",s.dithering?"#define DITHERING":"",s.outputEncoding||s.mapEncoding||s.envMapEncoding||s.emissiveMapEncoding?wt.encodings_pars_fragment:"",s.mapEncoding?lf("mapTexelToLinear",s.mapEncoding):"",s.envMapEncoding?lf("envMapTexelToLinear",s.envMapEncoding):"",s.emissiveMapEncoding?lf("emissiveMapTexelToLinear",s.emissiveMapEncoding):"",s.outputEncoding?Gy("linearToOutputTexel",s.outputEncoding):"",s.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Wa).join(`
`)),h=pf(h),h=Zc(h,s),l=pf(l),l=Zc(l,s),r.isShaderMaterial||(h=Jc(h),l=Jc(l));var M=E+h,P=T+l,O=qc(u,u.VERTEX_SHADER,M),U=qc(u,u.FRAGMENT_SHADER,P);u.attachShader(w,O),u.attachShader(w,U),r.index0AttributeName!==void 0?u.bindAttribLocation(w,0,r.index0AttributeName):s.morphTargets===!0&&u.bindAttribLocation(w,0,"position"),u.linkProgram(w);var W=u.getProgramInfoLog(w),B=u.getShaderInfoLog(O),V=u.getShaderInfoLog(U),X=!0,re=!0;u.getProgramParameter(w,u.LINK_STATUS)===!1?(X=!1,console.error("THREE.WebGLProgram: shader error: ",u.getError(),"gl.VALIDATE_STATUS",u.getProgramParameter(w,u.VALIDATE_STATUS),"gl.getProgramInfoLog",W,B,V)):W!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",W):(B===""||V==="")&&(re=!1),re&&(this.diagnostics={runnable:X,material:r,programLog:W,vertexShader:{log:B,prefix:E},fragmentShader:{log:V,prefix:T}}),u.deleteShader(O),u.deleteShader(U);var z;this.getUniforms=function(){return z===void 0&&(z=new ai(u,w,e)),z};var D;return this.getAttributes=function(){return D===void 0&&(D=ky(u,w)),D},this.destroy=function(){u.deleteProgram(w),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=zy++,this.code=n,this.usedTimes=1,this.program=w,this.vertexShader=O,this.fragmentShader=U,this}function Yy(e,t,n){var r=[],a={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},s=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function u(h){var l=h.skeleton,p=l.bones;if(n.floatVertexTextures)return 1024;var d=n.maxVertexUniforms,v=Math.floor((d-20)/4),m=Math.min(v,p.length);return m<p.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+p.length+" bones. This GPU supports "+m+"."),0):m}function f(h,l){var p;return h?h.isTexture?p=h.encoding:h.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),p=h.texture.encoding):p=to,p===to&&l&&(p=Cc),p}this.getParameters=function(h,l,p,d,v,m,y){var x=a[h.type],b=y.isSkinnedMesh?u(y):0,w=n.precision;h.precision!==null&&(w=n.getMaxPrecision(h.precision),w!==h.precision&&console.warn("THREE.WebGLProgram.getParameters:",h.precision,"not supported, using",w,"instead."));var E=e.getRenderTarget(),T={shaderID:x,precision:w,supportsVertexTextures:n.vertexTextures,outputEncoding:f(E?E.texture:null,e.gammaOutput),map:!!h.map,mapEncoding:f(h.map,e.gammaInput),envMap:!!h.envMap,envMapMode:h.envMap&&h.envMap.mapping,envMapEncoding:f(h.envMap,e.gammaInput),envMapCubeUV:!!h.envMap&&(h.envMap.mapping===ju||h.envMap.mapping===Zu),lightMap:!!h.lightMap,aoMap:!!h.aoMap,emissiveMap:!!h.emissiveMap,emissiveMapEncoding:f(h.emissiveMap,e.gammaInput),bumpMap:!!h.bumpMap,normalMap:!!h.normalMap,displacementMap:!!h.displacementMap,roughnessMap:!!h.roughnessMap,metalnessMap:!!h.metalnessMap,specularMap:!!h.specularMap,alphaMap:!!h.alphaMap,gradientMap:!!h.gradientMap,combine:h.combine,vertexColors:h.vertexColors,fog:!!d,useFog:h.fog,fogExp:d&&d.isFogExp2,flatShading:h.flatShading,sizeAttenuation:h.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:h.skinning&&b>0,maxBones:b,useVertexTexture:n.floatVertexTextures,morphTargets:h.morphTargets,morphNormals:h.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:l.directional.length,numPointLights:l.point.length,numSpotLights:l.spot.length,numRectAreaLights:l.rectArea.length,numHemiLights:l.hemi.length,numClippingPlanes:v,numClipIntersection:m,dithering:h.dithering,shadowMapEnabled:e.shadowMap.enabled&&y.receiveShadow&&p.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:h.premultipliedAlpha,alphaTest:h.alphaTest,doubleSided:h.side===Ia,flipSided:h.side===ri,depthPacking:h.depthPacking!==void 0?h.depthPacking:!1};return T},this.getProgramCode=function(h,l){var p=[];if(l.shaderID?p.push(l.shaderID):(p.push(h.fragmentShader),p.push(h.vertexShader)),h.defines!==void 0)for(var d in h.defines)p.push(d),p.push(h.defines[d]);for(var v=0;v<s.length;v++)p.push(l[s[v]]);return p.push(h.onBeforeCompile.toString()),p.push(e.gammaOutput),p.join()},this.acquireProgram=function(h,l,p,d){for(var v,m=0,y=r.length;m<y;m++){var x=r[m];if(x.code===d){v=x,++v.usedTimes;break}}return v===void 0&&(v=new Xy(e,t,d,h,l,p),r.push(v)),v},this.releaseProgram=function(h){if(--h.usedTimes===0){var l=r.indexOf(h);r[l]=r[r.length-1],r.pop(),h.destroy()}},this.programs=r}function qy(e,t,n,r,a,s,u){var f=typeof WebGL2RenderingContext<"u"&&e instanceof window.WebGL2RenderingContext;function h(z,D){if(z.width>D||z.height>D){var ee=D/Math.max(z.width,z.height),K=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");K.width=Math.floor(z.width*ee),K.height=Math.floor(z.height*ee);var te=K.getContext("2d");return te.drawImage(z,0,0,z.width,z.height,0,0,K.width,K.height),console.warn("THREE.WebGLRenderer: image is too big ("+z.width+"x"+z.height+"). Resized to "+K.width+"x"+K.height,z),K}return z}function l(z){return Ke.isPowerOfTwo(z.width)&&Ke.isPowerOfTwo(z.height)}function p(z){if(z instanceof HTMLImageElement||z instanceof HTMLCanvasElement||z instanceof ImageBitmap){var D=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");D.width=Ke.floorPowerOfTwo(z.width),D.height=Ke.floorPowerOfTwo(z.height);var ee=D.getContext("2d");return ee.drawImage(z,0,0,D.width,D.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+z.width+"x"+z.height+"). Resized to "+D.width+"x"+D.height,z),D}return z}function d(z){return z.wrapS!==Un||z.wrapT!==Un||z.minFilter!==Fn&&z.minFilter!==En}function v(z,D){return z.generateMipmaps&&D&&z.minFilter!==Fn&&z.minFilter!==En}function m(z){return z===Fn||z===Ju||z===Qu?e.NEAREST:e.LINEAR}function y(z){var D=z.target;D.removeEventListener("dispose",y),b(D),u.textures--}function x(z){var D=z.target;D.removeEventListener("dispose",x),w(D),u.textures--}function b(z){var D=r.get(z);if(z.image&&D.__image__webglTextureCube)e.deleteTexture(D.__image__webglTextureCube);else{if(D.__webglInit===void 0)return;e.deleteTexture(D.__webglTexture)}r.remove(z)}function w(z){var D=r.get(z),ee=r.get(z.texture);if(z){if(ee.__webglTexture!==void 0&&e.deleteTexture(ee.__webglTexture),z.depthTexture&&z.depthTexture.dispose(),z.isWebGLRenderTargetCube)for(var K=0;K<6;K++)e.deleteFramebuffer(D.__webglFramebuffer[K]),D.__webglDepthbuffer&&e.deleteRenderbuffer(D.__webglDepthbuffer[K]);else e.deleteFramebuffer(D.__webglFramebuffer),D.__webglDepthbuffer&&e.deleteRenderbuffer(D.__webglDepthbuffer);r.remove(z.texture),r.remove(z)}}function E(z,D){var ee=r.get(z);if(z.version>0&&ee.__version!==z.version){var K=z.image;if(K===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",z);else if(K.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",z);else{O(ee,z,D);return}}n.activeTexture(e.TEXTURE0+D),n.bindTexture(e.TEXTURE_2D,ee.__webglTexture)}function T(z,D){var ee=r.get(z);if(z.image.length===6)if(z.version>0&&ee.__version!==z.version){ee.__image__webglTextureCube||(z.addEventListener("dispose",y),ee.__image__webglTextureCube=e.createTexture(),u.textures++),n.activeTexture(e.TEXTURE0+D),n.bindTexture(e.TEXTURE_CUBE_MAP,ee.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,z.flipY);for(var K=z&&z.isCompressedTexture,te=z.image[0]&&z.image[0].isDataTexture,$=[],ue=0;ue<6;ue++)!K&&!te?$[ue]=h(z.image[ue],a.maxCubemapSize):$[ue]=te?z.image[ue].image:z.image[ue];var he=$[0],oe=l(he),ve=s.convert(z.format),pe=s.convert(z.type);P(e.TEXTURE_CUBE_MAP,z,oe);for(var ue=0;ue<6;ue++)if(!K)te?n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+ue,0,ve,$[ue].width,$[ue].height,0,ve,pe,$[ue].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+ue,0,ve,ve,pe,$[ue]);else for(var Ae,Z=$[ue].mipmaps,Ce=0,J=Z.length;Ce<J;Ce++)Ae=Z[Ce],z.format!==Gr&&z.format!==Ua?n.getCompressedTextureFormats().indexOf(ve)>-1?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+ue,Ce,ve,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+ue,Ce,ve,Ae.width,Ae.height,0,ve,pe,Ae.data);v(z,oe)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),ee.__version=z.version,z.onUpdate&&z.onUpdate(z)}else n.activeTexture(e.TEXTURE0+D),n.bindTexture(e.TEXTURE_CUBE_MAP,ee.__image__webglTextureCube)}function M(z,D){n.activeTexture(e.TEXTURE0+D),n.bindTexture(e.TEXTURE_CUBE_MAP,r.get(z).__webglTexture)}function P(z,D,ee){var K;if(ee?(e.texParameteri(z,e.TEXTURE_WRAP_S,s.convert(D.wrapS)),e.texParameteri(z,e.TEXTURE_WRAP_T,s.convert(D.wrapT)),e.texParameteri(z,e.TEXTURE_MAG_FILTER,s.convert(D.magFilter)),e.texParameteri(z,e.TEXTURE_MIN_FILTER,s.convert(D.minFilter))):(e.texParameteri(z,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(z,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),(D.wrapS!==Un||D.wrapT!==Un)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",D),e.texParameteri(z,e.TEXTURE_MAG_FILTER,m(D.magFilter)),e.texParameteri(z,e.TEXTURE_MIN_FILTER,m(D.minFilter)),D.minFilter!==Fn&&D.minFilter!==En&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",D)),K=t.get("EXT_texture_filter_anisotropic"),K){if(D.type===Oa&&t.get("OES_texture_float_linear")===null||D.type===$u&&t.get("OES_texture_half_float_linear")===null)return;(D.anisotropy>1||r.get(D).__currentAnisotropy)&&(e.texParameterf(z,K.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D.anisotropy,a.getMaxAnisotropy())),r.get(D).__currentAnisotropy=D.anisotropy)}}function O(z,D,ee){z.__webglInit===void 0&&(z.__webglInit=!0,D.addEventListener("dispose",y),z.__webglTexture=e.createTexture(),u.textures++),n.activeTexture(e.TEXTURE0+ee),n.bindTexture(e.TEXTURE_2D,z.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,D.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,D.unpackAlignment);var K=h(D.image,a.maxTextureSize);d(D)&&l(K)===!1&&(K=p(K));var te=l(K),$=s.convert(D.format),ue=s.convert(D.type);P(e.TEXTURE_2D,D,te);var he,oe=D.mipmaps;if(D.isDepthTexture){var ve=e.DEPTH_COMPONENT;if(D.type===Oa){if(!f)throw new Error("Float Depth Texture only supported in WebGL2.0");ve=e.DEPTH_COMPONENT32F}else f&&(ve=e.DEPTH_COMPONENT16);D.format===Ui&&ve===e.DEPTH_COMPONENT&&D.type!==Js&&D.type!==xc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),D.type=Js,ue=s.convert(D.type)),D.format===Fa&&(ve=e.DEPTH_STENCIL,D.type!==Qs&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),D.type=Qs,ue=s.convert(D.type))),n.texImage2D(e.TEXTURE_2D,0,ve,K.width,K.height,0,$,ue,null)}else if(D.isDataTexture)if(oe.length>0&&te){for(var pe=0,Ae=oe.length;pe<Ae;pe++)he=oe[pe],n.texImage2D(e.TEXTURE_2D,pe,$,he.width,he.height,0,$,ue,he.data);D.generateMipmaps=!1}else n.texImage2D(e.TEXTURE_2D,0,$,K.width,K.height,0,$,ue,K.data);else if(D.isCompressedTexture)for(var pe=0,Ae=oe.length;pe<Ae;pe++)he=oe[pe],D.format!==Gr&&D.format!==Ua?n.getCompressedTextureFormats().indexOf($)>-1?n.compressedTexImage2D(e.TEXTURE_2D,pe,$,he.width,he.height,0,he.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,pe,$,he.width,he.height,0,$,ue,he.data);else if(oe.length>0&&te){for(var pe=0,Ae=oe.length;pe<Ae;pe++)he=oe[pe],n.texImage2D(e.TEXTURE_2D,pe,$,$,ue,he);D.generateMipmaps=!1}else n.texImage2D(e.TEXTURE_2D,0,$,$,ue,K);v(D,te)&&e.generateMipmap(e.TEXTURE_2D),z.__version=D.version,D.onUpdate&&D.onUpdate(D)}function U(z,D,ee,K){var te=s.convert(D.texture.format),$=s.convert(D.texture.type);n.texImage2D(K,0,te,D.width,D.height,0,te,$,null),e.bindFramebuffer(e.FRAMEBUFFER,z),e.framebufferTexture2D(e.FRAMEBUFFER,ee,K,r.get(D.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function W(z,D){e.bindRenderbuffer(e.RENDERBUFFER,z),D.depthBuffer&&!D.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,D.width,D.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,z)):D.depthBuffer&&D.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,D.width,D.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,z)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,D.width,D.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function B(z,D){var ee=D&&D.isWebGLRenderTargetCube;if(ee)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,z),!(D.depthTexture&&D.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(D.depthTexture).__webglTexture||D.depthTexture.image.width!==D.width||D.depthTexture.image.height!==D.height)&&(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0),E(D.depthTexture,0);var K=r.get(D.depthTexture).__webglTexture;if(D.depthTexture.format===Ui)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,K,0);else if(D.depthTexture.format===Fa)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,K,0);else throw new Error("Unknown depthTexture format")}function V(z){var D=r.get(z),ee=z.isWebGLRenderTargetCube===!0;if(z.depthTexture){if(ee)throw new Error("target.depthTexture not supported in Cube render targets");B(D.__webglFramebuffer,z)}else if(ee){D.__webglDepthbuffer=[];for(var K=0;K<6;K++)e.bindFramebuffer(e.FRAMEBUFFER,D.__webglFramebuffer[K]),D.__webglDepthbuffer[K]=e.createRenderbuffer(),W(D.__webglDepthbuffer[K],z)}else e.bindFramebuffer(e.FRAMEBUFFER,D.__webglFramebuffer),D.__webglDepthbuffer=e.createRenderbuffer(),W(D.__webglDepthbuffer,z);e.bindFramebuffer(e.FRAMEBUFFER,null)}function X(z){var D=r.get(z),ee=r.get(z.texture);z.addEventListener("dispose",x),ee.__webglTexture=e.createTexture(),u.textures++;var K=z.isWebGLRenderTargetCube===!0,te=l(z);if(K){D.__webglFramebuffer=[];for(var $=0;$<6;$++)D.__webglFramebuffer[$]=e.createFramebuffer()}else D.__webglFramebuffer=e.createFramebuffer();if(K){n.bindTexture(e.TEXTURE_CUBE_MAP,ee.__webglTexture),P(e.TEXTURE_CUBE_MAP,z.texture,te);for(var $=0;$<6;$++)U(D.__webglFramebuffer[$],z,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+$);v(z.texture,te)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else n.bindTexture(e.TEXTURE_2D,ee.__webglTexture),P(e.TEXTURE_2D,z.texture,te),U(D.__webglFramebuffer,z,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),v(z.texture,te)&&e.generateMipmap(e.TEXTURE_2D),n.bindTexture(e.TEXTURE_2D,null);z.depthBuffer&&V(z)}function re(z){var D=z.texture,ee=l(z);if(v(D,ee)){var K=z.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,te=r.get(D).__webglTexture;n.bindTexture(K,te),e.generateMipmap(K),n.bindTexture(K,null)}}this.setTexture2D=E,this.setTextureCube=T,this.setTextureCubeDynamic=M,this.setupRenderTarget=X,this.updateRenderTargetMipmap=re}function jy(){var e={};function t(a){var s=a.uuid,u=e[s];return u===void 0&&(u={},e[s]=u),u}function n(a){delete e[a.uuid]}function r(){e={}}return{get:t,remove:n,clear:r}}function Zy(e,t,n){function r(){var q=!1,ge=new At,Me=null,Ne=new At(0,0,0,0);return{setMask:function(be){Me!==be&&!q&&(e.colorMask(be,be,be,be),Me=be)},setLocked:function(be){q=be},setClear:function(be,et,lt,ht,Rt){Rt===!0&&(be*=ht,et*=ht,lt*=ht),ge.set(be,et,lt,ht),Ne.equals(ge)===!1&&(e.clearColor(be,et,lt,ht),Ne.copy(ge))},reset:function(){q=!1,Me=null,Ne.set(-1,0,0,0)}}}function a(){var q=!1,ge=null,Me=null,Ne=null;return{setTest:function(be){be?Ce(e.DEPTH_TEST):J(e.DEPTH_TEST)},setMask:function(be){ge!==be&&!q&&(e.depthMask(be),ge=be)},setFunc:function(be){if(Me!==be){if(be)switch(be){case hv:e.depthFunc(e.NEVER);break;case cv:e.depthFunc(e.ALWAYS);break;case lv:e.depthFunc(e.LESS);break;case Vu:e.depthFunc(e.LEQUAL);break;case pv:e.depthFunc(e.EQUAL);break;case dv:e.depthFunc(e.GEQUAL);break;case vv:e.depthFunc(e.GREATER);break;case mv:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);Me=be}},setLocked:function(be){q=be},setClear:function(be){Ne!==be&&(e.clearDepth(be),Ne=be)},reset:function(){q=!1,ge=null,Me=null,Ne=null}}}function s(){var q=!1,ge=null,Me=null,Ne=null,be=null,et=null,lt=null,ht=null,Rt=null;return{setTest:function(mt){mt?Ce(e.STENCIL_TEST):J(e.STENCIL_TEST)},setMask:function(mt){ge!==mt&&!q&&(e.stencilMask(mt),ge=mt)},setFunc:function(mt,Jt,Qt){(Me!==mt||Ne!==Jt||be!==Qt)&&(e.stencilFunc(mt,Jt,Qt),Me=mt,Ne=Jt,be=Qt)},setOp:function(mt,Jt,Qt){(et!==mt||lt!==Jt||ht!==Qt)&&(e.stencilOp(mt,Jt,Qt),et=mt,lt=Jt,ht=Qt)},setLocked:function(mt){q=mt},setClear:function(mt){Rt!==mt&&(e.clearStencil(mt),Rt=mt)},reset:function(){q=!1,ge=null,Me=null,Ne=null,be=null,et=null,lt=null,ht=null,Rt=null}}}var u=new r,f=new a,h=new s,l=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=new Uint8Array(l),d=new Uint8Array(l),v=new Uint8Array(l),m={},y=null,x=null,b=null,w=null,E=null,T=null,M=null,P=null,O=null,U=!1,W=null,B=null,V=null,X=null,re=null,z=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),D=parseFloat(/^WebGL\ ([0-9])/.exec(e.getParameter(e.VERSION))[1]),ee=parseFloat(D)>=1,K=null,te={},$=new At,ue=new At;function he(q,ge,Me){var Ne=new Uint8Array(4),be=e.createTexture();e.bindTexture(q,be),e.texParameteri(q,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(q,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var et=0;et<Me;et++)e.texImage2D(ge+et,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,Ne);return be}var oe={};oe[e.TEXTURE_2D]=he(e.TEXTURE_2D,e.TEXTURE_2D,1),oe[e.TEXTURE_CUBE_MAP]=he(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),u.setClear(0,0,0,1),f.setClear(1),h.setClear(0),Ce(e.DEPTH_TEST),f.setFunc(Vu),ft(!1),gt(qs),Ce(e.CULL_FACE),Ce(e.BLEND),Ie(Da);function ve(){for(var q=0,ge=p.length;q<ge;q++)p[q]=0}function pe(q){if(p[q]=1,d[q]===0&&(e.enableVertexAttribArray(q),d[q]=1),v[q]!==0){var ge=t.get("ANGLE_instanced_arrays");ge.vertexAttribDivisorANGLE(q,0),v[q]=0}}function Ae(q,ge){if(p[q]=1,d[q]===0&&(e.enableVertexAttribArray(q),d[q]=1),v[q]!==ge){var Me=t.get("ANGLE_instanced_arrays");Me.vertexAttribDivisorANGLE(q,ge),v[q]=ge}}function Z(){for(var q=0,ge=d.length;q!==ge;++q)d[q]!==p[q]&&(e.disableVertexAttribArray(q),d[q]=0)}function Ce(q){m[q]!==!0&&(e.enable(q),m[q]=!0)}function J(q){m[q]!==!1&&(e.disable(q),m[q]=!1)}function Pe(){if(y===null&&(y=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var q=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),ge=0;ge<q.length;ge++)y.push(q[ge]);return y}function de(q){return x!==q?(e.useProgram(q),x=q,!0):!1}function Ie(q,ge,Me,Ne,be,et,lt,ht){if(q!==Gu?Ce(e.BLEND):J(e.BLEND),q!==hc){if(q!==b||ht!==U)switch(q){case Hu:ht?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE));break;case uc:ht?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR));break;case fc:ht?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR));break;default:ht?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA))}w=null,E=null,T=null,M=null,P=null,O=null}else be=be||ge,et=et||Me,lt=lt||Ne,(ge!==w||be!==M)&&(e.blendEquationSeparate(n.convert(ge),n.convert(be)),w=ge,M=be),(Me!==E||Ne!==T||et!==P||lt!==O)&&(e.blendFuncSeparate(n.convert(Me),n.convert(Ne),n.convert(et),n.convert(lt)),E=Me,T=Ne,P=et,O=lt);b=q,U=ht}function Ze(q){q.side===Ia?J(e.CULL_FACE):Ce(e.CULL_FACE),ft(q.side===ri),q.transparent===!0?Ie(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.premultipliedAlpha):Ie(Gu),f.setFunc(q.depthFunc),f.setTest(q.depthTest),f.setMask(q.depthWrite),u.setMask(q.colorWrite),Je(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits)}function ft(q){W!==q&&(q?e.frontFace(e.CW):e.frontFace(e.CCW),W=q)}function gt(q){q!==Jd?(Ce(e.CULL_FACE),q!==B&&(q===qs?e.cullFace(e.BACK):q===ic?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):J(e.CULL_FACE),B=q}function st(q){q!==V&&(ee&&e.lineWidth(q),V=q)}function Je(q,ge,Me){q?(Ce(e.POLYGON_OFFSET_FILL),(X!==ge||re!==Me)&&(e.polygonOffset(ge,Me),X=ge,re=Me)):J(e.POLYGON_OFFSET_FILL)}function Nt(q){q?Ce(e.SCISSOR_TEST):J(e.SCISSOR_TEST)}function Et(q){q===void 0&&(q=e.TEXTURE0+z-1),K!==q&&(e.activeTexture(q),K=q)}function Lt(q,ge){K===null&&Et();var Me=te[K];Me===void 0&&(Me={type:void 0,texture:void 0},te[K]=Me),(Me.type!==q||Me.texture!==ge)&&(e.bindTexture(q,ge||oe[q]),Me.type=q,Me.texture=ge)}function mn(){try{e.compressedTexImage2D.apply(e,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function an(){try{e.texImage2D.apply(e,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ot(q){$.equals(q)===!1&&(e.scissor(q.x,q.y,q.z,q.w),$.copy(q))}function zt(q){ue.equals(q)===!1&&(e.viewport(q.x,q.y,q.z,q.w),ue.copy(q))}function $e(){for(var q=0;q<d.length;q++)d[q]===1&&(e.disableVertexAttribArray(q),d[q]=0);m={},y=null,K=null,te={},x=null,b=null,W=null,B=null,u.reset(),f.reset(),h.reset()}return{buffers:{color:u,depth:f,stencil:h},initAttributes:ve,enableAttribute:pe,enableAttributeAndDivisor:Ae,disableUnusedAttributes:Z,enable:Ce,disable:J,getCompressedTextureFormats:Pe,useProgram:de,setBlending:Ie,setMaterial:Ze,setFlipSided:ft,setCullFace:gt,setLineWidth:st,setPolygonOffset:Je,setScissorTest:Nt,activeTexture:Et,bindTexture:Lt,compressedTexImage2D:mn,texImage2D:an,scissor:ot,viewport:zt,reset:$e}}function Jy(e,t,n){var r;function a(){if(r!==void 0)return r;var M=t.get("EXT_texture_filter_anisotropic");return M!==null?r=e.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT):r=0,r}function s(M){if(M==="highp"){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";M="mediump"}return M==="mediump"&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var u=n.precision!==void 0?n.precision:"highp",f=s(u);f!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",f,"instead."),u=f);var h=n.logarithmicDepthBuffer===!0,l=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),p=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_TEXTURE_SIZE),v=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),m=e.getParameter(e.MAX_VERTEX_ATTRIBS),y=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),x=e.getParameter(e.MAX_VARYING_VECTORS),b=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),w=p>0,E=!!t.get("OES_texture_float"),T=w&&E;return{getMaxAnisotropy:a,getMaxPrecision:s,precision:u,logarithmicDepthBuffer:h,maxTextures:l,maxVertexTextures:p,maxTextureSize:d,maxCubemapSize:v,maxAttributes:m,maxVertexUniforms:y,maxVaryings:x,maxFragmentUniforms:b,vertexTextures:w,floatFragmentTextures:E,floatVertexTextures:T}}function Zt(e,t,n,r){wr.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=r!==void 0?r:2e3,this.focus=10,this.aspect=t!==void 0?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Zt.prototype=Object.assign(Object.create(wr.prototype),{constructor:Zt,isPerspectiveCamera:!0,copy:function(e,t){return wr.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=Ke.RAD2DEG*2*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(Ke.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return Ke.RAD2DEG*2*Math.atan(Math.tan(Ke.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,a,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(Ke.DEG2RAD*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,a=-.5*r,s=this.view;if(this.view!==null&&this.view.enabled){var u=s.fullWidth,f=s.fullHeight;a+=s.offsetX*r/u,t-=s.offsetY*n/f,r*=s.width/u,n*=s.height/f}var h=this.filmOffset;h!==0&&(a+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,t,t-n,e,this.far)},toJSON:function(e){var t=we.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});function df(e){Zt.call(this),this.cameras=e||[]}df.prototype=Object.assign(Object.create(Zt.prototype),{constructor:df,isArrayCamera:!0});function Qy(e){var t=this,n=null,r=null;typeof window<"u"&&"VRFrameData"in window&&(r=new window.VRFrameData);var a=new Ve,s=new Ve,u=new Ve,f=new Zt;f.bounds=new At(0,0,.5,1),f.layers.enable(1);var h=new Zt;h.bounds=new At(.5,0,.5,1),h.layers.enable(2);var l=new df([f,h]);l.layers.enable(1),l.layers.enable(2);var p,d;function v(){if(n!==null&&n.isPresenting){var m=n.getEyeParameters("left"),y=m.renderWidth,x=m.renderHeight;d=e.getPixelRatio(),p=e.getSize(),e.setDrawingBufferSize(y*2,x,1)}else t.enabled&&e.setDrawingBufferSize(p.width,p.height,d)}typeof window<"u"&&window.addEventListener("vrdisplaypresentchange",v,!1),this.enabled=!1,this.standing=!1,this.getDevice=function(){return n},this.setDevice=function(m){m!==void 0&&(n=m)},this.getCamera=function(m){if(n===null)return m;n.depthNear=m.near,n.depthFar=m.far,n.getFrameData(r);var y=r.pose;y.position!==null?m.position.fromArray(y.position):m.position.set(0,0,0),y.orientation!==null&&m.quaternion.fromArray(y.orientation),m.updateMatrixWorld();var x=n.stageParameters;if(this.standing&&x&&(s.fromArray(x.sittingToStandingTransform),u.getInverse(s),m.matrixWorld.multiply(s),m.matrixWorldInverse.multiply(u)),n.isPresenting===!1)return m;f.near=m.near,h.near=m.near,f.far=m.far,h.far=m.far,l.matrixWorld.copy(m.matrixWorld),l.matrixWorldInverse.copy(m.matrixWorldInverse),f.matrixWorldInverse.fromArray(r.leftViewMatrix),h.matrixWorldInverse.fromArray(r.rightViewMatrix),this.standing&&x&&(f.matrixWorldInverse.multiply(u),h.matrixWorldInverse.multiply(u));var b=m.parent;b!==null&&(a.getInverse(b.matrixWorld),f.matrixWorldInverse.multiply(a),h.matrixWorldInverse.multiply(a)),f.matrixWorld.getInverse(f.matrixWorldInverse),h.matrixWorld.getInverse(h.matrixWorldInverse),f.projectionMatrix.fromArray(r.leftProjectionMatrix),h.projectionMatrix.fromArray(r.rightProjectionMatrix),l.projectionMatrix.copy(f.projectionMatrix);var w=n.getLayers();if(w.length){var E=w[0];E.leftBounds!==null&&E.leftBounds.length===4&&f.bounds.fromArray(E.leftBounds),E.rightBounds!==null&&E.rightBounds.length===4&&h.bounds.fromArray(E.rightBounds)}return l},this.getStandingMatrix=function(){return s},this.submitFrame=function(){n&&n.isPresenting&&n.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",v)}}function Ky(e){var t={};return{get:function(n){if(t[n]!==void 0)return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=e.getExtension("WEBGL_compressed_texture_etc1");break;default:r=e.getExtension(n)}return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}function $y(){var e=this,t=null,n=0,r=!1,a=!1,s=new Kn,u=new Mn,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(p,d,v){var m=p.length!==0||d||n!==0||r;return r=d,t=l(p,v,0),n=p.length,m},this.beginShadows=function(){a=!0,l(null)},this.endShadows=function(){a=!1,h()},this.setState=function(p,d,v,m,y,x){if(!r||p===null||p.length===0||a&&!v)a?l(null):h();else{var b=a?0:n,w=b*4,E=y.clippingState||null;f.value=E,E=l(p,m,w,x);for(var T=0;T!==w;++T)E[T]=t[T];y.clippingState=E,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=b}};function h(){f.value!==t&&(f.value=t,f.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function l(p,d,v,m){var y=p!==null?p.length:0,x=null;if(y!==0){if(x=f.value,m!==!0||x===null){var b=v+y*4,w=d.matrixWorldInverse;u.getNormalMatrix(w),(x===null||x.length<b)&&(x=new Float32Array(b));for(var E=0,T=v;E!==y;++E,T+=4)s.copy(p[E]).applyMatrix4(w,u),s.normal.toArray(x,T),x[T+3]=s.constant}f.value=x,f.needsUpdate=!0}return e.numPlanes=y,x}}function e0(e,t){function n(r){var a;if(r===zr)return e.REPEAT;if(r===Un)return e.CLAMP_TO_EDGE;if(r===Oi)return e.MIRRORED_REPEAT;if(r===Fn)return e.NEAREST;if(r===Ju)return e.NEAREST_MIPMAP_NEAREST;if(r===Qu)return e.NEAREST_MIPMAP_LINEAR;if(r===En)return e.LINEAR;if(r===_c)return e.LINEAR_MIPMAP_NEAREST;if(r===Zs)return e.LINEAR_MIPMAP_LINEAR;if(r===Ku)return e.UNSIGNED_BYTE;if(r===Tv)return e.UNSIGNED_SHORT_4_4_4_4;if(r===Sv)return e.UNSIGNED_SHORT_5_5_5_1;if(r===Av)return e.UNSIGNED_SHORT_5_6_5;if(r===bv)return e.BYTE;if(r===Ev)return e.SHORT;if(r===Js)return e.UNSIGNED_SHORT;if(r===Mv)return e.INT;if(r===xc)return e.UNSIGNED_INT;if(r===Oa)return e.FLOAT;if(r===$u&&(a=t.get("OES_texture_half_float"),a!==null))return a.HALF_FLOAT_OES;if(r===Lv)return e.ALPHA;if(r===Ua)return e.RGB;if(r===Gr)return e.RGBA;if(r===Rv)return e.LUMINANCE;if(r===Cv)return e.LUMINANCE_ALPHA;if(r===Ui)return e.DEPTH_COMPONENT;if(r===Fa)return e.DEPTH_STENCIL;if(r===cc)return e.FUNC_ADD;if(r===$d)return e.FUNC_SUBTRACT;if(r===ev)return e.FUNC_REVERSE_SUBTRACT;if(r===tv)return e.ZERO;if(r===nv)return e.ONE;if(r===rv)return e.SRC_COLOR;if(r===iv)return e.ONE_MINUS_SRC_COLOR;if(r===dc)return e.SRC_ALPHA;if(r===vc)return e.ONE_MINUS_SRC_ALPHA;if(r===av)return e.DST_ALPHA;if(r===sv)return e.ONE_MINUS_DST_ALPHA;if(r===ov)return e.DST_COLOR;if(r===uv)return e.ONE_MINUS_DST_COLOR;if(r===fv)return e.SRC_ALPHA_SATURATE;if((r===wc||r===bc||r===Ec||r===Mc)&&(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null)){if(r===wc)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===bc)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===Ec)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Mc)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((r===Tc||r===Sc||r===Ac||r===Lc)&&(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null)){if(r===Tc)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Sc)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Ac)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Lc)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===Pv&&(a=t.get("WEBGL_compressed_texture_etc1"),a!==null))return a.COMPRESSED_RGB_ETC1_WEBGL;if((r===lc||r===pc)&&(a=t.get("EXT_blend_minmax"),a!==null)){if(r===lc)return a.MIN_EXT;if(r===pc)return a.MAX_EXT}return r===Qs&&(a=t.get("WEBGL_depth_texture"),a!==null)?a.UNSIGNED_INT_24_8_WEBGL:0}return{convert:n}}function vf(e){console.log("THREE.WebGLRenderer",Zd),e=e||{};var t=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=e.context!==void 0?e.context:null,r=e.alpha!==void 0?e.alpha:!1,a=e.depth!==void 0?e.depth:!0,s=e.stencil!==void 0?e.stencil:!0,u=e.antialias!==void 0?e.antialias:!1,f=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,h=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=[],p=[],d=null,v=[],m=[];this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=mc,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var y=this,x=!1,b=null,w=null,E=-1,T="",M=null,P=null,O=new At,U=new At,W=null,B=0,V=t.width,X=t.height,re=1,z=new At(0,0,V,X),D=new At(0,0,V,X),ee=!1,K=new rf,te=new $y,$=!1,ue=!1,he=new Ve,oe=new I,ve={geometries:0,textures:0},pe={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:pe,memory:ve,programs:null};function Ae(){return b===null?re:1}var Z;try{var Ce={alpha:r,depth:a,stencil:s,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:h};if(Z=n||t.getContext("webgl",Ce)||t.getContext("experimental-webgl",Ce),Z===null)throw t.getContext("webgl")!==null?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";Z.getShaderPrecisionFormat===void 0&&(Z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),t.addEventListener("webglcontextlost",be,!1),t.addEventListener("webglcontextrestored",et,!1)}catch(R){console.error("THREE.WebGLRenderer: "+R)}var J,Pe,de,Ie,Ze,ft,gt,st,Je,Nt,Et,Lt,mn,an,ot,zt,$e,q;function ge(){J=new Ky(Z),J.get("WEBGL_depth_texture"),J.get("OES_texture_float"),J.get("OES_texture_float_linear"),J.get("OES_texture_half_float"),J.get("OES_texture_half_float_linear"),J.get("OES_standard_derivatives"),J.get("OES_element_index_uint"),J.get("ANGLE_instanced_arrays"),q=new e0(Z,J),Pe=new Jy(Z,J,e),de=new Zy(Z,J,q),de.scissor(U.copy(D).multiplyScalar(re)),de.viewport(O.copy(z).multiplyScalar(re)),Ie=new jy,Ze=new qy(Z,J,de,Ie,Pe,q,ve),ft=new wy(Z),gt=new Oy(Z,ft,ve),st=new Ny(gt,pe),mn=new Py(Z),Nt=new Yy(y,J,Pe),Je=new Fy,Et=new Ry,Lt=new Ty(y,de,gt,f),an=new Dy(Z,J,pe),ot=new Iy(Z,J,pe),zt=new yy(y,Z,de,Ze,Pe),$e=new _y(y,Z,de,Ze,Pe),y.info.programs=Nt.programs,y.context=Z,y.capabilities=Pe,y.extensions=J,y.properties=Ie,y.renderLists=Et,y.state=de}ge();var Me=new Qy(y);this.vr=Me;var Ne=new kc(y,st,Pe.maxTextureSize);this.shadowMap=Ne,this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){var R=J.get("WEBGL_lose_context");R&&R.loseContext()},this.forceContextRestore=function(){var R=J.get("WEBGL_lose_context");R&&R.restoreContext()},this.getPixelRatio=function(){return re},this.setPixelRatio=function(R){R!==void 0&&(re=R,this.setSize(V,X,!1))},this.getSize=function(){return{width:V,height:X}},this.setSize=function(R,F,k){var fe=Me.getDevice();if(fe&&fe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}V=R,X=F,t.width=R*re,t.height=F*re,k!==!1&&(t.style.width=R+"px",t.style.height=F+"px"),this.setViewport(0,0,R,F)},this.getDrawingBufferSize=function(){return{width:V*re,height:X*re}},this.setDrawingBufferSize=function(R,F,k){V=R,X=F,re=k,t.width=R*k,t.height=F*k,this.setViewport(0,0,R,F)},this.setViewport=function(R,F,k,fe){z.set(R,X-F-fe,k,fe),de.viewport(O.copy(z).multiplyScalar(re))},this.setScissor=function(R,F,k,fe){D.set(R,X-F-fe,k,fe),de.scissor(U.copy(D).multiplyScalar(re))},this.setScissorTest=function(R){de.setScissorTest(ee=R)},this.getClearColor=function(){return Lt.getClearColor()},this.setClearColor=function(){Lt.setClearColor.apply(Lt,arguments)},this.getClearAlpha=function(){return Lt.getClearAlpha()},this.setClearAlpha=function(){Lt.setClearAlpha.apply(Lt,arguments)},this.clear=function(R,F,k){var fe=0;(R===void 0||R)&&(fe|=Z.COLOR_BUFFER_BIT),(F===void 0||F)&&(fe|=Z.DEPTH_BUFFER_BIT),(k===void 0||k)&&(fe|=Z.STENCIL_BUFFER_BIT),Z.clear(fe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(R,F,k,fe){this.setRenderTarget(R),this.clear(F,k,fe)},this.dispose=function(){t.removeEventListener("webglcontextlost",be,!1),t.removeEventListener("webglcontextrestored",et,!1),Et.dispose(),Me.dispose()};function be(R){R.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function et(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1,ge()}function lt(R){var F=R.target;F.removeEventListener("dispose",lt),ht(F)}function ht(R){Rt(R),Ie.remove(R)}function Rt(R){var F=Ie.get(R).program;R.program=void 0,F!==void 0&&Nt.releaseProgram(F)}function mt(R,F,k){R.render(function(fe){y.renderBufferImmediate(fe,F,k)})}this.renderBufferImmediate=function(R,F,k){de.initAttributes();var fe=Ie.get(R);R.hasPositions&&!fe.position&&(fe.position=Z.createBuffer()),R.hasNormals&&!fe.normal&&(fe.normal=Z.createBuffer()),R.hasUvs&&!fe.uv&&(fe.uv=Z.createBuffer()),R.hasColors&&!fe.color&&(fe.color=Z.createBuffer());var xe=F.getAttributes();if(R.hasPositions&&(Z.bindBuffer(Z.ARRAY_BUFFER,fe.position),Z.bufferData(Z.ARRAY_BUFFER,R.positionArray,Z.DYNAMIC_DRAW),de.enableAttribute(xe.position),Z.vertexAttribPointer(xe.position,3,Z.FLOAT,!1,0,0)),R.hasNormals){if(Z.bindBuffer(Z.ARRAY_BUFFER,fe.normal),!k.isMeshPhongMaterial&&!k.isMeshStandardMaterial&&!k.isMeshNormalMaterial&&k.flatShading===!0)for(var Se=0,ke=R.count*3;Se<ke;Se+=9){var Oe=R.normalArray,qe=(Oe[Se+0]+Oe[Se+3]+Oe[Se+6])/3,Xe=(Oe[Se+1]+Oe[Se+4]+Oe[Se+7])/3,Be=(Oe[Se+2]+Oe[Se+5]+Oe[Se+8])/3;Oe[Se+0]=qe,Oe[Se+1]=Xe,Oe[Se+2]=Be,Oe[Se+3]=qe,Oe[Se+4]=Xe,Oe[Se+5]=Be,Oe[Se+6]=qe,Oe[Se+7]=Xe,Oe[Se+8]=Be}Z.bufferData(Z.ARRAY_BUFFER,R.normalArray,Z.DYNAMIC_DRAW),de.enableAttribute(xe.normal),Z.vertexAttribPointer(xe.normal,3,Z.FLOAT,!1,0,0)}R.hasUvs&&k.map&&(Z.bindBuffer(Z.ARRAY_BUFFER,fe.uv),Z.bufferData(Z.ARRAY_BUFFER,R.uvArray,Z.DYNAMIC_DRAW),de.enableAttribute(xe.uv),Z.vertexAttribPointer(xe.uv,2,Z.FLOAT,!1,0,0)),R.hasColors&&k.vertexColors!==zu&&(Z.bindBuffer(Z.ARRAY_BUFFER,fe.color),Z.bufferData(Z.ARRAY_BUFFER,R.colorArray,Z.DYNAMIC_DRAW),de.enableAttribute(xe.color),Z.vertexAttribPointer(xe.color,3,Z.FLOAT,!1,0,0)),de.disableUnusedAttributes(),Z.drawArrays(Z.TRIANGLES,0,R.count),R.count=0},this.renderBufferDirect=function(R,F,k,fe,xe,Se){de.setMaterial(fe);var ke=Ln(R,F,fe,xe),Oe=k.id+"_"+ke.id+"_"+(fe.wireframe===!0),qe=!1;Oe!==T&&(T=Oe,qe=!0),xe.morphTargetInfluences&&(mn.update(xe,k,fe,ke),qe=!0);var Xe=k.index,Be=k.attributes.position,Le=1;fe.wireframe===!0&&(Xe=gt.getWireframeAttribute(k),Le=2);var Mt,Ye=an;Xe!==null&&(Mt=ft.get(Xe),Ye=ot,Ye.setIndex(Mt)),qe&&(Jt(fe,ke,k),Xe!==null&&Z.bindBuffer(Z.ELEMENT_ARRAY_BUFFER,Mt.buffer));var Vt=0;Xe!==null?Vt=Xe.count:Be!==void 0&&(Vt=Be.count);var yt=k.drawRange.start*Le,Tt=k.drawRange.count*Le,tn=Se!==null?Se.start*Le:0,Kt=Se!==null?Se.count*Le:1/0,Dt=Math.max(yt,tn),pa=Math.min(Vt,yt+Tt,tn+Kt)-1,qr=Math.max(0,pa-Dt+1);if(qr!==0){if(xe.isMesh)if(fe.wireframe===!0)de.setLineWidth(fe.wireframeLinewidth*Ae()),Ye.setMode(Z.LINES);else switch(xe.drawMode){case Rc:Ye.setMode(Z.TRIANGLES);break;case Uv:Ye.setMode(Z.TRIANGLE_STRIP);break;case Fv:Ye.setMode(Z.TRIANGLE_FAN);break}else if(xe.isLine){var gr=fe.linewidth;gr===void 0&&(gr=1),de.setLineWidth(gr*Ae()),xe.isLineSegments?Ye.setMode(Z.LINES):xe.isLineLoop?Ye.setMode(Z.LINE_LOOP):Ye.setMode(Z.LINE_STRIP)}else xe.isPoints&&Ye.setMode(Z.POINTS);k&&k.isInstancedBufferGeometry?k.maxInstancedCount>0&&Ye.renderInstances(k,Dt,qr):Ye.render(Dt,qr)}};function Jt(R,F,k,fe){if(k&&k.isInstancedBufferGeometry&&J.get("ANGLE_instanced_arrays")===null){console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}fe===void 0&&(fe=0),de.initAttributes();var xe=k.attributes,Se=F.getAttributes(),ke=R.defaultAttributeValues;for(var Oe in Se){var qe=Se[Oe];if(qe>=0){var Xe=xe[Oe];if(Xe!==void 0){var Be=Xe.normalized,Le=Xe.itemSize,Mt=ft.get(Xe);if(Mt===void 0)continue;var Ye=Mt.buffer,Vt=Mt.type,yt=Mt.bytesPerElement;if(Xe.isInterleavedBufferAttribute){var Tt=Xe.data,tn=Tt.stride,Kt=Xe.offset;Tt&&Tt.isInstancedInterleavedBuffer?(de.enableAttributeAndDivisor(qe,Tt.meshPerAttribute),k.maxInstancedCount===void 0&&(k.maxInstancedCount=Tt.meshPerAttribute*Tt.count)):de.enableAttribute(qe),Z.bindBuffer(Z.ARRAY_BUFFER,Ye),Z.vertexAttribPointer(qe,Le,Vt,Be,tn*yt,(fe*tn+Kt)*yt)}else Xe.isInstancedBufferAttribute?(de.enableAttributeAndDivisor(qe,Xe.meshPerAttribute),k.maxInstancedCount===void 0&&(k.maxInstancedCount=Xe.meshPerAttribute*Xe.count)):de.enableAttribute(qe),Z.bindBuffer(Z.ARRAY_BUFFER,Ye),Z.vertexAttribPointer(qe,Le,Vt,Be,0,fe*Le*yt)}else if(ke!==void 0){var Dt=ke[Oe];if(Dt!==void 0)switch(Dt.length){case 2:Z.vertexAttrib2fv(qe,Dt);break;case 3:Z.vertexAttrib3fv(qe,Dt);break;case 4:Z.vertexAttrib4fv(qe,Dt);break;default:Z.vertexAttrib1fv(qe,Dt)}}}}de.disableUnusedAttributes()}this.compile=function(R,F){l.length=0,p.length=0,R.traverse(function(k){k.isLight&&(l.push(k),k.castShadow&&p.push(k))}),Je.setup(l,p,F),R.traverse(function(k){if(k.material)if(Array.isArray(k.material))for(var fe=0;fe<k.material.length;fe++)Hn(k.material[fe],R.fog,k);else Hn(k.material,R.fog,k)})};var Qt=!1,Gn=null;function dr(){if(!Qt){var R=Me.getDevice();R&&R.isPresenting?R.requestAnimationFrame(gn):window.requestAnimationFrame(gn),Qt=!0}}function gn(R){Gn!==null&&Gn(R);var F=Me.getDevice();F&&F.isPresenting?F.requestAnimationFrame(gn):window.requestAnimationFrame(gn)}this.animate=function(R){Gn=R,dr()},this.render=function(R,F,k,fe){if(!(F&&F.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!x){T="",E=-1,M=null,R.autoUpdate===!0&&R.updateMatrixWorld(),F.parent===null&&F.updateMatrixWorld(),Me.enabled&&(F=Me.getCamera(F)),he.multiplyMatrices(F.projectionMatrix,F.matrixWorldInverse),K.setFromMatrix(he),l.length=0,p.length=0,v.length=0,m.length=0,ue=this.localClippingEnabled,$=te.init(this.clippingPlanes,ue,F),d=Et.get(R,F),d.init(),Yr(R,F,y.sortObjects),y.sortObjects===!0&&d.sort(),$&&te.beginShadows(),Ne.render(p,R,F),Je.setup(l,p,F),$&&te.endShadows(),pe.frame++,pe.calls=0,pe.vertices=0,pe.faces=0,pe.points=0,k===void 0&&(k=null),this.setRenderTarget(k),Lt.render(d,R,F,fe);var xe=d.opaque,Se=d.transparent;if(R.overrideMaterial){var ke=R.overrideMaterial;xe.length&&vr(xe,R,F,ke),Se.length&&vr(Se,R,F,ke)}else xe.length&&vr(xe,R,F),Se.length&&vr(Se,R,F);$e.render(v,R,F),zt.render(m,R,F,O),k&&Ze.updateRenderTargetMipmap(k),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1),Me.enabled&&Me.submitFrame()}};function Yr(R,F,k){if(R.visible!==!1){var fe=R.layers.test(F.layers);if(fe){if(R.isLight)l.push(R),R.castShadow&&p.push(R);else if(R.isSprite)(!R.frustumCulled||K.intersectsSprite(R))&&v.push(R);else if(R.isLensFlare)m.push(R);else if(R.isImmediateRenderObject)k&&oe.setFromMatrixPosition(R.matrixWorld).applyMatrix4(he),d.push(R,null,R.material,oe.z,null);else if((R.isMesh||R.isLine||R.isPoints)&&(R.isSkinnedMesh&&R.skeleton.update(),!R.frustumCulled||K.intersectsObject(R))){k&&oe.setFromMatrixPosition(R.matrixWorld).applyMatrix4(he);var xe=st.update(R),Se=R.material;if(Array.isArray(Se))for(var ke=xe.groups,Oe=0,qe=ke.length;Oe<qe;Oe++){var Xe=ke[Oe],Be=Se[Xe.materialIndex];Be&&Be.visible&&d.push(R,xe,Be,oe.z,Xe)}else Se.visible&&d.push(R,xe,Se,oe.z,null)}}for(var Le=R.children,Oe=0,qe=Le.length;Oe<qe;Oe++)Yr(Le[Oe],F,k)}}function vr(R,F,k,fe){for(var xe=0,Se=R.length;xe<Se;xe++){var ke=R[xe],Oe=ke.object,qe=ke.geometry,Xe=fe===void 0?ke.material:fe,Be=ke.group;if(k.isArrayCamera){P=k;for(var Le=k.cameras,Mt=0,Ye=Le.length;Mt<Ye;Mt++){var Vt=Le[Mt];if(Oe.layers.test(Vt.layers)){var yt=Vt.bounds,Tt=yt.x*V,tn=yt.y*X,Kt=yt.z*V,Dt=yt.w*X;de.viewport(O.set(Tt,tn,Kt,Dt).multiplyScalar(re)),rr(Oe,F,Vt,qe,Xe,Be)}}}else P=null,rr(Oe,F,k,qe,Xe,Be)}}function rr(R,F,k,fe,xe,Se){if(R.onBeforeRender(y,F,k,fe,xe,Se),R.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,R.matrixWorld),R.normalMatrix.getNormalMatrix(R.modelViewMatrix),R.isImmediateRenderObject){de.setMaterial(xe);var ke=Ln(k,F.fog,xe,R);T="",mt(R,ke,xe)}else y.renderBufferDirect(k,F.fog,fe,xe,R,Se);R.onAfterRender(y,F,k,fe,xe,Se)}function Hn(R,F,k){var fe=Ie.get(R),xe=Nt.getParameters(R,Je.state,p,F,te.numPlanes,te.numIntersection,k),Se=Nt.getProgramCode(R,xe),ke=fe.program,Oe=!0;if(ke===void 0)R.addEventListener("dispose",lt);else if(ke.code!==Se)Rt(R);else{if(xe.shaderID!==void 0)return;Oe=!1}if(Oe){if(xe.shaderID){var qe=Gi[xe.shaderID];fe.shader={name:R.type,uniforms:Tn.clone(qe.uniforms),vertexShader:qe.vertexShader,fragmentShader:qe.fragmentShader}}else fe.shader={name:R.type,uniforms:R.uniforms,vertexShader:R.vertexShader,fragmentShader:R.fragmentShader};R.onBeforeCompile(fe.shader),ke=Nt.acquireProgram(R,fe.shader,xe,Se),fe.program=ke,R.program=ke}var Xe=ke.getAttributes();if(R.morphTargets){R.numSupportedMorphTargets=0;for(var Be=0;Be<y.maxMorphTargets;Be++)Xe["morphTarget"+Be]>=0&&R.numSupportedMorphTargets++}if(R.morphNormals){R.numSupportedMorphNormals=0;for(var Be=0;Be<y.maxMorphNormals;Be++)Xe["morphNormal"+Be]>=0&&R.numSupportedMorphNormals++}var Le=fe.shader.uniforms;(!R.isShaderMaterial&&!R.isRawShaderMaterial||R.clipping===!0)&&(fe.numClippingPlanes=te.numPlanes,fe.numIntersection=te.numIntersection,Le.clippingPlanes=te.uniform),fe.fog=F,fe.lightsHash=Je.state.hash,R.lights&&(Le.ambientLightColor.value=Je.state.ambient,Le.directionalLights.value=Je.state.directional,Le.spotLights.value=Je.state.spot,Le.rectAreaLights.value=Je.state.rectArea,Le.pointLights.value=Je.state.point,Le.hemisphereLights.value=Je.state.hemi,Le.directionalShadowMap.value=Je.state.directionalShadowMap,Le.directionalShadowMatrix.value=Je.state.directionalShadowMatrix,Le.spotShadowMap.value=Je.state.spotShadowMap,Le.spotShadowMatrix.value=Je.state.spotShadowMatrix,Le.pointShadowMap.value=Je.state.pointShadowMap,Le.pointShadowMatrix.value=Je.state.pointShadowMatrix);var Mt=fe.program.getUniforms(),Ye=ai.seqWithValue(Mt.seq,Le);fe.uniformsList=Ye}function Ln(R,F,k,fe){B=0;var xe=Ie.get(k);if($&&(ue||R!==M)){var Se=R===M&&k.id===E;te.setState(k.clippingPlanes,k.clipIntersection,k.clipShadows,R,xe,Se)}k.needsUpdate===!1&&(xe.program===void 0||k.fog&&xe.fog!==F||k.lights&&xe.lightsHash!==Je.state.hash||xe.numClippingPlanes!==void 0&&(xe.numClippingPlanes!==te.numPlanes||xe.numIntersection!==te.numIntersection))&&(k.needsUpdate=!0),k.needsUpdate&&(Hn(k,F,fe),k.needsUpdate=!1);var ke=!1,Oe=!1,qe=!1,Xe=xe.program,Be=Xe.getUniforms(),Le=xe.shader.uniforms;if(de.useProgram(Xe.program)&&(ke=!0,Oe=!0,qe=!0),k.id!==E&&(E=k.id,Oe=!0),ke||R!==M){if(Be.setValue(Z,"projectionMatrix",R.projectionMatrix),Pe.logarithmicDepthBuffer&&Be.setValue(Z,"logDepthBufFC",2/(Math.log(R.far+1)/Math.LN2)),M!==(P||R)&&(M=P||R,Oe=!0,qe=!0),k.isShaderMaterial||k.isMeshPhongMaterial||k.isMeshStandardMaterial||k.envMap){var Mt=Be.map.cameraPosition;Mt!==void 0&&Mt.setValue(Z,oe.setFromMatrixPosition(R.matrixWorld))}(k.isMeshPhongMaterial||k.isMeshLambertMaterial||k.isMeshBasicMaterial||k.isMeshStandardMaterial||k.isShaderMaterial||k.skinning)&&Be.setValue(Z,"viewMatrix",R.matrixWorldInverse)}if(k.skinning){Be.setOptional(Z,fe,"bindMatrix"),Be.setOptional(Z,fe,"bindMatrixInverse");var Ye=fe.skeleton;if(Ye){var Vt=Ye.bones;if(Pe.floatVertexTextures){if(Ye.boneTexture===void 0){var yt=Math.sqrt(Vt.length*4);yt=Ke.ceilPowerOfTwo(yt),yt=Math.max(yt,4);var Tt=new Float32Array(yt*yt*4);Tt.set(Ye.boneMatrices);var tn=new Bi(Tt,yt,yt,Gr,Oa);Ye.boneMatrices=Tt,Ye.boneTexture=tn,Ye.boneTextureSize=yt}Be.setValue(Z,"boneTexture",Ye.boneTexture),Be.setValue(Z,"boneTextureSize",Ye.boneTextureSize)}else Be.setOptional(Z,Ye,"boneMatrices")}}return Oe&&(Be.setValue(Z,"toneMappingExposure",y.toneMappingExposure),Be.setValue(Z,"toneMappingWhitePoint",y.toneMappingWhitePoint),k.lights&&la(Le,qe),F&&k.fog&&Ss(Le,F),k.isMeshBasicMaterial?ir(Le,k):k.isMeshLambertMaterial?(ir(Le,k),As(Le,k)):k.isMeshPhongMaterial?(ir(Le,k),k.isMeshToonMaterial?mr(Le,k):fa(Le,k)):k.isMeshStandardMaterial?(ir(Le,k),k.isMeshPhysicalMaterial?xi(Le,k):ha(Le,k)):k.isMeshDepthMaterial?(ir(Le,k),ca(Le,k)):k.isMeshDistanceMaterial?(ir(Le,k),wi(Le,k)):k.isMeshNormalMaterial?(ir(Le,k),Ls(Le,k)):k.isLineBasicMaterial?(Ms(Le,k),k.isLineDashedMaterial&&Ts(Le,k)):k.isPointsMaterial?_i(Le,k):k.isShadowMaterial&&(Le.color.value=k.color,Le.opacity.value=k.opacity),Le.ltcMat!==void 0&&(Le.ltcMat.value=Fe.LTC_MAT_TEXTURE),Le.ltcMag!==void 0&&(Le.ltcMag.value=Fe.LTC_MAG_TEXTURE),ai.upload(Z,xe.uniformsList,Le,y)),Be.setValue(Z,"modelViewMatrix",fe.modelViewMatrix),Be.setValue(Z,"normalMatrix",fe.normalMatrix),Be.setValue(Z,"modelMatrix",fe.matrixWorld),Xe}function ir(R,F){R.opacity.value=F.opacity,F.color&&(R.diffuse.value=F.color),F.emissive&&R.emissive.value.copy(F.emissive).multiplyScalar(F.emissiveIntensity),F.map&&(R.map.value=F.map),F.alphaMap&&(R.alphaMap.value=F.alphaMap),F.specularMap&&(R.specularMap.value=F.specularMap),F.envMap&&(R.envMap.value=F.envMap,R.flipEnvMap.value=F.envMap&&F.envMap.isCubeTexture?-1:1,R.reflectivity.value=F.reflectivity,R.refractionRatio.value=F.refractionRatio),F.lightMap&&(R.lightMap.value=F.lightMap,R.lightMapIntensity.value=F.lightMapIntensity),F.aoMap&&(R.aoMap.value=F.aoMap,R.aoMapIntensity.value=F.aoMapIntensity);var k;if(F.map?k=F.map:F.specularMap?k=F.specularMap:F.displacementMap?k=F.displacementMap:F.normalMap?k=F.normalMap:F.bumpMap?k=F.bumpMap:F.roughnessMap?k=F.roughnessMap:F.metalnessMap?k=F.metalnessMap:F.alphaMap?k=F.alphaMap:F.emissiveMap&&(k=F.emissiveMap),k!==void 0){if(k.isWebGLRenderTarget&&(k=k.texture),k.matrixAutoUpdate===!0){var fe=k.offset,xe=k.repeat,Se=k.rotation,ke=k.center;k.matrix.setUvTransform(fe.x,fe.y,xe.x,xe.y,Se,ke.x,ke.y)}R.uvTransform.value.copy(k.matrix)}}function Ms(R,F){R.diffuse.value=F.color,R.opacity.value=F.opacity}function Ts(R,F){R.dashSize.value=F.dashSize,R.totalSize.value=F.dashSize+F.gapSize,R.scale.value=F.scale}function _i(R,F){if(R.diffuse.value=F.color,R.opacity.value=F.opacity,R.size.value=F.size*re,R.scale.value=X*.5,R.map.value=F.map,F.map!==null){if(F.map.matrixAutoUpdate===!0){var k=F.map.offset,fe=F.map.repeat,xe=F.map.rotation,Se=F.map.center;F.map.matrix.setUvTransform(k.x,k.y,fe.x,fe.y,xe,Se.x,Se.y)}R.uvTransform.value.copy(F.map.matrix)}}function Ss(R,F){R.fogColor.value=F.color,F.isFog?(R.fogNear.value=F.near,R.fogFar.value=F.far):F.isFogExp2&&(R.fogDensity.value=F.density)}function As(R,F){F.emissiveMap&&(R.emissiveMap.value=F.emissiveMap)}function fa(R,F){R.specular.value=F.specular,R.shininess.value=Math.max(F.shininess,1e-4),F.emissiveMap&&(R.emissiveMap.value=F.emissiveMap),F.bumpMap&&(R.bumpMap.value=F.bumpMap,R.bumpScale.value=F.bumpScale),F.normalMap&&(R.normalMap.value=F.normalMap,R.normalScale.value.copy(F.normalScale)),F.displacementMap&&(R.displacementMap.value=F.displacementMap,R.displacementScale.value=F.displacementScale,R.displacementBias.value=F.displacementBias)}function mr(R,F){fa(R,F),F.gradientMap&&(R.gradientMap.value=F.gradientMap)}function ha(R,F){R.roughness.value=F.roughness,R.metalness.value=F.metalness,F.roughnessMap&&(R.roughnessMap.value=F.roughnessMap),F.metalnessMap&&(R.metalnessMap.value=F.metalnessMap),F.emissiveMap&&(R.emissiveMap.value=F.emissiveMap),F.bumpMap&&(R.bumpMap.value=F.bumpMap,R.bumpScale.value=F.bumpScale),F.normalMap&&(R.normalMap.value=F.normalMap,R.normalScale.value.copy(F.normalScale)),F.displacementMap&&(R.displacementMap.value=F.displacementMap,R.displacementScale.value=F.displacementScale,R.displacementBias.value=F.displacementBias),F.envMap&&(R.envMapIntensity.value=F.envMapIntensity)}function xi(R,F){R.clearCoat.value=F.clearCoat,R.clearCoatRoughness.value=F.clearCoatRoughness,ha(R,F)}function ca(R,F){F.displacementMap&&(R.displacementMap.value=F.displacementMap,R.displacementScale.value=F.displacementScale,R.displacementBias.value=F.displacementBias)}function wi(R,F){F.displacementMap&&(R.displacementMap.value=F.displacementMap,R.displacementScale.value=F.displacementScale,R.displacementBias.value=F.displacementBias),R.referencePosition.value.copy(F.referencePosition),R.nearDistance.value=F.nearDistance,R.farDistance.value=F.farDistance}function Ls(R,F){F.bumpMap&&(R.bumpMap.value=F.bumpMap,R.bumpScale.value=F.bumpScale),F.normalMap&&(R.normalMap.value=F.normalMap,R.normalScale.value.copy(F.normalScale)),F.displacementMap&&(R.displacementMap.value=F.displacementMap,R.displacementScale.value=F.displacementScale,R.displacementBias.value=F.displacementBias)}function la(R,F){R.ambientLightColor.needsUpdate=F,R.directionalLights.needsUpdate=F,R.pointLights.needsUpdate=F,R.spotLights.needsUpdate=F,R.rectAreaLights.needsUpdate=F,R.hemisphereLights.needsUpdate=F}this.setFaceCulling=function(R,F){de.setCullFace(R),de.setFlipSided(F===Qd)};function Rs(){var R=B;return R>=Pe.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+R+" texture units while this GPU supports only "+Pe.maxTextures),B+=1,R}this.allocTextureUnit=Rs,this.setTexture2D=function(){var R=!1;return function(k,fe){k&&k.isWebGLRenderTarget&&(R||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),R=!0),k=k.texture),Ze.setTexture2D(k,fe)}}(),this.setTexture=function(){var R=!1;return function(k,fe){R||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),R=!0),Ze.setTexture2D(k,fe)}}(),this.setTextureCube=function(){var R=!1;return function(k,fe){k&&k.isWebGLRenderTargetCube&&(R||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),R=!0),k=k.texture),k&&k.isCubeTexture||Array.isArray(k.image)&&k.image.length===6?Ze.setTextureCube(k,fe):Ze.setTextureCubeDynamic(k,fe)}}(),this.getRenderTarget=function(){return b},this.setRenderTarget=function(R){b=R,R&&Ie.get(R).__webglFramebuffer===void 0&&Ze.setupRenderTarget(R);var F=null,k=!1;if(R){var fe=Ie.get(R).__webglFramebuffer;R.isWebGLRenderTargetCube?(F=fe[R.activeCubeFace],k=!0):F=fe,O.copy(R.viewport),U.copy(R.scissor),W=R.scissorTest}else O.copy(z).multiplyScalar(re),U.copy(D).multiplyScalar(re),W=ee;if(w!==F&&(Z.bindFramebuffer(Z.FRAMEBUFFER,F),w=F),de.viewport(O),de.scissor(U),de.setScissorTest(W),k){var xe=Ie.get(R.texture);Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_CUBE_MAP_POSITIVE_X+R.activeCubeFace,xe.__webglTexture,R.activeMipMapLevel)}},this.readRenderTargetPixels=function(R,F,k,fe,xe,Se){if(!(R&&R.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var ke=Ie.get(R).__webglFramebuffer;if(ke){var Oe=!1;ke!==w&&(Z.bindFramebuffer(Z.FRAMEBUFFER,ke),Oe=!0);try{var qe=R.texture,Xe=qe.format,Be=qe.type;if(Xe!==Gr&&q.convert(Xe)!==Z.getParameter(Z.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(Be!==Ku&&q.convert(Be)!==Z.getParameter(Z.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Be===Oa&&(J.get("OES_texture_float")||J.get("WEBGL_color_buffer_float")))&&!(Be===$u&&J.get("EXT_color_buffer_half_float"))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Z.checkFramebufferStatus(Z.FRAMEBUFFER)===Z.FRAMEBUFFER_COMPLETE?F>=0&&F<=R.width-fe&&k>=0&&k<=R.height-xe&&Z.readPixels(F,k,fe,xe,q.convert(Xe),q.convert(Be),Se):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Oe&&Z.bindFramebuffer(Z.FRAMEBUFFER,w)}}}}function ka(e,t){this.name="",this.color=new Ue(e),this.density=t!==void 0?t:25e-5}ka.prototype.isFogExp2=!0,ka.prototype.clone=function(){return new ka(this.color.getHex(),this.density)},ka.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};function Xa(e,t,n){this.name="",this.color=new Ue(e),this.near=t!==void 0?t:1,this.far=n!==void 0?n:1e3}Xa.prototype.isFog=!0,Xa.prototype.clone=function(){return new Xa(this.color.getHex(),this.near,this.far)},Xa.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};function ao(){we.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}ao.prototype=Object.assign(Object.create(we.prototype),{constructor:ao,copy:function(e,t){return we.prototype.copy.call(this,e,t),e.background!==null&&(this.background=e.background.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=we.prototype.toJSON.call(this,e);return this.background!==null&&(t.object.background=this.background.toJSON(e)),this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}});function Qc(e,t,n,r,a){we.call(this),this.lensFlares=[],this.positionScreen=new I,this.customUpdateCallback=void 0,e!==void 0&&this.add(e,t,n,r,a)}Qc.prototype=Object.assign(Object.create(we.prototype),{constructor:Qc,isLensFlare:!0,copy:function(e){we.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,n=e.lensFlares.length;t<n;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,n,r,a,s){t===void 0&&(t=-1),n===void 0&&(n=0),s===void 0&&(s=1),a===void 0&&(a=new Ue(16777215)),r===void 0&&(r=Da),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:s,color:a,blending:r})},updateLensFlares:function(){var e,t=this.lensFlares.length,n,r=-this.positionScreen.x*2,a=-this.positionScreen.y*2;for(e=0;e<t;e++)n=this.lensFlares[e],n.x=this.positionScreen.x+r*n.distance,n.y=this.positionScreen.y+a*n.distance,n.wantedRotation=n.x*Math.PI*.25,n.rotation+=(n.wantedRotation-n.rotation)*.25}});function hi(e){at.call(this),this.type="SpriteMaterial",this.color=new Ue(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}hi.prototype=Object.create(at.prototype),hi.prototype.constructor=hi,hi.prototype.isSpriteMaterial=!0,hi.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this};function mf(e){we.call(this),this.type="Sprite",this.material=e!==void 0?e:new hi}mf.prototype=Object.assign(Object.create(we.prototype),{constructor:mf,isSprite:!0,raycast:function(){var e=new I,t=new I,n=new I;return function(a,s){t.setFromMatrixPosition(this.matrixWorld),a.ray.closestPointToPoint(t,e),n.setFromMatrixScale(this.matrixWorld);var u=n.x*n.y/4;if(!(t.distanceToSquared(e)>u)){var f=a.ray.origin.distanceTo(e);f<a.near||f>a.far||s.push({distance:f,point:e.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)}});function so(){we.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}so.prototype=Object.assign(Object.create(we.prototype),{constructor:so,copy:function(e){we.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var a=t[n];this.addLevel(a.object.clone(),a.distance)}return this},addLevel:function(e,t){t===void 0&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);n.splice(r,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:function(){var e=new I;return function(n,r){e.setFromMatrixPosition(this.matrixWorld);var a=n.ray.origin.distanceTo(e);this.getObjectForDistance(a).raycast(n,r)}}(),update:function(){var e=new I,t=new I;return function(r){var a=this.levels;if(a.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var s=e.distanceTo(t);a[0].object.visible=!0;for(var u=1,f=a.length;u<f&&s>=a[u].distance;u++)a[u-1].object.visible=!1,a[u].object.visible=!0;for(;u<f;u++)a[u].object.visible=!1}}}(),toJSON:function(e){var t=we.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,r=0,a=n.length;r<a;r++){var s=n[r];t.object.levels.push({object:s.object.uuid,distance:s.distance})}return t}});function oo(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),t===void 0)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ve)}}Object.assign(oo.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Ve;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)e=this.bones[t],e&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new Ve,t=new Ve;return function(){for(var r=this.bones,a=this.boneInverses,s=this.boneMatrices,u=this.boneTexture,f=0,h=r.length;f<h;f++){var l=r[f]?r[f].matrixWorld:t;e.multiplyMatrices(l,a[f]),e.toArray(s,f*16)}u!==void 0&&(u.needsUpdate=!0)}}(),clone:function(){return new oo(this.bones,this.boneInverses)}});function gf(){we.call(this),this.type="Bone"}gf.prototype=Object.assign(Object.create(we.prototype),{constructor:gf,isBone:!0});function yf(e,t){jt.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ve,this.bindMatrixInverse=new Ve;var n=this.initBones(),r=new oo(n);this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}yf.prototype=Object.assign(Object.create(jt.prototype),{constructor:yf,isSkinnedMesh:!0,initBones:function(){var e=[],t,n,r,a;if(this.geometry&&this.geometry.bones!==void 0){for(r=0,a=this.geometry.bones.length;r<a;r++)n=this.geometry.bones[r],t=new gf,e.push(t),t.name=n.name,t.position.fromArray(n.pos),t.quaternion.fromArray(n.rotq),n.scl!==void 0&&t.scale.fromArray(n.scl);for(r=0,a=this.geometry.bones.length;r<a;r++)n=this.geometry.bones[r],n.parent!==-1&&n.parent!==null&&e[n.parent]!==void 0?e[n.parent].add(e[r]):this.add(e[r])}return this.updateMatrixWorld(!0),e},bind:function(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var n=this.geometry.skinWeights[t];e=1/n.manhattanLength(),e!==1/0?n.multiplyScalar(e):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new At,a=this.geometry.attributes.skinWeight;for(t=0;t<a.count;t++)r.x=a.getX(t),r.y=a.getY(t),r.z=a.getZ(t),r.w=a.getW(t),e=1/r.manhattanLength(),e!==1/0?r.multiplyScalar(e):r.set(1,0,0,0),a.setXYZW(t,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(e){jt.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function It(e){at.call(this),this.type="LineBasicMaterial",this.color=new Ue(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}It.prototype=Object.create(at.prototype),It.prototype.constructor=It,It.prototype.isLineBasicMaterial=!0,It.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};function Sn(e,t,n){if(n===1)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Ft(e,t);we.call(this),this.type="Line",this.geometry=e!==void 0?e:new Re,this.material=t!==void 0?t:new It({color:Math.random()*16777215})}Sn.prototype=Object.assign(Object.create(we.prototype),{constructor:Sn,isLine:!0,raycast:function(){var e=new Ve,t=new Wi,n=new fr;return function(a,s){var u=a.linePrecision,f=u*u,h=this.geometry,l=this.matrixWorld;if(h.boundingSphere===null&&h.computeBoundingSphere(),n.copy(h.boundingSphere),n.applyMatrix4(l),a.ray.intersectsSphere(n)!==!1){e.getInverse(l),t.copy(a.ray).applyMatrix4(e);var p=new I,d=new I,v=new I,m=new I,y=this&&this.isLineSegments?2:1;if(h.isBufferGeometry){var x=h.index,b=h.attributes,w=b.position.array;if(x!==null)for(var E=x.array,T=0,M=E.length-1;T<M;T+=y){var P=E[T],O=E[T+1];p.fromArray(w,P*3),d.fromArray(w,O*3);var U=t.distanceSqToSegment(p,d,m,v);if(!(U>f)){m.applyMatrix4(this.matrixWorld);var W=a.ray.origin.distanceTo(m);W<a.near||W>a.far||s.push({distance:W,point:v.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}else for(var T=0,M=w.length/3-1;T<M;T+=y){p.fromArray(w,3*T),d.fromArray(w,3*T+3);var U=t.distanceSqToSegment(p,d,m,v);if(!(U>f)){m.applyMatrix4(this.matrixWorld);var W=a.ray.origin.distanceTo(m);W<a.near||W>a.far||s.push({distance:W,point:v.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}}else if(h.isGeometry)for(var B=h.vertices,V=B.length,T=0;T<V-1;T+=y){var U=t.distanceSqToSegment(B[T],B[T+1],m,v);if(!(U>f)){m.applyMatrix4(this.matrixWorld);var W=a.ray.origin.distanceTo(m);W<a.near||W>a.far||s.push({distance:W,point:v.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Ft(e,t){Sn.call(this,e,t),this.type="LineSegments"}Ft.prototype=Object.assign(Object.create(Sn.prototype),{constructor:Ft,isLineSegments:!0});function _f(e,t){Sn.call(this,e,t),this.type="LineLoop"}_f.prototype=Object.assign(Object.create(Sn.prototype),{constructor:_f,isLineLoop:!0});function ci(e){at.call(this),this.type="PointsMaterial",this.color=new Ue(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}ci.prototype=Object.create(at.prototype),ci.prototype.constructor=ci,ci.prototype.isPointsMaterial=!0,ci.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this};function xf(e,t){we.call(this),this.type="Points",this.geometry=e!==void 0?e:new Re,this.material=t!==void 0?t:new ci({color:Math.random()*16777215})}xf.prototype=Object.assign(Object.create(we.prototype),{constructor:xf,isPoints:!0,raycast:function(){var e=new Ve,t=new Wi,n=new fr;return function(a,s){var u=this,f=this.geometry,h=this.matrixWorld,l=a.params.Points.threshold;if(f.boundingSphere===null&&f.computeBoundingSphere(),n.copy(f.boundingSphere),n.applyMatrix4(h),n.radius+=l,a.ray.intersectsSphere(n)===!1)return;e.getInverse(h),t.copy(a.ray).applyMatrix4(e);var p=l/((this.scale.x+this.scale.y+this.scale.z)/3),d=p*p,v=new I;function m(U,W){var B=t.distanceSqToPoint(U);if(B<d){var V=t.closestPointToPoint(U);V.applyMatrix4(h);var X=a.ray.origin.distanceTo(V);if(X<a.near||X>a.far)return;s.push({distance:X,distanceToRay:Math.sqrt(B),point:V.clone(),index:W,face:null,object:u})}}if(f.isBufferGeometry){var y=f.index,x=f.attributes,b=x.position.array;if(y!==null)for(var w=y.array,E=0,T=w.length;E<T;E++){var M=w[E];v.fromArray(b,M*3),m(v,M)}else for(var E=0,P=b.length/3;E<P;E++)v.fromArray(b,E*3),m(v,E)}else for(var O=f.vertices,E=0,P=O.length;E<P;E++)m(O[E],E)}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function wf(){we.call(this),this.type="Group"}wf.prototype=Object.assign(Object.create(we.prototype),{constructor:wf});function bf(e,t,n,r,a,s,u,f,h){Ut.call(this,e,t,n,r,a,s,u,f,h),this.generateMipmaps=!1;var l=this;function p(){var d=l.image;d.readyState>=d.HAVE_CURRENT_DATA&&(l.needsUpdate=!0),requestAnimationFrame(p)}requestAnimationFrame(p)}bf.prototype=Object.create(Ut.prototype),bf.prototype.constructor=bf;function Ya(e,t,n,r,a,s,u,f,h,l,p,d){Ut.call(this,null,s,u,f,h,l,r,a,p,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}Ya.prototype=Object.create(Ut.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isCompressedTexture=!0;function uo(e,t,n,r,a,s,u,f,h,l){if(l=l!==void 0?l:Ui,l!==Ui&&l!==Fa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&l===Ui&&(n=Js),n===void 0&&l===Fa&&(n=Qs),Ut.call(this,null,r,a,s,u,f,l,n,h),this.image={width:e,height:t},this.magFilter=u!==void 0?u:Fn,this.minFilter=f!==void 0?f:Fn,this.flipY=!1,this.generateMipmaps=!1}uo.prototype=Object.create(Ut.prototype),uo.prototype.constructor=uo,uo.prototype.isDepthTexture=!0;function fo(e){Re.call(this),this.type="WireframeGeometry";var t=[],n,r,a,s,u,f=[0,0],h={},l,p,d,v,m=["a","b","c"],y;if(e&&e.isGeometry){var x=e.faces;for(n=0,a=x.length;n<a;n++){var b=x[n];for(r=0;r<3;r++)p=b[m[r]],d=b[m[(r+1)%3]],f[0]=Math.min(p,d),f[1]=Math.max(p,d),v=f[0]+","+f[1],h[v]===void 0&&(h[v]={index1:f[0],index2:f[1]})}for(v in h)l=h[v],y=e.vertices[l.index1],t.push(y.x,y.y,y.z),y=e.vertices[l.index2],t.push(y.x,y.y,y.z)}else if(e&&e.isBufferGeometry){var w,E,T,M,P,O,U,W;if(y=new I,e.index!==null){for(w=e.attributes.position,E=e.index,T=e.groups,T.length===0&&(T=[{start:0,count:E.count,materialIndex:0}]),s=0,u=T.length;s<u;++s)for(M=T[s],P=M.start,O=M.count,n=P,a=P+O;n<a;n+=3)for(r=0;r<3;r++)p=E.getX(n+r),d=E.getX(n+(r+1)%3),f[0]=Math.min(p,d),f[1]=Math.max(p,d),v=f[0]+","+f[1],h[v]===void 0&&(h[v]={index1:f[0],index2:f[1]});for(v in h)l=h[v],y.fromBufferAttribute(w,l.index1),t.push(y.x,y.y,y.z),y.fromBufferAttribute(w,l.index2),t.push(y.x,y.y,y.z)}else for(w=e.attributes.position,n=0,a=w.count/3;n<a;n++)for(r=0;r<3;r++)U=3*n+r,y.fromBufferAttribute(w,U),t.push(y.x,y.y,y.z),W=3*n+(r+1)%3,y.fromBufferAttribute(w,W),t.push(y.x,y.y,y.z)}this.addAttribute("position",new _e(t,3))}fo.prototype=Object.create(Re.prototype),fo.prototype.constructor=fo;function ho(e,t,n){We.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new qa(e,t,n)),this.mergeVertices()}ho.prototype=Object.create(We.prototype),ho.prototype.constructor=ho;function qa(e,t,n){Re.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],a=[],s=[],u=[],f=1e-5,h=new I,l=new I,p=new I,d=new I,v=new I,m,y,x=t+1;for(m=0;m<=n;m++){var b=m/n;for(y=0;y<=t;y++){var w=y/t;l=e(w,b,l),a.push(l.x,l.y,l.z),w-f>=0?(p=e(w-f,b,p),d.subVectors(l,p)):(p=e(w+f,b,p),d.subVectors(p,l)),b-f>=0?(p=e(w,b-f,p),v.subVectors(l,p)):(p=e(w,b+f,p),v.subVectors(p,l)),h.crossVectors(d,v).normalize(),s.push(h.x,h.y,h.z),u.push(w,b)}}for(m=0;m<n;m++)for(y=0;y<t;y++){var E=m*x+y,T=m*x+y+1,M=(m+1)*x+y+1,P=(m+1)*x+y;r.push(E,T,P),r.push(T,M,P)}this.setIndex(r),this.addAttribute("position",new _e(a,3)),this.addAttribute("normal",new _e(s,3)),this.addAttribute("uv",new _e(u,2))}qa.prototype=Object.create(Re.prototype),qa.prototype.constructor=qa;function co(e,t,n,r){We.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new An(e,t,n,r)),this.mergeVertices()}co.prototype=Object.create(We.prototype),co.prototype.constructor=co;function An(e,t,n,r){Re.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1,r=r||0;var a=[],s=[];u(r),h(n),l(),this.addAttribute("position",new _e(a,3)),this.addAttribute("normal",new _e(a.slice(),3)),this.addAttribute("uv",new _e(s,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function u(w){for(var E=new I,T=new I,M=new I,P=0;P<t.length;P+=3)v(t[P+0],E),v(t[P+1],T),v(t[P+2],M),f(E,T,M,w)}function f(w,E,T,M){var P=Math.pow(2,M),O=[],U,W;for(U=0;U<=P;U++){O[U]=[];var B=w.clone().lerp(T,U/P),V=E.clone().lerp(T,U/P),X=P-U;for(W=0;W<=X;W++)W===0&&U===P?O[U][W]=B:O[U][W]=B.clone().lerp(V,W/X)}for(U=0;U<P;U++)for(W=0;W<2*(P-U)-1;W++){var re=Math.floor(W/2);W%2===0?(d(O[U][re+1]),d(O[U+1][re]),d(O[U][re])):(d(O[U][re+1]),d(O[U+1][re+1]),d(O[U+1][re]))}}function h(w){for(var E=new I,T=0;T<a.length;T+=3)E.x=a[T+0],E.y=a[T+1],E.z=a[T+2],E.normalize().multiplyScalar(w),a[T+0]=E.x,a[T+1]=E.y,a[T+2]=E.z}function l(){for(var w=new I,E=0;E<a.length;E+=3){w.x=a[E+0],w.y=a[E+1],w.z=a[E+2];var T=x(w)/2/Math.PI+.5,M=b(w)/Math.PI+.5;s.push(T,1-M)}m(),p()}function p(){for(var w=0;w<s.length;w+=6){var E=s[w+0],T=s[w+2],M=s[w+4],P=Math.max(E,T,M),O=Math.min(E,T,M);P>.9&&O<.1&&(E<.2&&(s[w+0]+=1),T<.2&&(s[w+2]+=1),M<.2&&(s[w+4]+=1))}}function d(w){a.push(w.x,w.y,w.z)}function v(w,E){var T=w*3;E.x=e[T+0],E.y=e[T+1],E.z=e[T+2]}function m(){for(var w=new I,E=new I,T=new I,M=new I,P=new me,O=new me,U=new me,W=0,B=0;W<a.length;W+=9,B+=6){w.set(a[W+0],a[W+1],a[W+2]),E.set(a[W+3],a[W+4],a[W+5]),T.set(a[W+6],a[W+7],a[W+8]),P.set(s[B+0],s[B+1]),O.set(s[B+2],s[B+3]),U.set(s[B+4],s[B+5]),M.copy(w).add(E).add(T).divideScalar(3);var V=x(M);y(P,B+0,w,V),y(O,B+2,E,V),y(U,B+4,T,V)}}function y(w,E,T,M){M<0&&w.x===1&&(s[E]=w.x-1),T.x===0&&T.z===0&&(s[E]=M/2/Math.PI+.5)}function x(w){return Math.atan2(w.z,-w.x)}function b(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}An.prototype=Object.create(Re.prototype),An.prototype.constructor=An;function lo(e,t){We.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ja(e,t)),this.mergeVertices()}lo.prototype=Object.create(We.prototype),lo.prototype.constructor=lo;function ja(e,t){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];An.call(this,n,r,e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}ja.prototype=Object.create(An.prototype),ja.prototype.constructor=ja;function po(e,t){We.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ki(e,t)),this.mergeVertices()}po.prototype=Object.create(We.prototype),po.prototype.constructor=po;function ki(e,t){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];An.call(this,n,r,e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}ki.prototype=Object.create(An.prototype),ki.prototype.constructor=ki;function vo(e,t){We.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Za(e,t)),this.mergeVertices()}vo.prototype=Object.create(We.prototype),vo.prototype.constructor=vo;function Za(e,t){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];An.call(this,r,a,e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}Za.prototype=Object.create(An.prototype),Za.prototype.constructor=Za;function mo(e,t){We.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ja(e,t)),this.mergeVertices()}mo.prototype=Object.create(We.prototype),mo.prototype.constructor=mo;function Ja(e,t){var n=(1+Math.sqrt(5))/2,r=1/n,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];An.call(this,a,s,e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}Ja.prototype=Object.create(An.prototype),Ja.prototype.constructor=Ja;function go(e,t,n,r,a,s){We.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:a},s!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var u=new Xi(e,t,n,r,a);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals,this.fromBufferGeometry(u),this.mergeVertices()}go.prototype=Object.create(We.prototype),go.prototype.constructor=go;function Xi(e,t,n,r,a){Re.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:a},t=t||64,n=n||1,r=r||8,a=a||!1;var s=e.computeFrenetFrames(t,a);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;var u=new I,f=new I,h=new me,l=new I,p,d,v=[],m=[],y=[],x=[];b(),this.setIndex(x),this.addAttribute("position",new _e(v,3)),this.addAttribute("normal",new _e(m,3)),this.addAttribute("uv",new _e(y,2));function b(){for(p=0;p<t;p++)w(p);w(a===!1?t:0),T(),E()}function w(M){l=e.getPointAt(M/t,l);var P=s.normals[M],O=s.binormals[M];for(d=0;d<=r;d++){var U=d/r*Math.PI*2,W=Math.sin(U),B=-Math.cos(U);f.x=B*P.x+W*O.x,f.y=B*P.y+W*O.y,f.z=B*P.z+W*O.z,f.normalize(),m.push(f.x,f.y,f.z),u.x=l.x+n*f.x,u.y=l.y+n*f.y,u.z=l.z+n*f.z,v.push(u.x,u.y,u.z)}}function E(){for(d=1;d<=t;d++)for(p=1;p<=r;p++){var M=(r+1)*(d-1)+(p-1),P=(r+1)*d+(p-1),O=(r+1)*d+p,U=(r+1)*(d-1)+p;x.push(M,P,U),x.push(P,O,U)}}function T(){for(p=0;p<=t;p++)for(d=0;d<=r;d++)h.x=p/t,h.y=d/r,y.push(h.x,h.y)}}Xi.prototype=Object.create(Re.prototype),Xi.prototype.constructor=Xi;function yo(e,t,n,r,a,s,u){We.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:a,q:s},u!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Qa(e,t,n,r,a,s)),this.mergeVertices()}yo.prototype=Object.create(We.prototype),yo.prototype.constructor=yo;function Qa(e,t,n,r,a,s){Re.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:a,q:s},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,a=a||2,s=s||3;var u=[],f=[],h=[],l=[],p,d,v=new I,m=new I,y=new I,x=new I,b=new I,w=new I,E=new I;for(p=0;p<=n;++p){var T=p/n*a*Math.PI*2;for(X(T,a,s,e,y),X(T+.01,a,s,e,x),w.subVectors(x,y),E.addVectors(x,y),b.crossVectors(w,E),E.crossVectors(b,w),b.normalize(),E.normalize(),d=0;d<=r;++d){var M=d/r*Math.PI*2,P=-t*Math.cos(M),O=t*Math.sin(M);v.x=y.x+(P*E.x+O*b.x),v.y=y.y+(P*E.y+O*b.y),v.z=y.z+(P*E.z+O*b.z),f.push(v.x,v.y,v.z),m.subVectors(v,y).normalize(),h.push(m.x,m.y,m.z),l.push(p/n),l.push(d/r)}}for(d=1;d<=n;d++)for(p=1;p<=r;p++){var U=(r+1)*(d-1)+(p-1),W=(r+1)*d+(p-1),B=(r+1)*d+p,V=(r+1)*(d-1)+p;u.push(U,W,V),u.push(W,B,V)}this.setIndex(u),this.addAttribute("position",new _e(f,3)),this.addAttribute("normal",new _e(h,3)),this.addAttribute("uv",new _e(l,2));function X(re,z,D,ee,K){var te=Math.cos(re),$=Math.sin(re),ue=D/z*re,he=Math.cos(ue);K.x=ee*(2+he)*.5*te,K.y=ee*(2+he)*$*.5,K.z=ee*Math.sin(ue)*.5}}Qa.prototype=Object.create(Re.prototype),Qa.prototype.constructor=Qa;function _o(e,t,n,r,a){We.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:a},this.fromBufferGeometry(new Ka(e,t,n,r,a)),this.mergeVertices()}_o.prototype=Object.create(We.prototype),_o.prototype.constructor=_o;function Ka(e,t,n,r,a){Re.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:a},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,a=a||Math.PI*2;var s=[],u=[],f=[],h=[],l=new I,p=new I,d=new I,v,m;for(v=0;v<=n;v++)for(m=0;m<=r;m++){var y=m/r*a,x=v/n*Math.PI*2;p.x=(e+t*Math.cos(x))*Math.cos(y),p.y=(e+t*Math.cos(x))*Math.sin(y),p.z=t*Math.sin(x),u.push(p.x,p.y,p.z),l.x=e*Math.cos(y),l.y=e*Math.sin(y),d.subVectors(p,l).normalize(),f.push(d.x,d.y,d.z),h.push(m/r),h.push(v/n)}for(v=1;v<=n;v++)for(m=1;m<=r;m++){var b=(r+1)*v+m-1,w=(r+1)*(v-1)+m-1,E=(r+1)*(v-1)+m,T=(r+1)*v+m;s.push(b,w,T),s.push(w,E,T)}this.setIndex(s),this.addAttribute("position",new _e(u,3)),this.addAttribute("normal",new _e(f,3)),this.addAttribute("uv",new _e(h,2))}Ka.prototype=Object.create(Re.prototype),Ka.prototype.constructor=Ka;var hr={area:function(e){for(var t=e.length,n=0,r=t-1,a=0;a<t;r=a++)n+=e[r].x*e[a].y-e[a].x*e[r].y;return n*.5},triangulate:function(){function e(t,n,r,a,s,u){var f,h,l,p,d,v,m,y,x;if(h=t[u[n]].x,l=t[u[n]].y,p=t[u[r]].x,d=t[u[r]].y,v=t[u[a]].x,m=t[u[a]].y,(p-h)*(m-l)-(d-l)*(v-h)<=0)return!1;var b,w,E,T,M,P,O,U,W,B,V,X,re,z,D;for(b=v-p,w=m-d,E=h-v,T=l-m,M=p-h,P=d-l,f=0;f<s;f++)if(y=t[u[f]].x,x=t[u[f]].y,!(y===h&&x===l||y===p&&x===d||y===v&&x===m)&&(O=y-h,U=x-l,W=y-p,B=x-d,V=y-v,X=x-m,D=b*B-w*W,re=M*U-P*O,z=E*X-T*V,D>=-Number.EPSILON&&z>=-Number.EPSILON&&re>=-Number.EPSILON))return!1;return!0}return function(n,r){var a=n.length;if(a<3)return null;var s=[],u=[],f=[],h,l,p;if(hr.area(n)>0)for(l=0;l<a;l++)u[l]=l;else for(l=0;l<a;l++)u[l]=a-1-l;var d=a,v=2*d;for(l=d-1;d>2;){if(v--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),r?f:s;if(h=l,d<=h&&(h=0),l=h+1,d<=l&&(l=0),p=l+1,d<=p&&(p=0),e(n,h,l,p,d,u)){var m,y,x,b,w;for(m=u[h],y=u[l],x=u[p],s.push([n[m],n[y],n[x]]),f.push([u[h],u[l],u[p]]),b=l,w=l+1;w<d;b++,w++)u[b]=u[w];d--,v=2*d}}return r?f:s}}(),triangulateShape:function(e,t){function n(T){var M=T.length;M>2&&T[M-1].equals(T[0])&&T.pop()}n(e),t.forEach(n);function r(T,M,P){return T.x!==M.x?T.x<M.x?T.x<=P.x&&P.x<=M.x:M.x<=P.x&&P.x<=T.x:T.y<M.y?T.y<=P.y&&P.y<=M.y:M.y<=P.y&&P.y<=T.y}function a(T,M,P,O,U){var W=M.x-T.x,B=M.y-T.y,V=O.x-P.x,X=O.y-P.y,re=T.x-P.x,z=T.y-P.y,D=B*V-W*X,ee=B*re-W*z;if(Math.abs(D)>Number.EPSILON){var K;if(D>0){if(ee<0||ee>D)return[];if(K=X*re-V*z,K<0||K>D)return[]}else{if(ee>0||ee<D)return[];if(K=X*re-V*z,K>0||K<D)return[]}if(K===0)return U&&(ee===0||ee===D)?[]:[T];if(K===D)return U&&(ee===0||ee===D)?[]:[M];if(ee===0)return[P];if(ee===D)return[O];var te=K/D;return[{x:T.x+te*W,y:T.y+te*B}]}else{if(ee!==0||X*re!==V*z)return[];var $=W===0&&B===0,ue=V===0&&X===0;if($&&ue)return T.x!==P.x||T.y!==P.y?[]:[T];if($)return r(P,O,T)?[T]:[];if(ue)return r(T,M,P)?[P]:[];var he,oe,ve,pe,Ae,Z,Ce,J;return W!==0?(T.x<M.x?(he=T,ve=T.x,oe=M,pe=M.x):(he=M,ve=M.x,oe=T,pe=T.x),P.x<O.x?(Ae=P,Ce=P.x,Z=O,J=O.x):(Ae=O,Ce=O.x,Z=P,J=P.x)):(T.y<M.y?(he=T,ve=T.y,oe=M,pe=M.y):(he=M,ve=M.y,oe=T,pe=T.y),P.y<O.y?(Ae=P,Ce=P.y,Z=O,J=O.y):(Ae=O,Ce=O.y,Z=P,J=P.y)),ve<=Ce?pe<Ce?[]:pe===Ce?U?[]:[Ae]:pe<=J?[Ae,oe]:[Ae,Z]:ve>J?[]:ve===J?U?[]:[he]:pe<=J?[he,oe]:[he,Z]}}function s(T,M,P,O){var U=M.x-T.x,W=M.y-T.y,B=P.x-T.x,V=P.y-T.y,X=O.x-T.x,re=O.y-T.y,z=U*V-W*B,D=U*re-W*X;if(Math.abs(z)>Number.EPSILON){var ee=X*V-re*B;return z>0?D>=0&&ee>=0:D>=0||ee>=0}else return D>0}function u(T,M){var P=T.concat(),O;function U(J,Pe){var de=P.length-1,Ie=J-1;Ie<0&&(Ie=de);var Ze=J+1;Ze>de&&(Ze=0);var ft=s(P[J],P[Ie],P[Ze],O[Pe]);if(!ft)return!1;var gt=O.length-1,st=Pe-1;st<0&&(st=gt);var Je=Pe+1;return Je>gt&&(Je=0),ft=s(O[Pe],O[st],O[Je],P[J]),!!ft}function W(J,Pe){var de,Ie,Ze;for(de=0;de<P.length;de++)if(Ie=de+1,Ie%=P.length,Ze=a(J,Pe,P[de],P[Ie],!0),Ze.length>0)return!0;return!1}var B=[];function V(J,Pe){var de,Ie,Ze,ft,gt;for(de=0;de<B.length;de++)for(Ie=M[B[de]],Ze=0;Ze<Ie.length;Ze++)if(ft=Ze+1,ft%=Ie.length,gt=a(J,Pe,Ie[Ze],Ie[ft],!0),gt.length>0)return!0;return!1}for(var X,re,z,D,ee,K,te=[],$,ue,he,oe,ve=0,pe=M.length;ve<pe;ve++)B.push(ve);for(var Ae=0,Z=B.length*2;B.length>0;){if(Z--,Z<0){console.log('THREE.ShapeUtils: Infinite Loop! Holes left:" + indepHoles.length + ", Probably Hole outside Shape!');break}for(re=Ae;re<P.length;re++){z=P[re],X=-1;for(var ve=0;ve<B.length;ve++)if(ee=B[ve],K=z.x+":"+z.y+":"+ee,te[K]===void 0){O=M[ee];for(var Ce=0;Ce<O.length;Ce++)if(D=O[Ce],!!U(re,Ce)&&!W(z,D)&&!V(z,D)){X=Ce,B.splice(ve,1),$=P.slice(0,re+1),ue=P.slice(re),he=O.slice(X),oe=O.slice(0,X+1),P=$.concat(he).concat(oe).concat(ue),Ae=re;break}if(X>=0)break;te[K]=!0}if(X>=0)break}}return P}for(var f,h,l,p,d,v,m={},y=e.concat(),x=0,b=t.length;x<b;x++)Array.prototype.push.apply(y,t[x]);for(f=0,h=y.length;f<h;f++)d=y[f].x+":"+y[f].y,m[d]!==void 0&&console.warn("THREE.ShapeUtils: Duplicate point",d,f),m[d]=f;var w=u(e,t),E=hr.triangulate(w,!1);for(f=0,h=E.length;f<h;f++)for(p=E[f],l=0;l<3;l++)d=p[l].x+":"+p[l].y,v=m[d],v!==void 0&&(p[l]=v);return E.concat()},isClockWise:function(e){return hr.area(e)<0}};function li(e,t){We.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new cr(e,t)),this.mergeVertices()}li.prototype=Object.create(We.prototype),li.prototype.constructor=li;function cr(e,t){typeof e>"u"||(Re.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}cr.prototype=Object.create(Re.prototype),cr.prototype.constructor=cr,cr.prototype.getArrays=function(){var e=this.getAttribute("position"),t=e?Array.prototype.slice.call(e.array):[],n=this.getAttribute("uv"),r=n?Array.prototype.slice.call(n.array):[],a=this.index,s=a?Array.prototype.slice.call(a.array):[];return{position:t,uv:r,index:s}},cr.prototype.addShapeList=function(e,t){var n=e.length;t.arrays=this.getArrays();for(var r=0;r<n;r++){var a=e[r];this.addShape(a,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new _e(t.arrays.position,3)),this.addAttribute("uv",new _e(t.arrays.uv,2))},cr.prototype.addShape=function(e,t){var n=t.arrays?t.arrays:this.getArrays(),r=n.position,a=n.index,s=n.uv,u=[],f=t.amount!==void 0?t.amount:100,h=t.bevelThickness!==void 0?t.bevelThickness:6,l=t.bevelSize!==void 0?t.bevelSize:h-2,p=t.bevelSegments!==void 0?t.bevelSegments:3,d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,y=t.extrudePath,x,b=!1,w=t.UVGenerator!==void 0?t.UVGenerator:li.WorldUVGenerator,E,T,M,P;y&&(x=y.getSpacedPoints(m),b=!0,d=!1,E=t.frames!==void 0?t.frames:y.computeFrenetFrames(m,!1),T=new I,M=new I,P=new I),d||(p=0,h=0,l=0);var O,U,W,B=this,V=e.extractPoints(v),X=V.shape,re=V.holes,z=!hr.isClockWise(X);if(z)for(X=X.reverse(),U=0,W=re.length;U<W;U++)O=re[U],hr.isClockWise(O)&&(re[U]=O.reverse());var D=hr.triangulateShape(X,re),ee=X;for(U=0,W=re.length;U<W;U++)O=re[U],X=X.concat(O);function K($e,q,ge){return q||console.error("THREE.ExtrudeGeometry: vec does not exist"),q.clone().multiplyScalar(ge).add($e)}var te,$,ue,he,oe,ve=X.length,pe,Ae=D.length;function Z($e,q,ge){var Me,Ne,be,et=$e.x-q.x,lt=$e.y-q.y,ht=ge.x-$e.x,Rt=ge.y-$e.y,mt=et*et+lt*lt,Jt=et*Rt-lt*ht;if(Math.abs(Jt)>Number.EPSILON){var Qt=Math.sqrt(mt),Gn=Math.sqrt(ht*ht+Rt*Rt),dr=q.x-lt/Qt,gn=q.y+et/Qt,Yr=ge.x-Rt/Gn,vr=ge.y+ht/Gn,rr=((Yr-dr)*Rt-(vr-gn)*ht)/(et*Rt-lt*ht);Me=dr+et*rr-$e.x,Ne=gn+lt*rr-$e.y;var Hn=Me*Me+Ne*Ne;if(Hn<=2)return new me(Me,Ne);be=Math.sqrt(Hn/2)}else{var Ln=!1;et>Number.EPSILON?ht>Number.EPSILON&&(Ln=!0):et<-Number.EPSILON?ht<-Number.EPSILON&&(Ln=!0):Math.sign(lt)===Math.sign(Rt)&&(Ln=!0),Ln?(Me=-lt,Ne=et,be=Math.sqrt(mt)):(Me=et,Ne=lt,be=Math.sqrt(mt/2))}return new me(Me/be,Ne/be)}for(var Ce=[],J=0,Pe=ee.length,de=Pe-1,Ie=J+1;J<Pe;J++,de++,Ie++)de===Pe&&(de=0),Ie===Pe&&(Ie=0),Ce[J]=Z(ee[J],ee[de],ee[Ie]);var Ze=[],ft,gt=Ce.concat();for(U=0,W=re.length;U<W;U++){for(O=re[U],ft=[],J=0,Pe=O.length,de=Pe-1,Ie=J+1;J<Pe;J++,de++,Ie++)de===Pe&&(de=0),Ie===Pe&&(Ie=0),ft[J]=Z(O[J],O[de],O[Ie]);Ze.push(ft),gt=gt.concat(ft)}for(te=0;te<p;te++){for(ue=te/p,he=h*Math.cos(ue*Math.PI/2),$=l*Math.sin(ue*Math.PI/2),J=0,Pe=ee.length;J<Pe;J++)oe=K(ee[J],Ce[J],$),Lt(oe.x,oe.y,-he);for(U=0,W=re.length;U<W;U++)for(O=re[U],ft=Ze[U],J=0,Pe=O.length;J<Pe;J++)oe=K(O[J],ft[J],$),Lt(oe.x,oe.y,-he)}for($=l,J=0;J<ve;J++)oe=d?K(X[J],gt[J],$):X[J],b?(M.copy(E.normals[0]).multiplyScalar(oe.x),T.copy(E.binormals[0]).multiplyScalar(oe.y),P.copy(x[0]).add(M).add(T),Lt(P.x,P.y,P.z)):Lt(oe.x,oe.y,0);var st;for(st=1;st<=m;st++)for(J=0;J<ve;J++)oe=d?K(X[J],gt[J],$):X[J],b?(M.copy(E.normals[st]).multiplyScalar(oe.x),T.copy(E.binormals[st]).multiplyScalar(oe.y),P.copy(x[st]).add(M).add(T),Lt(P.x,P.y,P.z)):Lt(oe.x,oe.y,f/m*st);for(te=p-1;te>=0;te--){for(ue=te/p,he=h*Math.cos(ue*Math.PI/2),$=l*Math.sin(ue*Math.PI/2),J=0,Pe=ee.length;J<Pe;J++)oe=K(ee[J],Ce[J],$),Lt(oe.x,oe.y,f+he);for(U=0,W=re.length;U<W;U++)for(O=re[U],ft=Ze[U],J=0,Pe=O.length;J<Pe;J++)oe=K(O[J],ft[J],$),b?Lt(oe.x,oe.y+x[m-1].y,x[m-1].x+he):Lt(oe.x,oe.y,f+he)}Je(),Nt();function Je(){var $e=r.length/3;if(d){var q=0,ge=ve*q;for(J=0;J<Ae;J++)pe=D[J],mn(pe[2]+ge,pe[1]+ge,pe[0]+ge);for(q=m+p*2,ge=ve*q,J=0;J<Ae;J++)pe=D[J],mn(pe[0]+ge,pe[1]+ge,pe[2]+ge)}else{for(J=0;J<Ae;J++)pe=D[J],mn(pe[2],pe[1],pe[0]);for(J=0;J<Ae;J++)pe=D[J],mn(pe[0]+ve*m,pe[1]+ve*m,pe[2]+ve*m)}B.addGroup($e,r.length/3-$e,t.material!==void 0?t.material:0)}function Nt(){var $e=r.length/3,q=0;for(Et(ee,q),q+=ee.length,U=0,W=re.length;U<W;U++)O=re[U],Et(O,q),q+=O.length;B.addGroup($e,r.length/3-$e,t.extrudeMaterial!==void 0?t.extrudeMaterial:1)}function Et($e,q){var ge,Me;for(J=$e.length;--J>=0;){ge=J,Me=J-1,Me<0&&(Me=$e.length-1);var Ne=0,be=m+p*2;for(Ne=0;Ne<be;Ne++){var et=ve*Ne,lt=ve*(Ne+1),ht=q+ge+et,Rt=q+Me+et,mt=q+Me+lt,Jt=q+ge+lt;an(ht,Rt,mt,Jt)}}}function Lt($e,q,ge){u.push($e),u.push(q),u.push(ge)}function mn($e,q,ge){ot($e),ot(q),ot(ge);var Me=r.length/3,Ne=w.generateTopUV(B,r,Me-3,Me-2,Me-1);zt(Ne[0]),zt(Ne[1]),zt(Ne[2])}function an($e,q,ge,Me){ot($e),ot(q),ot(Me),ot(q),ot(ge),ot(Me);var Ne=r.length/3,be=w.generateSideWallUV(B,r,Ne-6,Ne-3,Ne-2,Ne-1);zt(be[0]),zt(be[1]),zt(be[3]),zt(be[1]),zt(be[2]),zt(be[3])}function ot($e){a.push(r.length/3),r.push(u[$e*3+0]),r.push(u[$e*3+1]),r.push(u[$e*3+2])}function zt($e){s.push($e.x),s.push($e.y)}t.arrays||(this.setIndex(a),this.addAttribute("position",new _e(r,3)),this.addAttribute("uv",new _e(t.arrays.uv,2)))},li.WorldUVGenerator={generateTopUV:function(e,t,n,r,a){var s=t[n*3],u=t[n*3+1],f=t[r*3],h=t[r*3+1],l=t[a*3],p=t[a*3+1];return[new me(s,u),new me(f,h),new me(l,p)]},generateSideWallUV:function(e,t,n,r,a,s){var u=t[n*3],f=t[n*3+1],h=t[n*3+2],l=t[r*3],p=t[r*3+1],d=t[r*3+2],v=t[a*3],m=t[a*3+1],y=t[a*3+2],x=t[s*3],b=t[s*3+1],w=t[s*3+2];return Math.abs(f-p)<.01?[new me(u,1-h),new me(l,1-d),new me(v,1-y),new me(x,1-w)]:[new me(f,1-h),new me(p,1-d),new me(m,1-y),new me(b,1-w)]}};function xo(e,t){We.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new $a(e,t)),this.mergeVertices()}xo.prototype=Object.create(We.prototype),xo.prototype.constructor=xo;function $a(e,t){t=t||{};var n=t.font;if(!(n&&n.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new We;var r=n.generateShapes(e,t.size,t.curveSegments);t.amount=t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),cr.call(this,r,t),this.type="TextBufferGeometry"}$a.prototype=Object.create(cr.prototype),$a.prototype.constructor=$a;function Yi(e,t,n,r,a,s,u){We.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:a,thetaStart:s,thetaLength:u},this.fromBufferGeometry(new qi(e,t,n,r,a,s,u)),this.mergeVertices()}Yi.prototype=Object.create(We.prototype),Yi.prototype.constructor=Yi;function qi(e,t,n,r,a,s,u){Re.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:a,thetaStart:s,thetaLength:u},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=r!==void 0?r:0,a=a!==void 0?a:Math.PI*2,s=s!==void 0?s:0,u=u!==void 0?u:Math.PI;var f=s+u,h,l,p=0,d=[],v=new I,m=new I,y=[],x=[],b=[],w=[];for(l=0;l<=n;l++){var E=[],T=l/n;for(h=0;h<=t;h++){var M=h/t;v.x=-e*Math.cos(r+M*a)*Math.sin(s+T*u),v.y=e*Math.cos(s+T*u),v.z=e*Math.sin(r+M*a)*Math.sin(s+T*u),x.push(v.x,v.y,v.z),m.set(v.x,v.y,v.z).normalize(),b.push(m.x,m.y,m.z),w.push(M,1-T),E.push(p++)}d.push(E)}for(l=0;l<n;l++)for(h=0;h<t;h++){var P=d[l][h+1],O=d[l][h],U=d[l+1][h],W=d[l+1][h+1];(l!==0||s>0)&&y.push(P,O,W),(l!==n-1||f<Math.PI)&&y.push(O,U,W)}this.setIndex(y),this.addAttribute("position",new _e(x,3)),this.addAttribute("normal",new _e(b,3)),this.addAttribute("uv",new _e(w,2))}qi.prototype=Object.create(Re.prototype),qi.prototype.constructor=qi;function wo(e,t,n,r,a,s){We.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new es(e,t,n,r,a,s)),this.mergeVertices()}wo.prototype=Object.create(We.prototype),wo.prototype.constructor=wo;function es(e,t,n,r,a,s){Re.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:a,thetaLength:s},e=e||.5,t=t||1,a=a!==void 0?a:0,s=s!==void 0?s:Math.PI*2,n=n!==void 0?Math.max(3,n):8,r=r!==void 0?Math.max(1,r):1;var u=[],f=[],h=[],l=[],p,d=e,v=(t-e)/r,m=new I,y=new me,x,b;for(x=0;x<=r;x++){for(b=0;b<=n;b++)p=a+b/n*s,m.x=d*Math.cos(p),m.y=d*Math.sin(p),f.push(m.x,m.y,m.z),h.push(0,0,1),y.x=(m.x/t+1)/2,y.y=(m.y/t+1)/2,l.push(y.x,y.y);d+=v}for(x=0;x<r;x++){var w=x*(n+1);for(b=0;b<n;b++){p=b+w;var E=p,T=p+n+1,M=p+n+2,P=p+1;u.push(E,T,P),u.push(T,M,P)}}this.setIndex(u),this.addAttribute("position",new _e(f,3)),this.addAttribute("normal",new _e(h,3)),this.addAttribute("uv",new _e(l,2))}es.prototype=Object.create(Re.prototype),es.prototype.constructor=es;function bo(e,t,n,r){We.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new ts(e,t,n,r)),this.mergeVertices()}bo.prototype=Object.create(We.prototype),bo.prototype.constructor=bo;function ts(e,t,n,r){Re.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||Math.PI*2,r=Ke.clamp(r,0,Math.PI*2);var a=[],s=[],u=[],f,h=1/t,l=new I,p=new me,d,v;for(d=0;d<=t;d++){var m=n+d*h*r,y=Math.sin(m),x=Math.cos(m);for(v=0;v<=e.length-1;v++)l.x=e[v].x*y,l.y=e[v].y,l.z=e[v].x*x,s.push(l.x,l.y,l.z),p.x=d/t,p.y=v/(e.length-1),u.push(p.x,p.y)}for(d=0;d<t;d++)for(v=0;v<e.length-1;v++){f=v+d*e.length;var b=f,w=f+e.length,E=f+e.length+1,T=f+1;a.push(b,w,T),a.push(w,E,T)}if(this.setIndex(a),this.addAttribute("position",new _e(s,3)),this.addAttribute("uv",new _e(u,2)),this.computeVertexNormals(),r===Math.PI*2){var M=this.attributes.normal.array,P=new I,O=new I,U=new I;for(f=t*e.length*3,d=0,v=0;d<e.length;d++,v+=3)P.x=M[v+0],P.y=M[v+1],P.z=M[v+2],O.x=M[f+v+0],O.y=M[f+v+1],O.z=M[f+v+2],U.addVectors(P,O).normalize(),M[v+0]=M[f+v+0]=U.x,M[v+1]=M[f+v+1]=U.y,M[v+2]=M[f+v+2]=U.z}}ts.prototype=Object.create(Re.prototype),ts.prototype.constructor=ts;function ns(e,t){We.call(this),this.type="ShapeGeometry",typeof t=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new rs(e,t)),this.mergeVertices()}ns.prototype=Object.create(We.prototype),ns.prototype.constructor=ns;function rs(e,t){Re.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],a=[],s=[],u=0,f=0;if(Array.isArray(e)===!1)l(e);else for(var h=0;h<e.length;h++)l(e[h]),this.addGroup(u,f,h),u+=f,f=0;this.setIndex(n),this.addAttribute("position",new _e(r,3)),this.addAttribute("normal",new _e(a,3)),this.addAttribute("uv",new _e(s,2));function l(p){var d,v,m,y=r.length/3,x=p.extractPoints(t),b=x.shape,w=x.holes;if(hr.isClockWise(b)===!1)for(b=b.reverse(),d=0,v=w.length;d<v;d++)m=w[d],hr.isClockWise(m)===!0&&(w[d]=m.reverse());var E=hr.triangulateShape(b,w);for(d=0,v=w.length;d<v;d++)m=w[d],b=b.concat(m);for(d=0,v=b.length;d<v;d++){var T=b[d];r.push(T.x,T.y,0),a.push(0,0,1),s.push(T.x,T.y)}for(d=0,v=E.length;d<v;d++){var M=E[d],P=M[0]+y,O=M[1]+y,U=M[2]+y;n.push(P,O,U),f+=3}}}rs.prototype=Object.create(Re.prototype),rs.prototype.constructor=rs;function Eo(e,t){Re.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=t!==void 0?t:1;var n=[],r=Math.cos(Ke.DEG2RAD*t),a=[0,0],s={},u,f,h,l=["a","b","c"],p;e.isBufferGeometry?(p=new We,p.fromBufferGeometry(e)):p=e.clone(),p.mergeVertices(),p.computeFaceNormals();for(var d=p.vertices,v=p.faces,m=0,y=v.length;m<y;m++)for(var x=v[m],b=0;b<3;b++)u=x[l[b]],f=x[l[(b+1)%3]],a[0]=Math.min(u,f),a[1]=Math.max(u,f),h=a[0]+","+a[1],s[h]===void 0?s[h]={index1:a[0],index2:a[1],face1:m,face2:void 0}:s[h].face2=m;for(h in s){var w=s[h];if(w.face2===void 0||v[w.face1].normal.dot(v[w.face2].normal)<=r){var E=d[w.index1];n.push(E.x,E.y,E.z),E=d[w.index2],n.push(E.x,E.y,E.z)}}this.addAttribute("position",new _e(n,3))}Eo.prototype=Object.create(Re.prototype),Eo.prototype.constructor=Eo;function ji(e,t,n,r,a,s,u,f){We.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:a,openEnded:s,thetaStart:u,thetaLength:f},this.fromBufferGeometry(new Wr(e,t,n,r,a,s,u,f)),this.mergeVertices()}ji.prototype=Object.create(We.prototype),ji.prototype.constructor=ji;function Wr(e,t,n,r,a,s,u,f){Re.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:a,openEnded:s,thetaStart:u,thetaLength:f};var h=this;e=e!==void 0?e:1,t=t!==void 0?t:1,n=n||1,r=Math.floor(r)||8,a=Math.floor(a)||1,s=s!==void 0?s:!1,u=u!==void 0?u:0,f=f!==void 0?f:Math.PI*2;var l=[],p=[],d=[],v=[],m=0,y=[],x=n/2,b=0;w(),s===!1&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(l),this.addAttribute("position",new _e(p,3)),this.addAttribute("normal",new _e(d,3)),this.addAttribute("uv",new _e(v,2));function w(){var T,M,P=new I,O=new I,U=0,W=(t-e)/n;for(M=0;M<=a;M++){var B=[],V=M/a,X=V*(t-e)+e;for(T=0;T<=r;T++){var re=T/r,z=re*f+u,D=Math.sin(z),ee=Math.cos(z);O.x=X*D,O.y=-V*n+x,O.z=X*ee,p.push(O.x,O.y,O.z),P.set(D,W,ee).normalize(),d.push(P.x,P.y,P.z),v.push(re,1-V),B.push(m++)}y.push(B)}for(T=0;T<r;T++)for(M=0;M<a;M++){var K=y[M][T],te=y[M+1][T],$=y[M+1][T+1],ue=y[M][T+1];l.push(K,te,ue),l.push(te,$,ue),U+=6}h.addGroup(b,U,0),b+=U}function E(T){var M,P,O,U=new me,W=new I,B=0,V=T===!0?e:t,X=T===!0?1:-1;for(P=m,M=1;M<=r;M++)p.push(0,x*X,0),d.push(0,X,0),v.push(.5,.5),m++;for(O=m,M=0;M<=r;M++){var re=M/r,z=re*f+u,D=Math.cos(z),ee=Math.sin(z);W.x=V*ee,W.y=x*X,W.z=V*D,p.push(W.x,W.y,W.z),d.push(0,X,0),U.x=D*.5+.5,U.y=ee*.5*X+.5,v.push(U.x,U.y),m++}for(M=0;M<r;M++){var K=P+M,te=O+M;T===!0?l.push(te,te+1,K):l.push(te+1,te,K),B+=3}h.addGroup(b,B,T===!0?1:2),b+=B}}Wr.prototype=Object.create(Re.prototype),Wr.prototype.constructor=Wr;function Mo(e,t,n,r,a,s,u){ji.call(this,0,e,t,n,r,a,s,u),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:s,thetaLength:u}}Mo.prototype=Object.create(ji.prototype),Mo.prototype.constructor=Mo;function To(e,t,n,r,a,s,u){Wr.call(this,0,e,t,n,r,a,s,u),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:s,thetaLength:u}}To.prototype=Object.create(Wr.prototype),To.prototype.constructor=To;function So(e,t,n,r){We.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new is(e,t,n,r)),this.mergeVertices()}So.prototype=Object.create(We.prototype),So.prototype.constructor=So;function is(e,t,n,r){Re.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=t!==void 0?Math.max(3,t):8,n=n!==void 0?n:0,r=r!==void 0?r:Math.PI*2;var a=[],s=[],u=[],f=[],h,l,p=new I,d=new me;for(s.push(0,0,0),u.push(0,0,1),f.push(.5,.5),l=0,h=3;l<=t;l++,h+=3){var v=n+l/t*r;p.x=e*Math.cos(v),p.y=e*Math.sin(v),s.push(p.x,p.y,p.z),u.push(0,0,1),d.x=(s[h]/e+1)/2,d.y=(s[h+1]/e+1)/2,f.push(d.x,d.y)}for(h=1;h<=t;h++)a.push(h,h+1,0);this.setIndex(a),this.addAttribute("position",new _e(s,3)),this.addAttribute("normal",new _e(u,3)),this.addAttribute("uv",new _e(f,2))}is.prototype=Object.create(Re.prototype),is.prototype.constructor=is;var Nn=Object.freeze({WireframeGeometry:fo,ParametricGeometry:ho,ParametricBufferGeometry:qa,TetrahedronGeometry:lo,TetrahedronBufferGeometry:ja,OctahedronGeometry:po,OctahedronBufferGeometry:ki,IcosahedronGeometry:vo,IcosahedronBufferGeometry:Za,DodecahedronGeometry:mo,DodecahedronBufferGeometry:Ja,PolyhedronGeometry:co,PolyhedronBufferGeometry:An,TubeGeometry:go,TubeBufferGeometry:Xi,TorusKnotGeometry:yo,TorusKnotBufferGeometry:Qa,TorusGeometry:_o,TorusBufferGeometry:Ka,TextGeometry:xo,TextBufferGeometry:$a,SphereGeometry:Yi,SphereBufferGeometry:qi,RingGeometry:wo,RingBufferGeometry:es,PlaneGeometry:io,PlaneBufferGeometry:Vi,LatheGeometry:bo,LatheBufferGeometry:ts,ShapeGeometry:ns,ShapeBufferGeometry:rs,ExtrudeGeometry:li,ExtrudeBufferGeometry:cr,EdgesGeometry:Eo,ConeGeometry:Mo,ConeBufferGeometry:To,CylinderGeometry:ji,CylinderBufferGeometry:Wr,CircleGeometry:So,CircleBufferGeometry:is,BoxGeometry:ro,BoxBufferGeometry:Hi});function as(e){at.call(this),this.type="ShadowMaterial",this.color=new Ue(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(e)}as.prototype=Object.create(at.prototype),as.prototype.constructor=as,as.prototype.isShadowMaterial=!0;function ss(e){$n.call(this,e),this.type="RawShaderMaterial"}ss.prototype=Object.create($n.prototype),ss.prototype.constructor=ss,ss.prototype.isRawShaderMaterial=!0;function br(e){at.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ue(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}br.prototype=Object.create(at.prototype),br.prototype.constructor=br,br.prototype.isMeshStandardMaterial=!0,br.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Zi(e){br.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}Zi.prototype=Object.create(br.prototype),Zi.prototype.constructor=Zi,Zi.prototype.isMeshPhysicalMaterial=!0,Zi.prototype.copy=function(e){return br.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this};function er(e){at.call(this),this.type="MeshPhongMaterial",this.color=new Ue(16777215),this.specular=new Ue(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=js,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}er.prototype=Object.create(at.prototype),er.prototype.constructor=er,er.prototype.isMeshPhongMaterial=!0,er.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Ji(e){er.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}Ji.prototype=Object.create(er.prototype),Ji.prototype.constructor=Ji,Ji.prototype.isMeshToonMaterial=!0,Ji.prototype.copy=function(e){return er.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this};function Qi(e){at.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Qi.prototype=Object.create(at.prototype),Qi.prototype.constructor=Qi,Qi.prototype.isMeshNormalMaterial=!0,Qi.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Ki(e){at.call(this),this.type="MeshLambertMaterial",this.color=new Ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=js,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Ki.prototype=Object.create(at.prototype),Ki.prototype.constructor=Ki,Ki.prototype.isMeshLambertMaterial=!0,Ki.prototype.copy=function(e){return at.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function $i(e){It.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}$i.prototype=Object.create(It.prototype),$i.prototype.constructor=$i,$i.prototype.isLineDashedMaterial=!0,$i.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var t0=Object.freeze({ShadowMaterial:as,SpriteMaterial:hi,RawShaderMaterial:ss,ShaderMaterial:$n,PointsMaterial:ci,MeshPhysicalMaterial:Zi,MeshStandardMaterial:br,MeshPhongMaterial:er,MeshToonMaterial:Ji,MeshNormalMaterial:Qi,MeshLambertMaterial:Ki,MeshDepthMaterial:si,MeshDistanceMaterial:oi,MeshBasicMaterial:vn,LineDashedMaterial:$i,LineBasicMaterial:It,Material:at}),Ao={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Kc(e,t,n){var r=this,a=!1,s=0,u=0,f=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(h){u++,a===!1&&r.onStart!==void 0&&r.onStart(h,s,u),a=!0},this.itemEnd=function(h){s++,r.onProgress!==void 0&&r.onProgress(h,s,u),s===u&&(a=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return f?f(h):h},this.setURLModifier=function(h){f=h}}var Bn=new Kc,Er={};function Mr(e){this.manager=e!==void 0?e:Bn}Object.assign(Mr.prototype,{load:function(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,s=Ao.get(e);if(s!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(s),a.manager.itemEnd(e)},0),s;if(Er[e]!==void 0){Er[e].push({onLoad:t,onProgress:n,onError:r});return}var u=/^data:(.*?)(;base64)?,(.*)$/,f=e.match(u);if(f){var h=f[1],l=!!f[2],p=f[3];p=window.decodeURIComponent(p),l&&(p=window.atob(p));try{var d,v=(this.responseType||"").toLowerCase();switch(v){case"arraybuffer":case"blob":for(var m=new Uint8Array(p.length),y=0;y<p.length;y++)m[y]=p.charCodeAt(y);v==="blob"?d=new Blob([m.buffer],{type:h}):d=m.buffer;break;case"document":var x=new DOMParser;d=x.parseFromString(p,h);break;case"json":d=JSON.parse(p);break;default:d=p;break}window.setTimeout(function(){t&&t(d),a.manager.itemEnd(e)},0)}catch(E){window.setTimeout(function(){r&&r(E),a.manager.itemEnd(e),a.manager.itemError(e)},0)}}else{Er[e]=[],Er[e].push({onLoad:t,onProgress:n,onError:r});var b=new XMLHttpRequest;b.open("GET",e,!0),b.addEventListener("load",function(E){var T=E.target.response;Ao.add(e,T);var M=Er[e];if(delete Er[e],this.status===200){for(var P=0,O=M.length;P<O;P++){var U=M[P];U.onLoad&&U.onLoad(T)}a.manager.itemEnd(e)}else if(this.status===0){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var P=0,O=M.length;P<O;P++){var U=M[P];U.onLoad&&U.onLoad(T)}a.manager.itemEnd(e)}else{for(var P=0,O=M.length;P<O;P++){var U=M[P];U.onError&&U.onError(E)}a.manager.itemEnd(e),a.manager.itemError(e)}},!1),b.addEventListener("progress",function(E){for(var T=Er[e],M=0,P=T.length;M<P;M++){var O=T[M];O.onProgress&&O.onProgress(E)}},!1),b.addEventListener("error",function(E){var T=Er[e];delete Er[e];for(var M=0,P=T.length;M<P;M++){var O=T[M];O.onError&&O.onError(E)}a.manager.itemEnd(e),a.manager.itemError(e)},!1),this.responseType!==void 0&&(b.responseType=this.responseType),this.withCredentials!==void 0&&(b.withCredentials=this.withCredentials),b.overrideMimeType&&b.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var w in this.requestHeader)b.setRequestHeader(w,this.requestHeader[w]);b.send(null)}return a.manager.itemStart(e),b},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});function n0(e){this.manager=e!==void 0?e:Bn,this._parser=null}Object.assign(n0.prototype,{load:function(e,t,n,r){var a=this,s=[],u=new Ya;u.image=s;var f=new Mr(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer");function h(v){f.load(e[v],function(m){var y=a._parser(m,!0);s[v]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},l+=1,l===6&&(y.mipmapCount===1&&(u.minFilter=En),u.format=y.format,u.needsUpdate=!0,t&&t(u))},n,r)}if(Array.isArray(e))for(var l=0,p=0,d=e.length;p<d;++p)h(p);else f.load(e,function(v){var m=a._parser(v,!0);if(m.isCubemap)for(var y=m.mipmaps.length/m.mipmapCount,x=0;x<y;x++){s[x]={mipmaps:[]};for(var b=0;b<m.mipmapCount;b++)s[x].mipmaps.push(m.mipmaps[x*m.mipmapCount+b]),s[x].format=m.format,s[x].width=m.width,s[x].height=m.height}else u.image.width=m.width,u.image.height=m.height,u.mipmaps=m.mipmaps;m.mipmapCount===1&&(u.minFilter=En),u.format=m.format,u.needsUpdate=!0,t&&t(u)},n,r);return u},setPath:function(e){return this.path=e,this}});function r0(e){this.manager=e!==void 0?e:Bn,this._parser=null}Object.assign(r0.prototype,{load:function(e,t,n,r){var a=this,s=new Bi,u=new Mr(this.manager);return u.setResponseType("arraybuffer"),u.load(e,function(f){var h=a._parser(f);h&&(h.image!==void 0?s.image=h.image:h.data!==void 0&&(s.image.width=h.width,s.image.height=h.height,s.image.data=h.data),s.wrapS=h.wrapS!==void 0?h.wrapS:Un,s.wrapT=h.wrapT!==void 0?h.wrapT:Un,s.magFilter=h.magFilter!==void 0?h.magFilter:En,s.minFilter=h.minFilter!==void 0?h.minFilter:Zs,s.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.format!==void 0&&(s.format=h.format),h.type!==void 0&&(s.type=h.type),h.mipmaps!==void 0&&(s.mipmaps=h.mipmaps),h.mipmapCount===1&&(s.minFilter=En),s.needsUpdate=!0,t&&t(s,h))},n,r),s}});function Lo(e){this.manager=e!==void 0?e:Bn}Object.assign(Lo.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,s=Ao.get(e);if(s!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(s),a.manager.itemEnd(e)},0),s;var u=document.createElementNS("http://www.w3.org/1999/xhtml","img");return u.addEventListener("load",function(){Ao.add(e,this),t&&t(this),a.manager.itemEnd(e)},!1),u.addEventListener("error",function(f){r&&r(f),a.manager.itemEnd(e),a.manager.itemError(e)},!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(e),u.src=e,u},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}});function i0(e){this.manager=e!==void 0?e:Bn}Object.assign(i0.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,r){var a=new ii,s=new Lo(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);var u=0;function f(l){s.load(e[l],function(p){a.images[l]=p,u++,u===6&&(a.needsUpdate=!0,t&&t(a))},void 0,r)}for(var h=0;h<e.length;++h)f(h);return a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}});function Ef(e){this.manager=e!==void 0?e:Bn}Object.assign(Ef.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,r){var a=new Lo(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var s=new Ut;return s.image=a.load(e,function(){var u=e.search(/\.(jpg|jpeg)$/)>0||e.search(/^data\:image\/jpeg/)===0;s.format=u?Ua:Gr,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}});function Ht(e,t){we.call(this),this.type="Light",this.color=new Ue(e),this.intensity=t!==void 0?t:1,this.receiveShadow=void 0}Ht.prototype=Object.assign(Object.create(we.prototype),{constructor:Ht,isLight:!0,copy:function(e){return we.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=we.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}});function Ro(e,t,n){Ht.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(we.DefaultUp),this.updateMatrix(),this.groundColor=new Ue(t)}Ro.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Ro,isHemisphereLight:!0,copy:function(e){return Ht.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});function ea(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new me(512,512),this.map=null,this.matrix=new Ve}Object.assign(ea.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}});function Mf(){ea.call(this,new Zt(50,1,.5,500))}Mf.prototype=Object.assign(Object.create(ea.prototype),{constructor:Mf,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=Ke.RAD2DEG*2*e.angle,r=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(n!==t.fov||r!==t.aspect||a!==t.far)&&(t.fov=n,t.aspect=r,t.far=a,t.updateProjectionMatrix())}});function Tf(e,t,n,r,a,s){Ht.call(this,e,t),this.type="SpotLight",this.position.copy(we.DefaultUp),this.updateMatrix(),this.target=new we,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(u){this.intensity=u/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=r!==void 0?r:Math.PI/3,this.penumbra=a!==void 0?a:0,this.decay=s!==void 0?s:1,this.shadow=new Mf}Tf.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Tf,isSpotLight:!0,copy:function(e){return Ht.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function Sf(e,t,n,r){Ht.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=r!==void 0?r:1,this.shadow=new ea(new Zt(90,1,.5,500))}Sf.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Sf,isPointLight:!0,copy:function(e){return Ht.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}});function Af(){ea.call(this,new za(-5,5,5,-5,.5,500))}Af.prototype=Object.assign(Object.create(ea.prototype),{constructor:Af});function Lf(e,t){Ht.call(this,e,t),this.type="DirectionalLight",this.position.copy(we.DefaultUp),this.updateMatrix(),this.target=new we,this.shadow=new Af}Lf.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Lf,isDirectionalLight:!0,copy:function(e){return Ht.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function Rf(e,t){Ht.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}Rf.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Rf,isAmbientLight:!0});function Cf(e,t,n,r){Ht.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=n!==void 0?n:10,this.height=r!==void 0?r:10}Cf.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Cf,isRectAreaLight:!0,copy:function(e){return Ht.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Ht.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var hn={arraySlice:function(e,t,n){return hn.isTypedArray(e)?new e.constructor(e.subarray(t,n!==void 0?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function t(s,u){return e[s]-e[u]}for(var n=e.length,r=new Array(n),a=0;a!==n;++a)r[a]=a;return r.sort(t),r},sortedArray:function(e,t,n){for(var r=e.length,a=new e.constructor(r),s=0,u=0;u!==r;++s)for(var f=n[s]*t,h=0;h!==t;++h)a[u++]=e[f+h];return a},flattenJSON:function(e,t,n,r){for(var a=1,s=e[0];s!==void 0&&s[r]===void 0;)s=e[a++];if(s!==void 0){var u=s[r];if(u!==void 0)if(Array.isArray(u))do u=s[r],u!==void 0&&(t.push(s.time),n.push.apply(n,u)),s=e[a++];while(s!==void 0);else if(u.toArray!==void 0)do u=s[r],u!==void 0&&(t.push(s.time),u.toArray(n,n.length)),s=e[a++];while(s!==void 0);else do u=s[r],u!==void 0&&(t.push(s.time),n.push(u)),s=e[a++];while(s!==void 0)}}};function zn(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}Object.assign(zn.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],a=t[n-1];e:{t:{var s;n:{r:if(!(e<r)){for(var u=n+2;;){if(r===void 0){if(e<a)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,a)}if(n===u)break;if(a=r,r=t[++n],e<r)break t}s=t.length;break n}if(!(e>=a)){var f=t[1];e<f&&(n=2,a=f);for(var u=n-2;;){if(a===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===u)break;if(r=a,a=t[--n-1],e>=a)break t}s=n,n=0;break n}break e}for(;n<s;){var h=n+s>>>1;e<t[h]?s=h:n=h+1}if(r=t[n],a=t[n-1],a===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(r===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,a,e)}this._cachedIndex=n,this.intervalChanged_(n,a,r)}return this.interpolate_(n,a,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r,s=0;s!==r;++s)t[s]=n[a+s];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(zn.prototype,{beforeStart_:zn.prototype.copySampleValue_,afterEnd_:zn.prototype.copySampleValue_});function Pf(e,t,n,r){zn.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Pf.prototype=Object.assign(Object.create(zn.prototype),{constructor:Pf,DefaultSettings_:{endingStart:Fi,endingEnd:Fi},intervalChanged_:function(e,t,n){var r=this.parameterPositions,a=e-2,s=e+1,u=r[a],f=r[s];if(u===void 0)switch(this.getSettings_().endingStart){case Ni:a=e,u=2*t-n;break;case eo:a=r.length-2,u=t+r[a]-r[a+1];break;default:a=e,u=n}if(f===void 0)switch(this.getSettings_().endingEnd){case Ni:s=e,f=2*n-t;break;case eo:s=1,f=n+r[1]-r[0];break;default:s=e-1,f=t}var h=(n-t)*.5,l=this.valueSize;this._weightPrev=h/(t-u),this._weightNext=h/(f-n),this._offsetPrev=a*l,this._offsetNext=s*l},interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,s=this.sampleValues,u=this.valueSize,f=e*u,h=f-u,l=this._offsetPrev,p=this._offsetNext,d=this._weightPrev,v=this._weightNext,m=(n-t)/(r-t),y=m*m,x=y*m,b=-d*x+2*d*y-d*m,w=(1+d)*x+(-1.5-2*d)*y+(-.5+d)*m+1,E=(-1-v)*x+(1.5+v)*y+.5*m,T=v*x-v*y,M=0;M!==u;++M)a[M]=b*s[l+M]+w*s[h+M]+E*s[f+M]+T*s[p+M];return a}});function Co(e,t,n,r){zn.call(this,e,t,n,r)}Co.prototype=Object.assign(Object.create(zn.prototype),{constructor:Co,interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,s=this.sampleValues,u=this.valueSize,f=e*u,h=f-u,l=(n-t)/(r-t),p=1-l,d=0;d!==u;++d)a[d]=s[h+d]*p+s[f+d]*l;return a}});function If(e,t,n,r){zn.call(this,e,t,n,r)}If.prototype=Object.assign(Object.create(zn.prototype),{constructor:If,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Tr;Tr={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:$s,InterpolantFactoryMethodDiscrete:function(e){return new If(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Co(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Pf(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case Ks:t=this.InterpolantFactoryMethodDiscrete;break;case $s:t=this.InterpolantFactoryMethodLinear;break;case ef:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);console.warn("THREE.KeyframeTrackPrototype:",n);return}this.createInterpolant=t},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ks;case this.InterpolantFactoryMethodLinear:return $s;case this.InterpolantFactoryMethodSmooth:return ef}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(e!==1)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,a=0,s=r-1;a!==r&&n[a]<e;)++a;for(;s!==-1&&n[s]>t;)--s;if(++s,a!==0||s!==r){a>=s&&(s=Math.max(s,1),a=s-1);var u=this.getValueSize();this.times=hn.arraySlice(n,a,s),this.values=hn.arraySlice(this.values,a*u,s*u)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,a=n.length;a===0&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),e=!1);for(var s=null,u=0;u!==a;u++){var f=n[u];if(typeof f=="number"&&isNaN(f)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,u,f),e=!1;break}if(s!==null&&s>f){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,u,f,s),e=!1;break}s=f}if(r!==void 0&&hn.isTypedArray(r))for(var u=0,h=r.length;u!==h;++u){var l=r[u];if(isNaN(l)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,u,l),e=!1;break}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=this.getInterpolation()===ef,a=1,s=e.length-1,u=1;u<s;++u){var f=!1,h=e[u],l=e[u+1];if(h!==l&&(u!==1||h!==h[0]))if(r)f=!0;else for(var p=u*n,d=p-n,v=p+n,m=0;m!==n;++m){var y=t[p+m];if(y!==t[d+m]||y!==t[v+m]){f=!0;break}}if(f){if(u!==a){e[a]=e[u];for(var x=u*n,b=a*n,m=0;m!==n;++m)t[b+m]=t[x+m]}++a}}if(s>0){e[a]=e[s];for(var x=s*n,b=a*n,m=0;m!==n;++m)t[b+m]=t[x+m];++a}return a!==e.length&&(this.times=hn.arraySlice(e,0,a),this.values=hn.arraySlice(t,0,a*n)),this}};function pi(e,t,n,r){if(e===void 0)throw new Error("track name is undefined");if(t===void 0||t.length===0)throw new Error("no keyframes in track named "+e);this.name=e,this.times=hn.convertArray(t,this.TimeBufferType),this.values=hn.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function os(e,t,n,r){pi.call(this,e,t,n,r)}os.prototype=Object.assign(Object.create(Tr),{constructor:os,ValueTypeName:"vector"});function Df(e,t,n,r){zn.call(this,e,t,n,r)}Df.prototype=Object.assign(Object.create(zn.prototype),{constructor:Df,interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,s=this.sampleValues,u=this.valueSize,f=e*u,h=(n-t)/(r-t),l=f+u;f!==l;f+=4)qt.slerpFlat(a,0,s,f-u,s,f,h);return a}});function Po(e,t,n,r){pi.call(this,e,t,n,r)}Po.prototype=Object.assign(Object.create(Tr),{constructor:Po,ValueTypeName:"quaternion",DefaultInterpolation:$s,InterpolantFactoryMethodLinear:function(e){return new Df(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function us(e,t,n,r){pi.call(this,e,t,n,r)}us.prototype=Object.assign(Object.create(Tr),{constructor:us,ValueTypeName:"number"});function Of(e,t,n,r){pi.call(this,e,t,n,r)}Of.prototype=Object.assign(Object.create(Tr),{constructor:Of,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ks,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Uf(e,t,n){pi.call(this,e,t,n)}Uf.prototype=Object.assign(Object.create(Tr),{constructor:Uf,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ks,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Ff(e,t,n,r){pi.call(this,e,t,n,r)}Ff.prototype=Object.assign(Object.create(Tr),{constructor:Ff,ValueTypeName:"color"});function ta(e,t,n,r){pi.apply(this,e,t,n,r)}ta.prototype=Tr,Tr.constructor=ta,Object.assign(ta,{parse:function(e){if(e.type===void 0)throw new Error("track type undefined, can not parse");var t=ta._getTrackTypeForValueTypeName(e.type);if(e.times===void 0){var n=[],r=[];hn.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t=e.constructor,n;if(t.toJSON!==void 0)n=t.toJSON(e);else{n={name:e.name,times:hn.convertArray(e.times,Array),values:hn.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return us;case"vector":case"vector2":case"vector3":case"vector4":return os;case"color":return Ff;case"quaternion":return Po;case"bool":case"boolean":return Uf;case"string":return Of}throw new Error("Unsupported typeName: "+e)}});function tr(e,t,n){this.name=e,this.tracks=n,this.duration=t!==void 0?t:-1,this.uuid=Ke.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}Object.assign(tr,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),a=0,s=n.length;a!==s;++a)t.push(ta.parse(n[a]).scale(r));return new tr(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t},a=0,s=n.length;a!==s;++a)t.push(ta.toJSON(n[a]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var a=t.length,s=[],u=0;u<a;u++){var f=[],h=[];f.push((u+a-1)%a,u,(u+1)%a),h.push(0,1,0);var l=hn.getKeyframeOrder(f);f=hn.sortedArray(f,1,l),h=hn.sortedArray(h,1,l),!r&&f[0]===0&&(f.push(a),h.push(h[0])),s.push(new us(".morphTargetInfluences["+t[u].name+"]",f,h).scale(1/n))}return new tr(e,-1,s)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var a=0;a<n.length;a++)if(n[a].name===t)return n[a];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},a=/^([\w-]*?)([\d]+)$/,s=0,u=e.length;s<u;s++){var f=e[s],h=f.name.match(a);if(h&&h.length>1){var l=h[1],p=r[l];p||(r[l]=p=[]),p.push(f)}}var d=[];for(var l in r)d.push(tr.CreateFromMorphTargetSequence(l,r[l],t,n));return d},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(T,M,P,O,U){if(P.length!==0){var W=[],B=[];hn.flattenJSON(P,W,B,O),W.length!==0&&U.push(new T(M,W,B))}},r=[],a=e.name||"default",s=e.length||-1,u=e.fps||30,f=e.hierarchy||[],h=0;h<f.length;h++){var l=f[h].keys;if(!(!l||l.length===0))if(l[0].morphTargets){for(var p={},d=0;d<l.length;d++)if(l[d].morphTargets)for(var v=0;v<l[d].morphTargets.length;v++)p[l[d].morphTargets[v]]=-1;for(var m in p){for(var y=[],x=[],v=0;v!==l[d].morphTargets.length;++v){var b=l[d];y.push(b.time),x.push(b.morphTarget===m?1:0)}r.push(new us(".morphTargetInfluence["+m+"]",y,x))}s=p.length*(u||1)}else{var w=".bones["+t[h].name+"]";n(os,w+".position",l,"pos",r),n(Po,w+".quaternion",l,"rot",r),n(os,w+".scale",l,"scl",r)}}if(r.length===0)return null;var E=new tr(a,s,r);return E}}),Object.assign(tr.prototype,{resetDuration:function(){for(var e=this.tracks,t=0,n=0,r=e.length;n!==r;++n){var a=this.tracks[n];t=Math.max(t,a.times[a.times.length-1])}this.duration=t},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}});function Nf(e){this.manager=e!==void 0?e:Bn,this.textures={}}Object.assign(Nf.prototype,{load:function(e,t,n,r){var a=this,s=new Mr(a.manager);s.load(e,function(u){t(a.parse(JSON.parse(u)))},n,r)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}var r=new t0[e.type];if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular.setHex(e.specular),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearCoat!==void 0&&(r.clearCoat=e.clearCoat),e.clearCoatRoughness!==void 0&&(r.clearCoatRoughness=e.clearCoatRoughness),e.uniforms!==void 0&&(r.uniforms=e.uniforms),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.vertexColors!==void 0&&(r.vertexColors=e.vertexColors),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.side!==void 0&&(r.side=e.side),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.skinning!==void 0&&(r.skinning=e.skinning),e.morphTargets!==void 0&&(r.morphTargets=e.morphTargets),e.dithering!==void 0&&(r.dithering=e.dithering),e.visible!==void 0&&(r.visible=e.visible),e.userData!==void 0&&(r.userData=e.userData),e.shading!==void 0&&(r.flatShading=e.shading===1),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap),r.transparent=!0),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalScale!==void 0){var a=e.normalScale;Array.isArray(a)===!1&&(a=[a,a]),r.normalScale=new me().fromArray(a)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),r}});function $c(e){this.manager=e!==void 0?e:Bn}Object.assign($c.prototype,{load:function(e,t,n,r){var a=this,s=new Mr(a.manager);s.load(e,function(u){t(a.parse(JSON.parse(u)))},n,r)},parse:function(e){var t=new Re,n=e.data.index;if(n!==void 0){var r=new el[n.type](n.array);t.setIndex(new nt(r,1))}var a=e.data.attributes;for(var s in a){var u=a[s],r=new el[u.type](u.array);t.addAttribute(s,new nt(r,u.itemSize,u.normalized))}var f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(var h=0,l=f.length;h!==l;++h){var p=f[h];t.addGroup(p.start,p.count,p.materialIndex)}var d=e.data.boundingSphere;if(d!==void 0){var v=new I;d.center!==void 0&&v.fromArray(d.center),t.boundingSphere=new fr(v,d.radius)}return t}});var el={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function fs(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}fs.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var a=t[n],s=t[n+1];if(a.test(e))return s}return null}},Object.assign(fs.prototype,{crossOrigin:void 0,extractUrlBase:function(e){var t=e.split("/");return t.length===1?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t,n){for(var r=[],a=0;a<e.length;++a)r[a]=this.createMaterial(e[a],t,n);return r},createMaterial:function(){var e={NoBlending:Gu,NormalBlending:Da,AdditiveBlending:Hu,SubtractiveBlending:uc,MultiplyBlending:fc,CustomBlending:hc},t=new Ue,n=new Ef,r=new Nf;return function(s,u,f){var h={};function l(m,y,x,b,w){var E=u+m,T=fs.Handlers.get(E),M;T!==null?M=T.load(E):(n.setCrossOrigin(f),M=n.load(E)),y!==void 0&&(M.repeat.fromArray(y),y[0]!==1&&(M.wrapS=zr),y[1]!==1&&(M.wrapT=zr)),x!==void 0&&M.offset.fromArray(x),b!==void 0&&(b[0]==="repeat"&&(M.wrapS=zr),b[0]==="mirror"&&(M.wrapS=Oi),b[1]==="repeat"&&(M.wrapT=zr),b[1]==="mirror"&&(M.wrapT=Oi)),w!==void 0&&(M.anisotropy=w);var P=Ke.generateUUID();return h[P]=M,P}var p={uuid:Ke.generateUUID(),type:"MeshLambertMaterial"};for(var d in s){var v=s[d];switch(d){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":p.name=v;break;case"blending":p.blending=e[v];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",d,"is no longer supported.");break;case"colorDiffuse":p.color=t.fromArray(v).getHex();break;case"colorSpecular":p.specular=t.fromArray(v).getHex();break;case"colorEmissive":p.emissive=t.fromArray(v).getHex();break;case"specularCoef":p.shininess=v;break;case"shading":v.toLowerCase()==="basic"&&(p.type="MeshBasicMaterial"),v.toLowerCase()==="phong"&&(p.type="MeshPhongMaterial"),v.toLowerCase()==="standard"&&(p.type="MeshStandardMaterial");break;case"mapDiffuse":p.map=l(v,s.mapDiffuseRepeat,s.mapDiffuseOffset,s.mapDiffuseWrap,s.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":p.emissiveMap=l(v,s.mapEmissiveRepeat,s.mapEmissiveOffset,s.mapEmissiveWrap,s.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":p.lightMap=l(v,s.mapLightRepeat,s.mapLightOffset,s.mapLightWrap,s.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":p.aoMap=l(v,s.mapAORepeat,s.mapAOOffset,s.mapAOWrap,s.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":p.bumpMap=l(v,s.mapBumpRepeat,s.mapBumpOffset,s.mapBumpWrap,s.mapBumpAnisotropy);break;case"mapBumpScale":p.bumpScale=v;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":p.normalMap=l(v,s.mapNormalRepeat,s.mapNormalOffset,s.mapNormalWrap,s.mapNormalAnisotropy);break;case"mapNormalFactor":p.normalScale=[v,v];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":p.specularMap=l(v,s.mapSpecularRepeat,s.mapSpecularOffset,s.mapSpecularWrap,s.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":p.metalnessMap=l(v,s.mapMetalnessRepeat,s.mapMetalnessOffset,s.mapMetalnessWrap,s.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":p.roughnessMap=l(v,s.mapRoughnessRepeat,s.mapRoughnessOffset,s.mapRoughnessWrap,s.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":p.alphaMap=l(v,s.mapAlphaRepeat,s.mapAlphaOffset,s.mapAlphaWrap,s.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":p.side=ri;break;case"doubleSided":p.side=Ia;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),p.opacity=v;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":p[d]=v;break;case"vertexColors":v===!0&&(p.vertexColors=Di),v==="face"&&(p.vertexColors=oc);break;default:console.error("THREE.Loader.createMaterial: Unsupported",d,v);break}}return p.type==="MeshBasicMaterial"&&delete p.emissive,p.type!=="MeshPhongMaterial"&&delete p.specular,p.opacity<1&&(p.transparent=!0),r.setTextures(h),r.parse(p)}}()});function tl(e){typeof e=="boolean"&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=e!==void 0?e:Bn,this.withCredentials=!1}Object.assign(tl.prototype,{load:function(e,t,n,r){var a=this,s=this.texturePath&&typeof this.texturePath=="string"?this.texturePath:fs.prototype.extractUrlBase(e),u=new Mr(this.manager);u.setWithCredentials(this.withCredentials),u.load(e,function(f){var h=JSON.parse(f),l=h.metadata;if(l!==void 0){var p=l.type;if(p!==void 0){if(p.toLowerCase()==="object"){console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");return}if(p.toLowerCase()==="scene"){console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.");return}}}var d=a.parse(h,s);t(d.geometry,d.materials)},n,r)},setTexturePath:function(e){this.texturePath=e},parse:function(){function e(a,s){function u(Ae,Z){return Ae&1<<Z}var f,h,l,p,d,v,m,y,x,b,w,E,T,M,P,O,U,W,B,V,X,re,z,D,ee,K,te,$=a.faces,ue=a.vertices,he=a.normals,oe=a.colors,ve=a.scale,pe=0;if(a.uvs!==void 0){for(f=0;f<a.uvs.length;f++)a.uvs[f].length&&pe++;for(f=0;f<pe;f++)s.faceVertexUvs[f]=[]}for(p=0,d=ue.length;p<d;)W=new I,W.x=ue[p++]*ve,W.y=ue[p++]*ve,W.z=ue[p++]*ve,s.vertices.push(W);for(p=0,d=$.length;p<d;)if(b=$[p++],w=u(b,0),E=u(b,1),T=u(b,3),M=u(b,4),P=u(b,5),O=u(b,6),U=u(b,7),w){if(V=new fi,V.a=$[p],V.b=$[p+1],V.c=$[p+3],X=new fi,X.a=$[p+1],X.b=$[p+2],X.c=$[p+3],p+=4,E&&(x=$[p++],V.materialIndex=x,X.materialIndex=x),l=s.faces.length,T)for(f=0;f<pe;f++)for(D=a.uvs[f],s.faceVertexUvs[f][l]=[],s.faceVertexUvs[f][l+1]=[],h=0;h<4;h++)y=$[p++],K=D[y*2],te=D[y*2+1],ee=new me(K,te),h!==2&&s.faceVertexUvs[f][l].push(ee),h!==0&&s.faceVertexUvs[f][l+1].push(ee);if(M&&(m=$[p++]*3,V.normal.set(he[m++],he[m++],he[m]),X.normal.copy(V.normal)),P)for(f=0;f<4;f++)m=$[p++]*3,z=new I(he[m++],he[m++],he[m]),f!==2&&V.vertexNormals.push(z),f!==0&&X.vertexNormals.push(z);if(O&&(v=$[p++],re=oe[v],V.color.setHex(re),X.color.setHex(re)),U)for(f=0;f<4;f++)v=$[p++],re=oe[v],f!==2&&V.vertexColors.push(new Ue(re)),f!==0&&X.vertexColors.push(new Ue(re));s.faces.push(V),s.faces.push(X)}else{if(B=new fi,B.a=$[p++],B.b=$[p++],B.c=$[p++],E&&(x=$[p++],B.materialIndex=x),l=s.faces.length,T)for(f=0;f<pe;f++)for(D=a.uvs[f],s.faceVertexUvs[f][l]=[],h=0;h<3;h++)y=$[p++],K=D[y*2],te=D[y*2+1],ee=new me(K,te),s.faceVertexUvs[f][l].push(ee);if(M&&(m=$[p++]*3,B.normal.set(he[m++],he[m++],he[m])),P)for(f=0;f<3;f++)m=$[p++]*3,z=new I(he[m++],he[m++],he[m]),B.vertexNormals.push(z);if(O&&(v=$[p++],B.color.setHex(oe[v])),U)for(f=0;f<3;f++)v=$[p++],B.vertexColors.push(new Ue(oe[v]));s.faces.push(B)}}function t(a,s){var u=a.influencesPerVertex!==void 0?a.influencesPerVertex:2;if(a.skinWeights)for(var f=0,h=a.skinWeights.length;f<h;f+=u){var l=a.skinWeights[f],p=u>1?a.skinWeights[f+1]:0,d=u>2?a.skinWeights[f+2]:0,v=u>3?a.skinWeights[f+3]:0;s.skinWeights.push(new At(l,p,d,v))}if(a.skinIndices)for(var f=0,h=a.skinIndices.length;f<h;f+=u){var m=a.skinIndices[f],y=u>1?a.skinIndices[f+1]:0,x=u>2?a.skinIndices[f+2]:0,b=u>3?a.skinIndices[f+3]:0;s.skinIndices.push(new At(m,y,x,b))}s.bones=a.bones,s.bones&&s.bones.length>0&&(s.skinWeights.length!==s.skinIndices.length||s.skinIndices.length!==s.vertices.length)&&console.warn("When skinning, number of vertices ("+s.vertices.length+"), skinIndices ("+s.skinIndices.length+"), and skinWeights ("+s.skinWeights.length+") should match.")}function n(a,s){var u=a.scale;if(a.morphTargets!==void 0)for(var f=0,h=a.morphTargets.length;f<h;f++){s.morphTargets[f]={},s.morphTargets[f].name=a.morphTargets[f].name,s.morphTargets[f].vertices=[];for(var l=s.morphTargets[f].vertices,p=a.morphTargets[f].vertices,d=0,v=p.length;d<v;d+=3){var m=new I;m.x=p[d]*u,m.y=p[d+1]*u,m.z=p[d+2]*u,l.push(m)}}if(a.morphColors!==void 0&&a.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var y=s.faces,x=a.morphColors[0].colors,f=0,h=y.length;f<h;f++)y[f].color.fromArray(x,f*3)}}function r(a,s){var u=[],f=[];a.animation!==void 0&&f.push(a.animation),a.animations!==void 0&&(a.animations.length?f=f.concat(a.animations):f.push(a.animations));for(var h=0;h<f.length;h++){var l=tr.parseAnimation(f[h],s.bones);l&&u.push(l)}if(s.morphTargets){var p=tr.CreateClipsFromMorphTargetSequences(s.morphTargets,10);u=u.concat(p)}u.length>0&&(s.animations=u)}return function(a,s){a.data!==void 0&&(a=a.data),a.scale!==void 0?a.scale=1/a.scale:a.scale=1;var u=new We;if(e(a,u),t(a,u),n(a,u),r(a,u),u.computeFaceNormals(),u.computeBoundingSphere(),a.materials===void 0||a.materials.length===0)return{geometry:u};var f=fs.prototype.initMaterials(a.materials,s,this.crossOrigin);return{geometry:u,materials:f}}}()});function a0(e){this.manager=e!==void 0?e:Bn,this.texturePath=""}Object.assign(a0.prototype,{load:function(e,t,n,r){this.texturePath===""&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var a=this,s=new Mr(a.manager);s.load(e,function(u){var f=null;try{f=JSON.parse(u)}catch(l){r!==void 0&&r(l),console.error("THREE:ObjectLoader: Can't parse "+e+".",l.message);return}var h=f.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.");return}a.parse(f,t)},n,r)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var n=this.parseGeometries(e.geometries),r=this.parseImages(e.images,function(){t!==void 0&&t(u)}),a=this.parseTextures(e.textures,r),s=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,n,s);return e.animations&&(u.animations=this.parseAnimations(e.animations)),(e.images===void 0||e.images.length===0)&&t!==void 0&&t(u),u},parseGeometries:function(e){var t={};if(e!==void 0)for(var n=new tl,r=new $c,a=0,s=e.length;a<s;a++){var u,f=e[a];switch(f.type){case"PlaneGeometry":case"PlaneBufferGeometry":u=new Nn[f.type](f.width,f.height,f.widthSegments,f.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":u=new Nn[f.type](f.width,f.height,f.depth,f.widthSegments,f.heightSegments,f.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":u=new Nn[f.type](f.radius,f.segments,f.thetaStart,f.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":u=new Nn[f.type](f.radiusTop,f.radiusBottom,f.height,f.radialSegments,f.heightSegments,f.openEnded,f.thetaStart,f.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":u=new Nn[f.type](f.radius,f.height,f.radialSegments,f.heightSegments,f.openEnded,f.thetaStart,f.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":u=new Nn[f.type](f.radius,f.widthSegments,f.heightSegments,f.phiStart,f.phiLength,f.thetaStart,f.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":u=new Nn[f.type](f.radius,f.detail);break;case"RingGeometry":case"RingBufferGeometry":u=new Nn[f.type](f.innerRadius,f.outerRadius,f.thetaSegments,f.phiSegments,f.thetaStart,f.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":u=new Nn[f.type](f.radius,f.tube,f.radialSegments,f.tubularSegments,f.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":u=new Nn[f.type](f.radius,f.tube,f.tubularSegments,f.radialSegments,f.p,f.q);break;case"LatheGeometry":case"LatheBufferGeometry":u=new Nn[f.type](f.points,f.segments,f.phiStart,f.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":u=new Nn[f.type](f.vertices,f.indices,f.radius,f.details);break;case"BufferGeometry":u=r.parse(f);break;case"Geometry":u=n.parse(f,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+f.type+'"');continue}u.uuid=f.uuid,f.name!==void 0&&(u.name=f.name),t[f.uuid]=u}return t},parseMaterials:function(e,t){var n={};if(e!==void 0){var r=new Nf;r.setTextures(t);for(var a=0,s=e.length;a<s;a++){var u=e[a];if(u.type==="MultiMaterial"){for(var f=[],h=0;h<u.materials.length;h++)f.push(r.parse(u.materials[h]));n[u.uuid]=f}else n[u.uuid]=r.parse(u)}}return n},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=tr.parse(e[n]);t.push(r)}return t},parseImages:function(e,t){var n=this,r={};function a(d){return n.manager.itemStart(d),u.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemEnd(d),n.manager.itemError(d)})}if(e!==void 0&&e.length>0){var s=new Kc(t),u=new Lo(s);u.setCrossOrigin(this.crossOrigin);for(var f=0,h=e.length;f<h;f++){var l=e[f],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.texturePath+l.url;r[l.uuid]=a(p)}}return r},parseTextures:function(e,t){function n(h,l){return typeof h=="number"?h:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",h),l[h])}var r={};if(e!==void 0)for(var a=0,s=e.length;a<s;a++){var u=e[a];u.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',u.uuid),t[u.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",u.image);var f=new Ut(t[u.image]);f.needsUpdate=!0,f.uuid=u.uuid,u.name!==void 0&&(f.name=u.name),u.mapping!==void 0&&(f.mapping=n(u.mapping,s0)),u.offset!==void 0&&f.offset.fromArray(u.offset),u.repeat!==void 0&&f.repeat.fromArray(u.repeat),u.center!==void 0&&f.center.fromArray(u.center),u.rotation!==void 0&&(f.rotation=u.rotation),u.wrap!==void 0&&(f.wrapS=n(u.wrap[0],nl),f.wrapT=n(u.wrap[1],nl)),u.minFilter!==void 0&&(f.minFilter=n(u.minFilter,rl)),u.magFilter!==void 0&&(f.magFilter=n(u.magFilter,rl)),u.anisotropy!==void 0&&(f.anisotropy=u.anisotropy),u.flipY!==void 0&&(f.flipY=u.flipY),r[u.uuid]=f}return r},parseObject:function(){var e=new Ve;return function(n,r,a){var s;function u(b){return r[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",b),r[b]}function f(b){if(b!==void 0){if(Array.isArray(b)){for(var w=[],E=0,T=b.length;E<T;E++){var M=b[E];a[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),w.push(a[M])}return w}return a[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),a[b]}}switch(n.type){case"Scene":s=new ao,n.background!==void 0&&Number.isInteger(n.background)&&(s.background=new Ue(n.background)),n.fog!==void 0&&(n.fog.type==="Fog"?s.fog=new Xa(n.fog.color,n.fog.near,n.fog.far):n.fog.type==="FogExp2"&&(s.fog=new ka(n.fog.color,n.fog.density)));break;case"PerspectiveCamera":s=new Zt(n.fov,n.aspect,n.near,n.far),n.focus!==void 0&&(s.focus=n.focus),n.zoom!==void 0&&(s.zoom=n.zoom),n.filmGauge!==void 0&&(s.filmGauge=n.filmGauge),n.filmOffset!==void 0&&(s.filmOffset=n.filmOffset),n.view!==void 0&&(s.view=Object.assign({},n.view));break;case"OrthographicCamera":s=new za(n.left,n.right,n.top,n.bottom,n.near,n.far);break;case"AmbientLight":s=new Rf(n.color,n.intensity);break;case"DirectionalLight":s=new Lf(n.color,n.intensity);break;case"PointLight":s=new Sf(n.color,n.intensity,n.distance,n.decay);break;case"RectAreaLight":s=new Cf(n.color,n.intensity,n.width,n.height);break;case"SpotLight":s=new Tf(n.color,n.intensity,n.distance,n.angle,n.penumbra,n.decay);break;case"HemisphereLight":s=new Ro(n.color,n.groundColor,n.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var h=u(n.geometry),l=f(n.material);h.bones&&h.bones.length>0?s=new yf(h,l):s=new jt(h,l);break;case"LOD":s=new so;break;case"Line":s=new Sn(u(n.geometry),f(n.material),n.mode);break;case"LineLoop":s=new _f(u(n.geometry),f(n.material));break;case"LineSegments":s=new Ft(u(n.geometry),f(n.material));break;case"PointCloud":case"Points":s=new xf(u(n.geometry),f(n.material));break;case"Sprite":s=new mf(f(n.material));break;case"Group":s=new wf;break;default:s=new we}if(s.uuid=n.uuid,n.name!==void 0&&(s.name=n.name),n.matrix!==void 0?(e.fromArray(n.matrix),e.decompose(s.position,s.quaternion,s.scale)):(n.position!==void 0&&s.position.fromArray(n.position),n.rotation!==void 0&&s.rotation.fromArray(n.rotation),n.quaternion!==void 0&&s.quaternion.fromArray(n.quaternion),n.scale!==void 0&&s.scale.fromArray(n.scale)),n.castShadow!==void 0&&(s.castShadow=n.castShadow),n.receiveShadow!==void 0&&(s.receiveShadow=n.receiveShadow),n.shadow&&(n.shadow.bias!==void 0&&(s.shadow.bias=n.shadow.bias),n.shadow.radius!==void 0&&(s.shadow.radius=n.shadow.radius),n.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(n.shadow.mapSize),n.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(n.shadow.camera))),n.visible!==void 0&&(s.visible=n.visible),n.userData!==void 0&&(s.userData=n.userData),n.children!==void 0)for(var p=n.children,d=0;d<p.length;d++)s.add(this.parseObject(p[d],r,a));if(n.type==="LOD")for(var v=n.levels,m=0;m<v.length;m++){var y=v[m],x=s.getObjectByProperty("uuid",y.object);x!==void 0&&s.addLevel(x,y.distance)}return s}}()});var s0={UVMapping:ku,CubeReflectionMapping:Xu,CubeRefractionMapping:Yu,EquirectangularReflectionMapping:gc,EquirectangularRefractionMapping:qu,SphericalReflectionMapping:yc,CubeUVReflectionMapping:ju,CubeUVRefractionMapping:Zu},nl={RepeatWrapping:zr,ClampToEdgeWrapping:Un,MirroredRepeatWrapping:Oi},rl={NearestFilter:Fn,NearestMipMapNearestFilter:Ju,NearestMipMapLinearFilter:Qu,LinearFilter:En,LinearMipMapNearestFilter:_c,LinearMipMapLinearFilter:Zs};function il(e,t,n,r,a){var s=(r-t)*.5,u=(a-n)*.5,f=e*e,h=e*f;return(2*n-2*r+s+u)*h+(-3*n+3*r-2*s-u)*f+s*e+n}function o0(e,t){var n=1-e;return n*n*t}function u0(e,t){return 2*(1-e)*e*t}function f0(e,t){return e*e*t}function hs(e,t,n,r){return o0(e,t)+u0(e,n)+f0(e,r)}function h0(e,t){var n=1-e;return n*n*n*t}function c0(e,t){var n=1-e;return 3*n*n*e*t}function l0(e,t){return 3*(1-e)*e*e*t}function p0(e,t){return e*e*e*t}function cs(e,t,n,r,a){return h0(e,t)+c0(e,n)+l0(e,r)+p0(e,a)}function vt(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(vt.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],n,r=this.getPoint(0),a,s=0;for(t.push(0),a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n=this.getLengths(),r=0,a=n.length,s;t?s=t:s=e*n[a-1];for(var u=0,f=a-1,h;u<=f;)if(r=Math.floor(u+(f-u)/2),h=n[r]-s,h<0)u=r+1;else if(h>0)f=r-1;else{f=r;break}if(r=f,n[r]===s)return r/(a-1);var l=n[r],p=n[r+1],d=p-l,v=(s-l)/d,m=(r+v)/(a-1);return m},getTangent:function(e){var t=1e-4,n=e-t,r=e+t;n<0&&(n=0),r>1&&(r=1);var a=this.getPoint(n),s=this.getPoint(r),u=s.clone().sub(a);return u.normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n=new I,r=[],a=[],s=[],u=new I,f=new Ve,h,l,p;for(h=0;h<=e;h++)l=h/e,r[h]=this.getTangentAt(l),r[h].normalize();a[0]=new I,s[0]=new I;var d=Number.MAX_VALUE,v=Math.abs(r[0].x),m=Math.abs(r[0].y),y=Math.abs(r[0].z);for(v<=d&&(d=v,n.set(1,0,0)),m<=d&&(d=m,n.set(0,1,0)),y<=d&&n.set(0,0,1),u.crossVectors(r[0],n).normalize(),a[0].crossVectors(r[0],u),s[0].crossVectors(r[0],a[0]),h=1;h<=e;h++)a[h]=a[h-1].clone(),s[h]=s[h-1].clone(),u.crossVectors(r[h-1],r[h]),u.length()>Number.EPSILON&&(u.normalize(),p=Math.acos(Ke.clamp(r[h-1].dot(r[h]),-1,1)),a[h].applyMatrix4(f.makeRotationAxis(u,p))),s[h].crossVectors(r[h],a[h]);if(t===!0)for(p=Math.acos(Ke.clamp(a[0].dot(a[e]),-1,1)),p/=e,r[0].dot(u.crossVectors(a[0],a[e]))>0&&(p=-p),h=1;h<=e;h++)a[h].applyMatrix4(f.makeRotationAxis(r[h],p*h)),s[h].crossVectors(r[h],a[h]);return{tangents:r,normals:a,binormals:s}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});function lr(e,t){vt.call(this),this.type="LineCurve",this.v1=e||new me,this.v2=t||new me}lr.prototype=Object.create(vt.prototype),lr.prototype.constructor=lr,lr.prototype.isLineCurve=!0,lr.prototype.getPoint=function(e,t){var n=t||new me;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},lr.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},lr.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()},lr.prototype.copy=function(e){return vt.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this};function na(){vt.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}na.prototype=Object.assign(Object.create(vt.prototype),{constructor:na,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new lr(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var a=n[r]-t,s=this.curves[r],u=s.getLength(),f=u===0?0:1-a/u;return s.getPointAt(f)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t=[],n,r=0,a=this.curves;r<a.length;r++)for(var s=a[r],u=s&&s.isEllipseCurve?e*2:s&&s.isLineCurve?1:s&&s.isSplineCurve?e*s.points.length:e,f=s.getPoints(u),h=0;h<f.length;h++){var l=f[h];n&&n.equals(l)||(t.push(l),n=l)}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){vt.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}});function Sr(e,t,n,r,a,s,u,f){vt.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=a||0,this.aEndAngle=s||2*Math.PI,this.aClockwise=u||!1,this.aRotation=f||0}Sr.prototype=Object.create(vt.prototype),Sr.prototype.constructor=Sr,Sr.prototype.isEllipseCurve=!0,Sr.prototype.getPoint=function(e,t){for(var n=t||new me,r=Math.PI*2,a=this.aEndAngle-this.aStartAngle,s=Math.abs(a)<Number.EPSILON;a<0;)a+=r;for(;a>r;)a-=r;a<Number.EPSILON&&(s?a=0:a=r),this.aClockwise===!0&&!s&&(a===r?a=-r:a=a-r);var u=this.aStartAngle+e*a,f=this.aX+this.xRadius*Math.cos(u),h=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){var l=Math.cos(this.aRotation),p=Math.sin(this.aRotation),d=f-this.aX,v=h-this.aY;f=d*l-v*p+this.aX,h=d*p+v*l+this.aY}return n.set(f,h)},Sr.prototype.copy=function(e){return vt.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};function di(e){vt.call(this),this.type="SplineCurve",this.points=e||[]}di.prototype=Object.create(vt.prototype),di.prototype.constructor=di,di.prototype.isSplineCurve=!0,di.prototype.getPoint=function(e,t){var n=t||new me,r=this.points,a=(r.length-1)*e,s=Math.floor(a),u=a-s,f=r[s===0?s:s-1],h=r[s],l=r[s>r.length-2?r.length-1:s+1],p=r[s>r.length-3?r.length-1:s+2];return n.set(il(u,f.x,h.x,l.x,p.x),il(u,f.y,h.y,l.y,p.y)),n},di.prototype.copy=function(e){vt.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this};function vi(e,t,n,r){vt.call(this),this.type="CubicBezierCurve",this.v0=e||new me,this.v1=t||new me,this.v2=n||new me,this.v3=r||new me}vi.prototype=Object.create(vt.prototype),vi.prototype.constructor=vi,vi.prototype.isCubicBezierCurve=!0,vi.prototype.getPoint=function(e,t){var n=t||new me,r=this.v0,a=this.v1,s=this.v2,u=this.v3;return n.set(cs(e,r.x,a.x,s.x,u.x),cs(e,r.y,a.y,s.y,u.y)),n},vi.prototype.copy=function(e){return vt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this};function mi(e,t,n){vt.call(this),this.type="QuadraticBezierCurve",this.v0=e||new me,this.v1=t||new me,this.v2=n||new me}mi.prototype=Object.create(vt.prototype),mi.prototype.constructor=mi,mi.prototype.isQuadraticBezierCurve=!0,mi.prototype.getPoint=function(e,t){var n=t||new me,r=this.v0,a=this.v1,s=this.v2;return n.set(hs(e,r.x,a.x,s.x),hs(e,r.y,a.y,s.y)),n},mi.prototype.copy=function(e){return vt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this};var Bf=Object.assign(Object.create(na.prototype),{setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new lr(this.currentPoint.clone(),new me(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){var a=new mi(this.currentPoint.clone(),new me(e,t),new me(n,r));this.curves.push(a),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,a,s){var u=new vi(this.currentPoint.clone(),new me(e,t),new me(n,r),new me(a,s));this.curves.push(u),this.currentPoint.set(a,s)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e),n=new di(t);this.curves.push(n),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,a,s){var u=this.currentPoint.x,f=this.currentPoint.y;this.absarc(e+u,t+f,n,r,a,s)},absarc:function(e,t,n,r,a,s){this.absellipse(e,t,n,n,r,a,s)},ellipse:function(e,t,n,r,a,s,u,f){var h=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(e+h,t+l,n,r,a,s,u,f)},absellipse:function(e,t,n,r,a,s,u,f){var h=new Sr(e,t,n,r,a,s,u,f);if(this.curves.length>0){var l=h.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(h);var p=h.getPoint(1);this.currentPoint.copy(p)},copy:function(e){return na.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this}});function ra(e){na.call(this),this.type="Path",this.currentPoint=new me,e&&this.setFromPoints(e)}ra.prototype=Bf,Bf.constructor=ra;function ia(e){ra.call(this,e),this.type="Shape",this.holes=[]}ia.prototype=Object.assign(Object.create(Bf),{constructor:ia,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){ra.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this}});function al(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}Object.assign(al.prototype,{moveTo:function(e,t){this.currentPath=new ra,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,a,s){this.currentPath.bezierCurveTo(e,t,n,r,a,s)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(ee){for(var K=[],te=0,$=ee.length;te<$;te++){var ue=ee[te],he=new ia;he.curves=ue.curves,K.push(he)}return K}function r(ee,K){for(var te=K.length,$=!1,ue=te-1,he=0;he<te;ue=he++){var oe=K[ue],ve=K[he],pe=ve.x-oe.x,Ae=ve.y-oe.y;if(Math.abs(Ae)>Number.EPSILON){if(Ae<0&&(oe=K[he],pe=-pe,ve=K[ue],Ae=-Ae),ee.y<oe.y||ee.y>ve.y)continue;if(ee.y===oe.y){if(ee.x===oe.x)return!0}else{var Z=Ae*(ee.x-oe.x)-pe*(ee.y-oe.y);if(Z===0)return!0;if(Z<0)continue;$=!$}}else{if(ee.y!==oe.y)continue;if(ve.x<=ee.x&&ee.x<=oe.x||oe.x<=ee.x&&ee.x<=ve.x)return!0}}return $}var a=hr.isClockWise,s=this.subPaths;if(s.length===0)return[];if(t===!0)return n(s);var u,f,h,l=[];if(s.length===1)return f=s[0],h=new ia,h.curves=f.curves,l.push(h),l;var p=!a(s[0].getPoints());p=e?!p:p;var d=[],v=[],m=[],y=0,x;v[y]=void 0,m[y]=[];for(var b=0,w=s.length;b<w;b++)f=s[b],x=f.getPoints(),u=a(x),u=e?!u:u,u?(!p&&v[y]&&y++,v[y]={s:new ia,p:x},v[y].s.curves=f.curves,p&&y++,m[y]=[]):m[y].push({h:f,p:x[0]});if(!v[0])return n(s);if(v.length>1){for(var E=!1,T=[],M=0,P=v.length;M<P;M++)d[M]=[];for(var M=0,P=v.length;M<P;M++)for(var O=m[M],U=0;U<O.length;U++){for(var W=O[U],B=!0,V=0;V<v.length;V++)r(W.p,v[V].p)&&(M!==V&&T.push({froms:M,tos:V,hole:U}),B?(B=!1,d[V].push(W)):E=!0);B&&d[M].push(W)}T.length>0&&(E||(m=d))}for(var X,b=0,re=v.length;b<re;b++){h=v[b].s,l.push(h),X=m[b];for(var z=0,D=X.length;z<D;z++)h.holes.push(X[z].h)}return l}});function sl(e){this.type="Font",this.data=e}Object.assign(sl.prototype,{isFont:!0,generateShapes:function(e,t,n){function r(p){for(var d=String(p).split(""),v=t/s.resolution,m=(s.boundingBox.yMax-s.boundingBox.yMin+s.underlineThickness)*v,y=0,x=0,b=[],w=0;w<d.length;w++){var E=d[w];if(E===`
`)y=0,x-=m;else{var T=a(E,v,y,x);y+=T.offsetX,b.push(T.path)}}return b}function a(p,d,v,m){var y=s.glyphs[p]||s.glyphs["?"];if(y){var x=new al,b=[],w,E,T,M,P,O,U,W,B;if(y.o)for(var V=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),X=0,re=V.length;X<re;){var z=V[X++];switch(z){case"m":w=V[X++]*d+v,E=V[X++]*d+m,x.moveTo(w,E);break;case"l":w=V[X++]*d+v,E=V[X++]*d+m,x.lineTo(w,E);break;case"q":T=V[X++]*d+v,M=V[X++]*d+m,P=V[X++]*d+v,O=V[X++]*d+m,x.quadraticCurveTo(P,O,T,M),B=b[b.length-1],B&&(B.x,B.y);break;case"b":T=V[X++]*d+v,M=V[X++]*d+m,P=V[X++]*d+v,O=V[X++]*d+m,U=V[X++]*d+v,W=V[X++]*d+m,x.bezierCurveTo(P,O,U,W,T,M),B=b[b.length-1],B&&(B.x,B.y);break}}return{offsetX:y.ha*d,path:x}}}t===void 0&&(t=100);for(var s=this.data,u=r(e),f=[],h=0,l=u.length;h<l;h++)Array.prototype.push.apply(f,u[h].toShapes());return f}});function d0(e){this.manager=e!==void 0?e:Bn}Object.assign(d0.prototype,{load:function(e,t,n,r){var a=this,s=new Mr(this.manager);s.setPath(this.path),s.load(e,function(u){var f;try{f=JSON.parse(u)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),f=JSON.parse(u.substring(65,u.length-2))}var h=a.parse(f);t&&t(h)},n,r)},parse:function(e){return new sl(e)},setPath:function(e){return this.path=e,this}});var Io,ol={getContext:function(){return Io===void 0&&(Io=new(window.AudioContext||window.webkitAudioContext)),Io},setContext:function(e){Io=e}};function ul(e){this.manager=e!==void 0?e:Bn}Object.assign(ul.prototype,{load:function(e,t,n,r){var a=new Mr(this.manager);a.setResponseType("arraybuffer"),a.load(e,function(s){var u=ol.getContext();u.decodeAudioData(s,function(f){t(f)})},n,r)}});function v0(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Zt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Zt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}Object.assign(v0.prototype,{update:function(){var e,t,n,r,a,s,u,f,h=new Ve,l=new Ve;return function(d){var v=e!==this||t!==d.focus||n!==d.fov||r!==d.aspect*this.aspect||a!==d.near||s!==d.far||u!==d.zoom||f!==this.eyeSep;if(v){e=this,t=d.focus,n=d.fov,r=d.aspect*this.aspect,a=d.near,s=d.far,u=d.zoom;var m=d.projectionMatrix.clone();f=this.eyeSep/2;var y=f*a/t,x=a*Math.tan(Ke.DEG2RAD*n*.5)/u,b,w;l.elements[12]=-f,h.elements[12]=f,b=-x*r+y,w=x*r+y,m.elements[0]=2*a/(w-b),m.elements[8]=(w+b)/(w-b),this.cameraL.projectionMatrix.copy(m),b=-x*r-y,w=x*r-y,m.elements[0]=2*a/(w-b),m.elements[8]=(w+b)/(w-b),this.cameraR.projectionMatrix.copy(m)}this.cameraL.matrixWorld.copy(d.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(d.matrixWorld).multiply(h)}}()});function Do(e,t,n){we.call(this),this.type="CubeCamera";var r=90,a=1,s=new Zt(r,a,e,t);s.up.set(0,-1,0),s.lookAt(new I(1,0,0)),this.add(s);var u=new Zt(r,a,e,t);u.up.set(0,-1,0),u.lookAt(new I(-1,0,0)),this.add(u);var f=new Zt(r,a,e,t);f.up.set(0,0,1),f.lookAt(new I(0,1,0)),this.add(f);var h=new Zt(r,a,e,t);h.up.set(0,0,-1),h.lookAt(new I(0,-1,0)),this.add(h);var l=new Zt(r,a,e,t);l.up.set(0,-1,0),l.lookAt(new I(0,0,1)),this.add(l);var p=new Zt(r,a,e,t);p.up.set(0,-1,0),p.lookAt(new I(0,0,-1)),this.add(p);var d={format:Ua,magFilter:En,minFilter:En};this.renderTarget=new Ba(n,n,d),this.renderTarget.texture.name="CubeCamera",this.update=function(v,m){this.parent===null&&this.updateMatrixWorld();var y=this.renderTarget,x=y.texture.generateMipmaps;y.texture.generateMipmaps=!1,y.activeCubeFace=0,v.render(m,s,y),y.activeCubeFace=1,v.render(m,u,y),y.activeCubeFace=2,v.render(m,f,y),y.activeCubeFace=3,v.render(m,h,y),y.activeCubeFace=4,v.render(m,l,y),y.texture.generateMipmaps=x,y.activeCubeFace=5,v.render(m,p,y),v.setRenderTarget(null)},this.clear=function(v,m,y,x){for(var b=this.renderTarget,w=0;w<6;w++)b.activeCubeFace=w,v.setRenderTarget(b),v.clear(m,y,x);v.setRenderTarget(null)}}Do.prototype=Object.create(we.prototype),Do.prototype.constructor=Do;function fl(){we.call(this),this.type="AudioListener",this.context=ol.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}fl.prototype=Object.assign(Object.create(we.prototype),{constructor:fl,getInput:function(){return this.gain},removeFilter:function(){this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new I,t=new qt,n=new I,r=new I;return function(s){we.prototype.updateMatrixWorld.call(this,s);var u=this.context.listener,f=this.up;this.matrixWorld.decompose(e,t,n),r.set(0,0,-1).applyQuaternion(t),u.positionX?(u.positionX.setValueAtTime(e.x,this.context.currentTime),u.positionY.setValueAtTime(e.y,this.context.currentTime),u.positionZ.setValueAtTime(e.z,this.context.currentTime),u.forwardX.setValueAtTime(r.x,this.context.currentTime),u.forwardY.setValueAtTime(r.y,this.context.currentTime),u.forwardZ.setValueAtTime(r.z,this.context.currentTime),u.upX.setValueAtTime(f.x,this.context.currentTime),u.upY.setValueAtTime(f.y,this.context.currentTime),u.upZ.setValueAtTime(f.z,this.context.currentTime)):(u.setPosition(e.x,e.y,e.z),u.setOrientation(r.x,r.y,r.z,f.x,f.y,f.z))}}()});function ls(e){we.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}ls.prototype=Object.assign(Object.create(we.prototype),{constructor:ls,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()},pause:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.source.stop(),this.offset=0,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}});function hl(e){ls.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}hl.prototype=Object.assign(Object.create(ls.prototype),{constructor:hl,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new I;return function(n){we.prototype.updateMatrixWorld.call(this,n),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()});function cl(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t!==void 0?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}Object.assign(cl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}});function ll(e,t,n){this.binding=e,this.valueSize=n;var r=Float64Array,a;switch(t){case"quaternion":a=this._slerp;break;case"string":case"bool":r=Array,a=this._select;break;default:a=this._lerp}this.buffer=new r(n*4),this._mixBufferRegion=a,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(ll.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,a=e*r+r,s=this.cumulativeWeight;if(s===0){for(var u=0;u!==r;++u)n[a+u]=n[u];s=t}else{s+=t;var f=t/s;this._mixBufferRegion(n,a,0,f,r)}this.cumulativeWeight=s},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,a=this.cumulativeWeight,s=this.binding;if(this.cumulativeWeight=0,a<1){var u=t*3;this._mixBufferRegion(n,r,u,1-a,t)}for(var f=t,h=t+t;f!==h;++f)if(n[f]!==n[f+t]){s.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*3;e.getValue(t,r);for(var a=n,s=r;a!==s;++a)t[a]=t[r+a%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,a){if(r>=.5)for(var s=0;s!==a;++s)e[t+s]=e[n+s]},_slerp:function(e,t,n,r){qt.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,a){for(var s=1-r,u=0;u!==a;++u){var f=t+u;e[f]=e[f]*s+e[n+u]*r}}});function pl(e,t,n){var r=n||cn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}Object.assign(pl.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}});function cn(e,t,n){this.path=t,this.parsedPath=n||cn.parseTrackName(t),this.node=cn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(cn,{Composite:pl,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new cn.Composite(e,t,n):new cn(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:function(){var e=/((?:[\w-]+[\/:])*)/,t=/([\w-\.]+)?/,n=/(?:\.([\w-]+)(?:\[(.+)\])?)?/,r=/\.([\w-]+)(?:\[(.+)\])?/,a=new RegExp("^"+e.source+t.source+n.source+r.source+"$"),s=["material","materials","bones"];return function(u){var f=a.exec(u);if(!f)throw new Error("PropertyBinding: Cannot parse trackName: "+u);var h={nodeName:f[2],objectName:f[3],objectIndex:f[4],propertyName:f[5],propertyIndex:f[6]},l=h.nodeName&&h.nodeName.lastIndexOf(".");if(l!==void 0&&l!==-1){var p=h.nodeName.substring(l+1);s.indexOf(p)!==-1&&(h.nodeName=h.nodeName.substring(0,l),h.objectName=p)}if(h.propertyName===null||h.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+u);return h}}(),findNode:function(e,t){if(!t||t===""||t==="root"||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=function(u){for(var f=0;f<u.bones.length;f++){var h=u.bones[f];if(h.name===t)return h}return null},r=n(e.skeleton);if(r)return r}if(e.children){var a=function(u){for(var f=0;f<u.length;f++){var h=u[f];if(h.name===t||h.uuid===t)return h;var l=a(h.children);if(l)return l}return null},s=a(e.children);if(s)return s}return null}}),Object.assign(cn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,n){t[n]=this.node[this.propertyName]},function(t,n){for(var r=this.resolvedProperty,a=0,s=r.length;a!==s;++a)t[n++]=r[a]},function(t,n){t[n]=this.resolvedProperty[this.propertyIndex]},function(t,n){this.resolvedProperty.toArray(t,n)}],SetterByBindingTypeAndVersioning:[[function(t,n){this.targetObject[this.propertyName]=t[n]},function(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0},function(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){for(var r=this.resolvedProperty,a=0,s=r.length;a!==s;++a)r[a]=t[n++]},function(t,n){for(var r=this.resolvedProperty,a=0,s=r.length;a!==s;++a)r[a]=t[n++];this.targetObject.needsUpdate=!0},function(t,n){for(var r=this.resolvedProperty,a=0,s=r.length;a!==s;++a)r[a]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){this.resolvedProperty[this.propertyIndex]=t[n]},function(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0},function(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){this.resolvedProperty.fromArray(t,n)},function(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0},function(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,n){this.bind(),this.getValue(t,n)},setValue:function(t,n){this.bind(),this.setValue(t,n)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,a=t.propertyIndex;if(e||(e=cn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){var s=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var u=0;u<e.length;u++)if(e[u].name===s){s=u;break}break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(s!==void 0){if(e[s]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[s]}}var f=e[r];if(f===void 0){var h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e);return}var l=this.Versioning.None;e.needsUpdate!==void 0?(l=this.Versioning.NeedsUpdate,this.targetObject=e):e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var p=this.BindingType.Direct;if(a!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(var u=0;u<this.node.geometry.morphAttributes.position.length;u++)if(e.geometry.morphAttributes.position[u].name===a){a=u;break}}else{if(!e.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(var u=0;u<this.node.geometry.morphTargets.length;u++)if(e.geometry.morphTargets[u].name===a){a=u;break}}}p=this.BindingType.ArrayElement,this.resolvedProperty=f,this.propertyIndex=a}else f.fromArray!==void 0&&f.toArray!==void 0?(p=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(p=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=r;this.getValue=this.GetterByBindingType[p],this.setValue=this.SetterByBindingTypeAndVersioning[p][l]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(cn.prototype,{_getValue_unbound:cn.prototype.getValue,_setValue_unbound:cn.prototype.setValue});function m0(){this.uuid=Ke.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}Object.assign(m0.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,a=this._paths,s=this._parsedPaths,u=this._bindings,f=u.length,h=0,l=arguments.length;h!==l;++h){var p=arguments[h],d=p.uuid,v=r[d],m=void 0;if(v===void 0){v=t++,r[d]=v,e.push(p);for(var y=0,x=f;y!==x;++y)u[y].push(new cn(p,a[y],s[y]))}else if(v<n){m=e[v];var b=--n,w=e[b];r[w.uuid]=v,e[v]=w,r[d]=b,e[b]=p;for(var y=0,x=f;y!==x;++y){var E=u[y],T=E[b],M=E[v];E[v]=T,M===void 0&&(M=new cn(p,a[y],s[y])),E[b]=M}}else e[v]!==m&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,a=r.length,s=0,u=arguments.length;s!==u;++s){var f=arguments[s],h=f.uuid,l=n[h];if(l!==void 0&&l>=t){var p=t++,d=e[p];n[d.uuid]=l,e[l]=d,n[h]=p,e[p]=f;for(var v=0,m=a;v!==m;++v){var y=r[v],x=y[p],b=y[l];y[l]=x,y[p]=b}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,a=this._bindings,s=a.length,u=0,f=arguments.length;u!==f;++u){var h=arguments[u],l=h.uuid,p=r[l];if(p!==void 0)if(delete r[l],p<n){var d=--n,v=e[d],m=--t,y=e[m];r[v.uuid]=p,e[p]=v,r[y.uuid]=d,e[d]=y,e.pop();for(var x=0,b=s;x!==b;++x){var w=a[x],E=w[d],T=w[m];w[p]=E,w[d]=T,w.pop()}}else{var m=--t,y=e[m];r[y.uuid]=p,e[p]=y,e.pop();for(var x=0,b=s;x!==b;++x){var w=a[x];w[p]=w[m],w.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],a=this._bindings;if(r!==void 0)return a[r];var s=this._paths,u=this._parsedPaths,f=this._objects,h=f.length,l=this.nCachedObjects_,p=new Array(h);r=a.length,n[e]=r,s.push(e),u.push(t),a.push(p);for(var d=l,v=f.length;d!==v;++d){var m=f[d];p[d]=new cn(m,e,t)}return p},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){var r=this._paths,a=this._parsedPaths,s=this._bindings,u=s.length-1,f=s[u],h=e[u];t[h]=n,s[n]=f,s.pop(),a[n]=a[u],a.pop(),r[n]=r[u],r.pop()}}});function dl(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,a=r.length,s=new Array(a),u={endingStart:Fi,endingEnd:Fi},f=0;f!==a;++f){var h=r[f].createInterpolant(null);s[f]=h,h.settings=u}this._interpolantSettings=u,this._interpolants=s,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Dv,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(dl.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,a=e._clip.duration,s=a/r,u=r/a;e.warp(1,s,t),this.warp(u,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,a=r.time,s=this._timeScaleInterpolant,u=this.timeScale;s===null&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);var f=s.parameterPositions,h=s.sampleValues;return f[0]=a,f[1]=a+n,h[0]=e/u,h[1]=t/u,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}var a=this._startTime;if(a!==null){var s=(e-a)*n;if(s<0||n===0)return;this._startTime=null,t=n*s}t*=this._updateTimeScale(e);var u=this._updateTime(t),f=this._updateWeight(e);if(f>0)for(var h=this._interpolants,l=this._propertyBindings,p=0,d=h.length;p!==d;++p)h[p].evaluate(u),l[p].accumulate(r,f)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(n!==null){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(n!==null){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e;if(e===0)return t;var n=this._clip.duration,r=this.loop,a=this._loopCount;if(r===Iv){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else if(t<0)t=0;else break e;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var s=r===Ov;if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),t>=n||t<0){var u=Math.floor(t/n);t-=n*u,a+=Math.abs(u);var f=this.repetitions-a;if(f<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===0){var h=e<0;this._setEndings(h,!h,s)}else this._setEndings(!1,!1,s);this._loopCount=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}if(s&&(a&1)===1)return this.time=t,n-t}return this.time=t,t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=Ni,r.endingEnd=Ni):(e?r.endingStart=this.zeroSlopeAtStart?Ni:Fi:r.endingStart=eo,t?r.endingEnd=this.zeroSlopeAtEnd?Ni:Fi:r.endingEnd=eo)},_scheduleFading:function(e,t,n){var r=this._mixer,a=r.time,s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);var u=s.parameterPositions,f=s.sampleValues;return u[0]=a,f[0]=t,u[1]=a+e,f[1]=n,this}});function g0(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Object.assign(g0.prototype,Br.prototype,{_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,a=r.length,s=e._propertyBindings,u=e._interpolants,f=n.uuid,h=this._bindingsByRootAndName,l=h[f];l===void 0&&(l={},h[f]=l);for(var p=0;p!==a;++p){var d=r[p],v=d.name,m=l[v];if(m!==void 0)s[p]=m;else{if(m=s[p],m!==void 0){m._cacheIndex===null&&(++m.referenceCount,this._addInactiveBinding(m,f,v));continue}var y=t&&t._propertyBindings[p].binding.parsedPath;m=new ll(cn.create(n,v,y),d.ValueTypeName,d.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,f,v),s[p]=m}u[p].resultBuffer=m.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var a=e._propertyBindings,s=0,u=a.length;s!==u;++s){var f=a[s];f.useCount++===0&&(this._lendBinding(f),f.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var a=t[n];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return t!==null&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,a=this._actionsByClip,s=a[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=s;else{var u=s.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=r.length,r.push(e),s.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var a=e._clip.uuid,s=this._actionsByClip,u=s[a],f=u.knownActions,h=f[f.length-1],l=e._byClipCacheIndex;h._byClipCacheIndex=l,f[l]=h,f.pop(),e._byClipCacheIndex=null;var p=u.actionByRoot,d=(e._localRoot||this._root).uuid;delete p[d],f.length===0&&delete s[a],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var a=t[n];--a.referenceCount===0&&this._removeInactiveBinding(a)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,a=r[t],s=this._bindings;a===void 0&&(a={},r[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,a=n.path,s=this._bindingsByRootAndName,u=s[r],f=t[t.length-1],h=e._cacheIndex;f._cacheIndex=h,t[h]=f,t.pop(),delete u[a];e:{for(var l in u)break e;delete s[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return n===void 0&&(n=new Co(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,a=t[r];e.__cacheIndex=r,t[r]=e,a.__cacheIndex=n,t[n]=a},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,a=typeof e=="string"?tr.findByName(n,e):e,s=a!==null?a.uuid:e,u=this._actionsByClip[s],f=null;if(u!==void 0){var h=u.actionByRoot[r];if(h!==void 0)return h;f=u.knownActions[0],a===null&&(a=f._clip)}if(a===null)return null;var l=new dl(this,a,t);return this._bindAction(l,f),this._addInactiveAction(l,s,r),l},existingAction:function(e,t){var n=t||this._root,r=n.uuid,a=typeof e=="string"?tr.findByName(n,e):e,s=a?a.uuid:e,u=this._actionsByClip[s];return u!==void 0&&u.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var a=0;a!==t;++a)e[a].reset();for(var a=0;a!==r;++a)n[a].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,a=Math.sign(e),s=this._accuIndex^=1,u=0;u!==n;++u){var f=t[u];f._update(r,e,a,s)}for(var h=this._bindings,l=this._nActiveBindings,u=0;u!==l;++u)h[u].apply(s);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,a=r[n];if(a!==void 0){for(var s=a.knownActions,u=0,f=s.length;u!==f;++u){var h=s[u];this._deactivateAction(h);var l=h._cacheIndex,p=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,p._cacheIndex=l,t[l]=p,t.pop(),this._removeInactiveBindingsForAction(h)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var a=n[r].actionByRoot,s=a[t];s!==void 0&&(this._deactivateAction(s),this._removeInactiveAction(s))}var u=this._bindingsByRootAndName,f=u[t];if(f!==void 0)for(var h in f){var l=f[h];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}});function zf(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}zf.prototype.clone=function(){return new zf(this.value.clone===void 0?this.value:this.value.clone())};function vl(){Re.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}vl.prototype=Object.assign(Object.create(Re.prototype),{constructor:vl,isInstancedBufferGeometry:!0,copy:function(e){return Re.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)}});function ml(e,t,n,r){this.uuid=Ke.generateUUID(),this.data=e,this.itemSize=t,this.offset=n,this.normalized=r===!0}Object.defineProperties(ml.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(ml.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,a){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=a,this}});function ps(e,t){this.uuid=Ke.generateUUID(),this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}Object.defineProperty(ps.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(ps.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=e!==void 0?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,a=this.stride;r<a;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});function gl(e,t,n){ps.call(this,e,t),this.meshPerAttribute=n||1}gl.prototype=Object.assign(Object.create(ps.prototype),{constructor:gl,isInstancedInterleavedBuffer:!0,copy:function(e){return ps.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}});function yl(e,t,n){nt.call(this,e,t),this.meshPerAttribute=n||1}yl.prototype=Object.assign(Object.create(nt.prototype),{constructor:yl,isInstancedBufferAttribute:!0,copy:function(e){return nt.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}});function _l(e,t,n,r){this.ray=new Wi(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function xl(e,t){return e.distance-t.distance}function Gf(e,t,n,r){if(e.visible!==!1&&(e.raycast(t,n),r===!0))for(var a=e.children,s=0,u=a.length;s<u;s++)Gf(a[s],t,n,!0)}Object.assign(_l.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var n=[];return Gf(e,this,n,t),n.sort(xl),n},intersectObjects:function(e,t){var n=[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,a=e.length;r<a;r++)Gf(e[r],this,n,t);return n.sort(xl),n}});function y0(e){this.autoStart=e!==void 0?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(y0.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=(typeof performance>"u"?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});function _0(e,t,n){return this.radius=e!==void 0?e:1,this.phi=t!==void 0?t:0,this.theta=n!==void 0?n:0,this}Object.assign(_0.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Ke.clamp(e.y/this.radius,-1,1))),this}});function x0(e,t,n){return this.radius=e!==void 0?e:1,this.theta=t!==void 0?t:0,this.y=n!==void 0?n:0,this}Object.assign(x0.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}});function Oo(e){we.call(this),this.material=e,this.render=function(){}}Oo.prototype=Object.create(we.prototype),Oo.prototype.constructor=Oo,Oo.prototype.isImmediateRenderObject=!0;function Uo(e,t,n,r){this.object=e,this.size=t!==void 0?t:1;var a=n!==void 0?n:16711680,s=r!==void 0?r:1,u=0,f=this.object.geometry;f&&f.isGeometry?u=f.faces.length*3:f&&f.isBufferGeometry&&(u=f.attributes.normal.count);var h=new Re,l=new _e(u*2*3,3);h.addAttribute("position",l),Ft.call(this,h,new It({color:a,linewidth:s})),this.matrixAutoUpdate=!1,this.update()}Uo.prototype=Object.create(Ft.prototype),Uo.prototype.constructor=Uo,Uo.prototype.update=function(){var e=new I,t=new I,n=new Mn;return function(){var a=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var s=this.object.matrixWorld,u=this.geometry.attributes.position,f=this.object.geometry;if(f&&f.isGeometry)for(var h=f.vertices,l=f.faces,p=0,d=0,v=l.length;d<v;d++)for(var m=l[d],y=0,x=m.vertexNormals.length;y<x;y++){var b=h[m[a[y]]],w=m.vertexNormals[y];e.copy(b).applyMatrix4(s),t.copy(w).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),u.setXYZ(p,e.x,e.y,e.z),p=p+1,u.setXYZ(p,t.x,t.y,t.z),p=p+1}else if(f&&f.isBufferGeometry)for(var E=f.attributes.position,T=f.attributes.normal,p=0,y=0,x=E.count;y<x;y++)e.set(E.getX(y),E.getY(y),E.getZ(y)).applyMatrix4(s),t.set(T.getX(y),T.getY(y),T.getZ(y)),t.applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),u.setXYZ(p,e.x,e.y,e.z),p=p+1,u.setXYZ(p,t.x,t.y,t.z),p=p+1;u.needsUpdate=!0}}();function ds(e,t){we.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Re,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],a=0,s=1,u=32;a<u;a++,s++){var f=a/u*Math.PI*2,h=s/u*Math.PI*2;r.push(Math.cos(f),Math.sin(f),1,Math.cos(h),Math.sin(h),1)}n.addAttribute("position",new _e(r,3));var l=new It({fog:!1});this.cone=new Ft(n,l),this.add(this.cone),this.update()}ds.prototype=Object.create(we.prototype),ds.prototype.constructor=ds,ds.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ds.prototype.update=function(){var e=new I,t=new I;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,a=r*Math.tan(this.light.angle);this.cone.scale.set(a,a,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();function wl(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,wl(e.children[n]));return t}function vs(e){for(var t=wl(e),n=new Re,r=[],a=[],s=new Ue(0,0,1),u=new Ue(0,1,0),f=0;f<t.length;f++){var h=t[f];h.parent&&h.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),a.push(s.r,s.g,s.b),a.push(u.r,u.g,u.b))}n.addAttribute("position",new _e(r,3)),n.addAttribute("color",new _e(a,3));var l=new It({vertexColors:Di,depthTest:!1,depthWrite:!1,transparent:!0});Ft.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}vs.prototype=Object.create(Ft.prototype),vs.prototype.constructor=vs,vs.prototype.updateMatrixWorld=function(){var e=new I,t=new Ve,n=new Ve;return function(a){var s=this.bones,u=this.geometry,f=u.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var h=0,l=0;h<s.length;h++){var p=s[h];p.parent&&p.parent.isBone&&(t.multiplyMatrices(n,p.matrixWorld),e.setFromMatrixPosition(t),f.setXYZ(l,e.x,e.y,e.z),t.multiplyMatrices(n,p.parent.matrixWorld),e.setFromMatrixPosition(t),f.setXYZ(l+1,e.x,e.y,e.z),l+=2)}u.getAttribute("position").needsUpdate=!0,we.prototype.updateMatrixWorld.call(this,a)}}();function ms(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new qi(t,4,2),a=new vn({wireframe:!0,fog:!1});jt.call(this,r,a),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}ms.prototype=Object.create(jt.prototype),ms.prototype.constructor=ms,ms.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ms.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};function gs(e,t){we.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var n=new It({fog:!1}),r=new Re;r.addAttribute("position",new nt(new Float32Array(5*3),3)),this.line=new Sn(r,n),this.add(this.line),this.update()}gs.prototype=Object.create(we.prototype),gs.prototype.constructor=gs,gs.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},gs.prototype.update=function(){var e=this.light.width*.5,t=this.light.height*.5,n=this.line.geometry.attributes.position,r=n.array;r[0]=e,r[1]=-t,r[2]=0,r[3]=e,r[4]=t,r[5]=0,r[6]=-e,r[7]=t,r[8]=0,r[9]=-e,r[10]=-t,r[11]=0,r[12]=e,r[13]=-t,r[14]=0,n.needsUpdate=!0,this.color!==void 0?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)};function ys(e,t,n){we.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new ki(t);r.rotateY(Math.PI*.5),this.material=new vn({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=Di);var a=r.getAttribute("position"),s=new Float32Array(a.count*3);r.addAttribute("color",new nt(s,3)),this.add(new jt(r,this.material)),this.update()}ys.prototype=Object.create(we.prototype),ys.prototype.constructor=ys,ys.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ys.prototype.update=function(){var e=new I,t=new Ue,n=new Ue;return function(){var a=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var s=a.geometry.getAttribute("color");t.copy(this.light.color),n.copy(this.light.groundColor);for(var u=0,f=s.count;u<f;u++){var h=u<f/2?t:n;s.setXYZ(u,h.r,h.g,h.b)}s.needsUpdate=!0}a.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}();function Fo(e,t,n,r){e=e||10,t=t||10,n=new Ue(n!==void 0?n:4473924),r=new Ue(r!==void 0?r:8947848);for(var a=t/2,s=e/t,u=e/2,f=[],h=[],l=0,p=0,d=-u;l<=t;l++,d+=s){f.push(-u,0,d,u,0,d),f.push(d,0,-u,d,0,u);var v=l===a?n:r;v.toArray(h,p),p+=3,v.toArray(h,p),p+=3,v.toArray(h,p),p+=3,v.toArray(h,p),p+=3}var m=new Re;m.addAttribute("position",new _e(f,3)),m.addAttribute("color",new _e(h,3));var y=new It({vertexColors:Di});Ft.call(this,m,y)}Fo.prototype=Object.create(Ft.prototype),Fo.prototype.constructor=Fo;function Hf(e,t,n,r,a,s){e=e||10,t=t||16,n=n||8,r=r||64,a=new Ue(a!==void 0?a:4473924),s=new Ue(s!==void 0?s:8947848);var u=[],f=[],h,l,p,d,v,m,y;for(d=0;d<=t;d++)p=d/t*(Math.PI*2),h=Math.sin(p)*e,l=Math.cos(p)*e,u.push(0,0,0),u.push(h,0,l),y=d&1?a:s,f.push(y.r,y.g,y.b),f.push(y.r,y.g,y.b);for(d=0;d<=n;d++)for(y=d&1?a:s,m=e-e/n*d,v=0;v<r;v++)p=v/r*(Math.PI*2),h=Math.sin(p)*m,l=Math.cos(p)*m,u.push(h,0,l),f.push(y.r,y.g,y.b),p=(v+1)/r*(Math.PI*2),h=Math.sin(p)*m,l=Math.cos(p)*m,u.push(h,0,l),f.push(y.r,y.g,y.b);var x=new Re;x.addAttribute("position",new _e(u,3)),x.addAttribute("color",new _e(f,3));var b=new It({vertexColors:Di});Ft.call(this,x,b)}Hf.prototype=Object.create(Ft.prototype),Hf.prototype.constructor=Hf;function No(e,t,n,r){this.object=e,this.size=t!==void 0?t:1;var a=n!==void 0?n:16776960,s=r!==void 0?r:1,u=0,f=this.object.geometry;f&&f.isGeometry?u=f.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var h=new Re,l=new _e(u*2*3,3);h.addAttribute("position",l),Ft.call(this,h,new It({color:a,linewidth:s})),this.matrixAutoUpdate=!1,this.update()}No.prototype=Object.create(Ft.prototype),No.prototype.constructor=No,No.prototype.update=function(){var e=new I,t=new I,n=new Mn;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var a=this.object.matrixWorld,s=this.geometry.attributes.position,u=this.object.geometry,f=u.vertices,h=u.faces,l=0,p=0,d=h.length;p<d;p++){var v=h[p],m=v.normal;e.copy(f[v.a]).add(f[v.b]).add(f[v.c]).divideScalar(3).applyMatrix4(a),t.copy(m).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),s.setXYZ(l,e.x,e.y,e.z),l=l+1,s.setXYZ(l,t.x,t.y,t.z),l=l+1}s.needsUpdate=!0}}();function _s(e,t,n){we.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1);var r=new Re;r.addAttribute("position",new _e([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var a=new It({fog:!1});this.lightPlane=new Sn(r,a),this.add(this.lightPlane),r=new Re,r.addAttribute("position",new _e([0,0,0,0,0,1],3)),this.targetLine=new Sn(r,a),this.add(this.targetLine),this.update()}_s.prototype=Object.create(we.prototype),_s.prototype.constructor=_s,_s.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},_s.prototype.update=function(){var e=new I,t=new I,n=new I;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(n),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}();function Bo(e){var t=new Re,n=new It({color:16777215,vertexColors:oc}),r=[],a=[],s={},u=new Ue(16755200),f=new Ue(16711680),h=new Ue(43775),l=new Ue(16777215),p=new Ue(3355443);d("n1","n2",u),d("n2","n4",u),d("n4","n3",u),d("n3","n1",u),d("f1","f2",u),d("f2","f4",u),d("f4","f3",u),d("f3","f1",u),d("n1","f1",u),d("n2","f2",u),d("n3","f3",u),d("n4","f4",u),d("p","n1",f),d("p","n2",f),d("p","n3",f),d("p","n4",f),d("u1","u2",h),d("u2","u3",h),d("u3","u1",h),d("c","t",l),d("p","c",p),d("cn1","cn2",p),d("cn3","cn4",p),d("cf1","cf2",p),d("cf3","cf4",p);function d(m,y,x){v(m,x),v(y,x)}function v(m,y){r.push(0,0,0),a.push(y.r,y.g,y.b),s[m]===void 0&&(s[m]=[]),s[m].push(r.length/3-1)}t.addAttribute("position",new _e(r,3)),t.addAttribute("color",new _e(a,3)),Ft.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}Bo.prototype=Object.create(Ft.prototype),Bo.prototype.constructor=Bo,Bo.prototype.update=function(){var e,t,n=new I,r=new wr;function a(s,u,f,h){n.set(u,f,h).unproject(r);var l=t[s];if(l!==void 0)for(var p=e.getAttribute("position"),d=0,v=l.length;d<v;d++)p.setXYZ(l[d],n.x,n.y,n.z)}return function(){e=this.geometry,t=this.pointMap;var u=1,f=1;r.projectionMatrix.copy(this.camera.projectionMatrix),a("c",0,0,-1),a("t",0,0,1),a("n1",-u,-f,-1),a("n2",u,-f,-1),a("n3",-u,f,-1),a("n4",u,f,-1),a("f1",-u,-f,1),a("f2",u,-f,1),a("f3",-u,f,1),a("f4",u,f,1),a("u1",u*.7,f*1.1,-1),a("u2",-u*.7,f*1.1,-1),a("u3",0,f*2,-1),a("cf1",-u,0,1),a("cf2",u,0,1),a("cf3",0,-f,1),a("cf4",0,f,1),a("cn1",-u,0,-1),a("cn2",u,0,-1),a("cn3",0,-f,-1),a("cn4",0,f,-1),e.getAttribute("position").needsUpdate=!0}}();function xs(e,t){this.object=e,t===void 0&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),a=new Re;a.setIndex(new nt(n,1)),a.addAttribute("position",new nt(r,3)),Ft.call(this,a,new It({color:t})),this.matrixAutoUpdate=!1,this.update()}xs.prototype=Object.create(Ft.prototype),xs.prototype.constructor=xs,xs.prototype.update=function(){var e=new Hr;return function(n){if(n!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&e.setFromObject(this.object),!e.isEmpty()){var r=e.min,a=e.max,s=this.geometry.attributes.position,u=s.array;u[0]=a.x,u[1]=a.y,u[2]=a.z,u[3]=r.x,u[4]=a.y,u[5]=a.z,u[6]=r.x,u[7]=r.y,u[8]=a.z,u[9]=a.x,u[10]=r.y,u[11]=a.z,u[12]=a.x,u[13]=a.y,u[14]=r.z,u[15]=r.x,u[16]=a.y,u[17]=r.z,u[18]=r.x,u[19]=r.y,u[20]=r.z,u[21]=a.x,u[22]=r.y,u[23]=r.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),xs.prototype.setFromObject=function(e){return this.object=e,this.update(),this};function zo(e,t){this.type="Box3Helper",this.box=e;var n=t!==void 0?t:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Re;s.setIndex(new nt(r,1)),s.addAttribute("position",new _e(a,3)),Ft.call(this,s,new It({color:n})),this.geometry.computeBoundingSphere()}zo.prototype=Object.create(Ft.prototype),zo.prototype.constructor=zo,zo.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),we.prototype.updateMatrixWorld.call(this,e))};function Go(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=t===void 0?1:t;var r=n!==void 0?n:16776960,a=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],s=new Re;s.addAttribute("position",new _e(a,3)),s.computeBoundingSphere(),Sn.call(this,s,new It({color:r}));var u=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],f=new Re;f.addAttribute("position",new _e(u,3)),f.computeBoundingSphere(),this.add(new jt(f,new vn({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}Go.prototype=Object.create(Sn.prototype),Go.prototype.constructor=Go,Go.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.lookAt(this.plane.normal),we.prototype.updateMatrixWorld.call(this,e)};var Ho,Vf;function aa(e,t,n,r,a,s){we.call(this),r===void 0&&(r=16776960),n===void 0&&(n=1),a===void 0&&(a=.2*n),s===void 0&&(s=.2*a),Ho===void 0&&(Ho=new Re,Ho.addAttribute("position",new _e([0,0,0,0,1,0],3)),Vf=new Wr(0,.5,1,5,1),Vf.translate(0,-.5,0)),this.position.copy(t),this.line=new Sn(Ho,new It({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new jt(Vf,new vn({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,a,s)}aa.prototype=Object.create(we.prototype),aa.prototype.constructor=aa,aa.prototype.setDirection=function(){var e=new I,t;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(r.z,0,-r.x).normalize(),t=Math.acos(r.y),this.quaternion.setFromAxisAngle(e,t))}}(),aa.prototype.setLength=function(e,t,n){t===void 0&&(t=.2*e),n===void 0&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},aa.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)};function Wf(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Re;r.addAttribute("position",new _e(t,3)),r.addAttribute("color",new _e(n,3));var a=new It({vertexColors:Di});Ft.call(this,r,a)}Wf.prototype=Object.create(Ft.prototype),Wf.prototype.constructor=Wf;function kf(){var e=0,t=0,n=0,r=0;function a(s,u,f,h){e=s,t=f,n=-3*s+3*u-2*f-h,r=2*s-2*u+f+h}return{initCatmullRom:function(s,u,f,h,l){a(u,f,l*(f-s),l*(h-u))},initNonuniformCatmullRom:function(s,u,f,h,l,p,d){var v=(u-s)/l-(f-s)/(l+p)+(f-u)/p,m=(f-u)/p-(h-u)/(p+d)+(h-f)/d;v*=p,m*=p,a(u,f,v,m)},calc:function(s){var u=s*s,f=u*s;return e+t*s+n*u+r*f}}}var Vo=new I,Xf=new kf,Yf=new kf,qf=new kf;function pr(e,t,n,r){vt.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}pr.prototype=Object.create(vt.prototype),pr.prototype.constructor=pr,pr.prototype.isCatmullRomCurve3=!0,pr.prototype.getPoint=function(e,t){var n=t||new I,r=this.points,a=r.length,s=(a-(this.closed?0:1))*e,u=Math.floor(s),f=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/r.length)+1)*r.length:f===0&&u===a-1&&(u=a-2,f=1);var h,l,p,d;if(this.closed||u>0?h=r[(u-1)%a]:(Vo.subVectors(r[0],r[1]).add(r[0]),h=Vo),l=r[u%a],p=r[(u+1)%a],this.closed||u+2<a?d=r[(u+2)%a]:(Vo.subVectors(r[a-1],r[a-2]).add(r[a-1]),d=Vo),this.curveType==="centripetal"||this.curveType==="chordal"){var v=this.curveType==="chordal"?.5:.25,m=Math.pow(h.distanceToSquared(l),v),y=Math.pow(l.distanceToSquared(p),v),x=Math.pow(p.distanceToSquared(d),v);y<1e-4&&(y=1),m<1e-4&&(m=y),x<1e-4&&(x=y),Xf.initNonuniformCatmullRom(h.x,l.x,p.x,d.x,m,y,x),Yf.initNonuniformCatmullRom(h.y,l.y,p.y,d.y,m,y,x),qf.initNonuniformCatmullRom(h.z,l.z,p.z,d.z,m,y,x)}else this.curveType==="catmullrom"&&(Xf.initCatmullRom(h.x,l.x,p.x,d.x,this.tension),Yf.initCatmullRom(h.y,l.y,p.y,d.y,this.tension),qf.initCatmullRom(h.z,l.z,p.z,d.z,this.tension));return n.set(Xf.calc(f),Yf.calc(f),qf.calc(f)),n},pr.prototype.copy=function(e){vt.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};function gi(e,t,n,r){vt.call(this),this.type="CubicBezierCurve3",this.v0=e||new I,this.v1=t||new I,this.v2=n||new I,this.v3=r||new I}gi.prototype=Object.create(vt.prototype),gi.prototype.constructor=gi,gi.prototype.isCubicBezierCurve3=!0,gi.prototype.getPoint=function(e,t){var n=t||new I,r=this.v0,a=this.v1,s=this.v2,u=this.v3;return n.set(cs(e,r.x,a.x,s.x,u.x),cs(e,r.y,a.y,s.y,u.y),cs(e,r.z,a.z,s.z,u.z)),n},gi.prototype.copy=function(e){return vt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this};function sa(e,t,n){vt.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new I,this.v1=t||new I,this.v2=n||new I}sa.prototype=Object.create(vt.prototype),sa.prototype.constructor=sa,sa.prototype.isQuadraticBezierCurve3=!0,sa.prototype.getPoint=function(e,t){var n=t||new I,r=this.v0,a=this.v1,s=this.v2;return n.set(hs(e,r.x,a.x,s.x),hs(e,r.y,a.y,s.y),hs(e,r.z,a.z,s.z)),n},sa.prototype.copy=function(e){return vt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this};function yi(e,t){vt.call(this),this.type="LineCurve3",this.v1=e||new I,this.v2=t||new I}yi.prototype=Object.create(vt.prototype),yi.prototype.constructor=yi,yi.prototype.isLineCurve3=!0,yi.prototype.getPoint=function(e,t){var n=t||new I;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},yi.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},yi.prototype.copy=function(e){return vt.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this};function Wo(e,t,n,r,a,s){Sr.call(this,e,t,n,n,r,a,s),this.type="ArcCurve"}Wo.prototype=Object.create(Sr.prototype),Wo.prototype.constructor=Wo,Wo.prototype.isArcCurve=!0,vt.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(vt.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(na.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new We,n=0,r=e.length;n<r;n++){var a=e[n];t.vertices.push(new I(a.x,a.y,a.z||0))}return t}}),Object.assign(ra.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Object.create(pr.prototype),Object.create(pr.prototype);function bl(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),pr.call(this,e),this.type="catmullrom"}bl.prototype=Object.create(pr.prototype),Object.assign(bl.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Fo.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},vs.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(nf.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Hr.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Va.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Ke,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ke.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ke.ceilPowerOfTwo(e)}}),Object.assign(Mn.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ve.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return e===void 0&&(e=new I),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,a,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,a,s)}}),Kn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},qt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Wi.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(ia.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new li(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ns(this,e)}}),Object.assign(me.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(I.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(At.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),We.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(we.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(we.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(so.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(oo.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(vt.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Zt.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Ht.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(nt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Re.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Re.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(zf.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(at.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ue}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===sc}}}),Object.defineProperties(er.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties($n.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(vf.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(vf.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(kc.prototype,{cullFace:{get:function(){return this.renderReverseSided?ic:qs},set:function(e){var t=e!==qs;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(Na.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),ls.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this,n=new ul;return n.load(e,function(r){t.setBuffer(r)}),this},cl.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Do.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function w0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var El={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,n,r,a){var s=["","webkit","Moz","MS","ms","o"],u=n.createElement("div"),f="function",h=Math.round,l=Math.abs,p=Date.now;function d(S,C,G){return setTimeout(T(S,G),C)}function v(S,C,G){return Array.isArray(S)?(m(S,G[C],G),!0):!1}function m(S,C,G){var Q;if(S)if(S.forEach)S.forEach(C,G);else if(S.length!==a)for(Q=0;Q<S.length;)C.call(G,S[Q],Q,S),Q++;else for(Q in S)S.hasOwnProperty(Q)&&C.call(G,S[Q],Q,S)}function y(S,C,G){var Q="DEPRECATED METHOD: "+C+`
`+G+` AT 
`;return function(){var le=new Error("get-stack-trace"),Ee=le&&le.stack?le.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",rt=t.console&&(t.console.warn||t.console.log);return rt&&rt.call(t.console,Q,Ee),S.apply(this,arguments)}}var x;typeof Object.assign!="function"?x=function(C){if(C===a||C===null)throw new TypeError("Cannot convert undefined or null to object");for(var G=Object(C),Q=1;Q<arguments.length;Q++){var le=arguments[Q];if(le!==a&&le!==null)for(var Ee in le)le.hasOwnProperty(Ee)&&(G[Ee]=le[Ee])}return G}:x=Object.assign;var b=y(function(C,G,Q){for(var le=Object.keys(G),Ee=0;Ee<le.length;)(!Q||Q&&C[le[Ee]]===a)&&(C[le[Ee]]=G[le[Ee]]),Ee++;return C},"extend","Use `assign`."),w=y(function(C,G){return b(C,G,!0)},"merge","Use `assign`.");function E(S,C,G){var Q=C.prototype,le;le=S.prototype=Object.create(Q),le.constructor=S,le._super=Q,G&&x(le,G)}function T(S,C){return function(){return S.apply(C,arguments)}}function M(S,C){return typeof S==f?S.apply(C&&C[0]||a,C):S}function P(S,C){return S===a?C:S}function O(S,C,G){m(V(C),function(Q){S.addEventListener(Q,G,!1)})}function U(S,C,G){m(V(C),function(Q){S.removeEventListener(Q,G,!1)})}function W(S,C){for(;S;){if(S==C)return!0;S=S.parentNode}return!1}function B(S,C){return S.indexOf(C)>-1}function V(S){return S.trim().split(/\s+/g)}function X(S,C,G){if(S.indexOf&&!G)return S.indexOf(C);for(var Q=0;Q<S.length;){if(G&&S[Q][G]==C||!G&&S[Q]===C)return Q;Q++}return-1}function re(S){return Array.prototype.slice.call(S,0)}function z(S,C,G){for(var Q=[],le=[],Ee=0;Ee<S.length;){var rt=C?S[Ee][C]:S[Ee];X(le,rt)<0&&Q.push(S[Ee]),le[Ee]=rt,Ee++}return G&&(C?Q=Q.sort(function(Yt,nn){return Yt[C]>nn[C]}):Q=Q.sort()),Q}function D(S,C){for(var G,Q,le=C[0].toUpperCase()+C.slice(1),Ee=0;Ee<s.length;){if(G=s[Ee],Q=G?G+le:C,Q in S)return Q;Ee++}return a}var ee=1;function K(){return ee++}function te(S){var C=S.ownerDocument||S;return C.defaultView||C.parentWindow||t}var $=/mobile|tablet|ip(ad|hone|od)|android/i,ue="ontouchstart"in t,he=D(t,"PointerEvent")!==a,oe=ue&&$.test(navigator.userAgent),ve="touch",pe="pen",Ae="mouse",Z="kinect",Ce=25,J=1,Pe=2,de=4,Ie=8,Ze=1,ft=2,gt=4,st=8,Je=16,Nt=ft|gt,Et=st|Je,Lt=Nt|Et,mn=["x","y"],an=["clientX","clientY"];function ot(S,C){var G=this;this.manager=S,this.callback=C,this.element=S.element,this.target=S.options.inputTarget,this.domHandler=function(Q){M(S.options.enable,[S])&&G.handler(Q)},this.init()}ot.prototype={handler:function(){},init:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(te(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&U(this.element,this.evEl,this.domHandler),this.evTarget&&U(this.target,this.evTarget,this.domHandler),this.evWin&&U(te(this.element),this.evWin,this.domHandler)}};function zt(S){var C,G=S.options.inputClass;return G?C=G:he?C=Ln:oe?C=mr:ue?C=wi:C=gn,new C(S,$e)}function $e(S,C,G){var Q=G.pointers.length,le=G.changedPointers.length,Ee=C&J&&Q-le===0,rt=C&(de|Ie)&&Q-le===0;G.isFirst=!!Ee,G.isFinal=!!rt,Ee&&(S.session={}),G.eventType=C,q(S,G),S.emit("hammer.input",G),S.recognize(G),S.session.prevInput=G}function q(S,C){var G=S.session,Q=C.pointers,le=Q.length;G.firstInput||(G.firstInput=Ne(C)),le>1&&!G.firstMultiple?G.firstMultiple=Ne(C):le===1&&(G.firstMultiple=!1);var Ee=G.firstInput,rt=G.firstMultiple,Wt=rt?rt.center:Ee.center,Yt=C.center=be(Q);C.timeStamp=p(),C.deltaTime=C.timeStamp-Ee.timeStamp,C.angle=Rt(Wt,Yt),C.distance=ht(Wt,Yt),ge(G,C),C.offsetDirection=lt(C.deltaX,C.deltaY);var nn=et(C.deltaTime,C.deltaX,C.deltaY);C.overallVelocityX=nn.x,C.overallVelocityY=nn.y,C.overallVelocity=l(nn.x)>l(nn.y)?nn.x:nn.y,C.scale=rt?Jt(rt.pointers,Q):1,C.rotation=rt?mt(rt.pointers,Q):0,C.maxPointers=G.prevInput?C.pointers.length>G.prevInput.maxPointers?C.pointers.length:G.prevInput.maxPointers:C.pointers.length,Me(G,C);var Wn=S.element;W(C.srcEvent.target,Wn)&&(Wn=C.srcEvent.target),C.target=Wn}function ge(S,C){var G=C.center,Q=S.offsetDelta||{},le=S.prevDelta||{},Ee=S.prevInput||{};(C.eventType===J||Ee.eventType===de)&&(le=S.prevDelta={x:Ee.deltaX||0,y:Ee.deltaY||0},Q=S.offsetDelta={x:G.x,y:G.y}),C.deltaX=le.x+(G.x-Q.x),C.deltaY=le.y+(G.y-Q.y)}function Me(S,C){var G=S.lastInterval||C,Q=C.timeStamp-G.timeStamp,le,Ee,rt,Wt;if(C.eventType!=Ie&&(Q>Ce||G.velocity===a)){var Yt=C.deltaX-G.deltaX,nn=C.deltaY-G.deltaY,Wn=et(Q,Yt,nn);Ee=Wn.x,rt=Wn.y,le=l(Wn.x)>l(Wn.y)?Wn.x:Wn.y,Wt=lt(Yt,nn),S.lastInterval=C}else le=G.velocity,Ee=G.velocityX,rt=G.velocityY,Wt=G.direction;C.velocity=le,C.velocityX=Ee,C.velocityY=rt,C.direction=Wt}function Ne(S){for(var C=[],G=0;G<S.pointers.length;)C[G]={clientX:h(S.pointers[G].clientX),clientY:h(S.pointers[G].clientY)},G++;return{timeStamp:p(),pointers:C,center:be(C),deltaX:S.deltaX,deltaY:S.deltaY}}function be(S){var C=S.length;if(C===1)return{x:h(S[0].clientX),y:h(S[0].clientY)};for(var G=0,Q=0,le=0;le<C;)G+=S[le].clientX,Q+=S[le].clientY,le++;return{x:h(G/C),y:h(Q/C)}}function et(S,C,G){return{x:C/S||0,y:G/S||0}}function lt(S,C){return S===C?Ze:l(S)>=l(C)?S<0?ft:gt:C<0?st:Je}function ht(S,C,G){G||(G=mn);var Q=C[G[0]]-S[G[0]],le=C[G[1]]-S[G[1]];return Math.sqrt(Q*Q+le*le)}function Rt(S,C,G){G||(G=mn);var Q=C[G[0]]-S[G[0]],le=C[G[1]]-S[G[1]];return Math.atan2(le,Q)*180/Math.PI}function mt(S,C){return Rt(C[1],C[0],an)+Rt(S[1],S[0],an)}function Jt(S,C){return ht(C[0],C[1],an)/ht(S[0],S[1],an)}var Qt={mousedown:J,mousemove:Pe,mouseup:de},Gn="mousedown",dr="mousemove mouseup";function gn(){this.evEl=Gn,this.evWin=dr,this.pressed=!1,ot.apply(this,arguments)}E(gn,ot,{handler:function(C){var G=Qt[C.type];G&J&&C.button===0&&(this.pressed=!0),G&Pe&&C.which!==1&&(G=de),this.pressed&&(G&de&&(this.pressed=!1),this.callback(this.manager,G,{pointers:[C],changedPointers:[C],pointerType:Ae,srcEvent:C}))}});var Yr={pointerdown:J,pointermove:Pe,pointerup:de,pointercancel:Ie,pointerout:Ie},vr={2:ve,3:pe,4:Ae,5:Z},rr="pointerdown",Hn="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(rr="MSPointerDown",Hn="MSPointerMove MSPointerUp MSPointerCancel");function Ln(){this.evEl=rr,this.evWin=Hn,ot.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}E(Ln,ot,{handler:function(C){var G=this.store,Q=!1,le=C.type.toLowerCase().replace("ms",""),Ee=Yr[le],rt=vr[C.pointerType]||C.pointerType,Wt=rt==ve,Yt=X(G,C.pointerId,"pointerId");Ee&J&&(C.button===0||Wt)?Yt<0&&(G.push(C),Yt=G.length-1):Ee&(de|Ie)&&(Q=!0),!(Yt<0)&&(G[Yt]=C,this.callback(this.manager,Ee,{pointers:G,changedPointers:[C],pointerType:rt,srcEvent:C}),Q&&G.splice(Yt,1))}});var ir={touchstart:J,touchmove:Pe,touchend:de,touchcancel:Ie},Ms="touchstart",Ts="touchstart touchmove touchend touchcancel";function _i(){this.evTarget=Ms,this.evWin=Ts,this.started=!1,ot.apply(this,arguments)}E(_i,ot,{handler:function(C){var G=ir[C.type];if(G===J&&(this.started=!0),!!this.started){var Q=Ss.call(this,C,G);G&(de|Ie)&&Q[0].length-Q[1].length===0&&(this.started=!1),this.callback(this.manager,G,{pointers:Q[0],changedPointers:Q[1],pointerType:ve,srcEvent:C})}}});function Ss(S,C){var G=re(S.touches),Q=re(S.changedTouches);return C&(de|Ie)&&(G=z(G.concat(Q),"identifier",!0)),[G,Q]}var As={touchstart:J,touchmove:Pe,touchend:de,touchcancel:Ie},fa="touchstart touchmove touchend touchcancel";function mr(){this.evTarget=fa,this.targetIds={},ot.apply(this,arguments)}E(mr,ot,{handler:function(C){var G=As[C.type],Q=ha.call(this,C,G);Q&&this.callback(this.manager,G,{pointers:Q[0],changedPointers:Q[1],pointerType:ve,srcEvent:C})}});function ha(S,C){var G=re(S.touches),Q=this.targetIds;if(C&(J|Pe)&&G.length===1)return Q[G[0].identifier]=!0,[G,G];var le,Ee,rt=re(S.changedTouches),Wt=[],Yt=this.target;if(Ee=G.filter(function(nn){return W(nn.target,Yt)}),C===J)for(le=0;le<Ee.length;)Q[Ee[le].identifier]=!0,le++;for(le=0;le<rt.length;)Q[rt[le].identifier]&&Wt.push(rt[le]),C&(de|Ie)&&delete Q[rt[le].identifier],le++;if(Wt.length)return[z(Ee.concat(Wt),"identifier",!0),Wt]}var xi=2500,ca=25;function wi(){ot.apply(this,arguments);var S=T(this.handler,this);this.touch=new mr(this.manager,S),this.mouse=new gn(this.manager,S),this.primaryTouch=null,this.lastTouches=[]}E(wi,ot,{handler:function(C,G,Q){var le=Q.pointerType==ve,Ee=Q.pointerType==Ae;if(!(Ee&&Q.sourceCapabilities&&Q.sourceCapabilities.firesTouchEvents)){if(le)Ls.call(this,G,Q);else if(Ee&&Rs.call(this,Q))return;this.callback(C,G,Q)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ls(S,C){S&J?(this.primaryTouch=C.changedPointers[0].identifier,la.call(this,C)):S&(de|Ie)&&la.call(this,C)}function la(S){var C=S.changedPointers[0];if(C.identifier===this.primaryTouch){var G={x:C.clientX,y:C.clientY};this.lastTouches.push(G);var Q=this.lastTouches,le=function(){var Ee=Q.indexOf(G);Ee>-1&&Q.splice(Ee,1)};setTimeout(le,xi)}}function Rs(S){for(var C=S.srcEvent.clientX,G=S.srcEvent.clientY,Q=0;Q<this.lastTouches.length;Q++){var le=this.lastTouches[Q],Ee=Math.abs(C-le.x),rt=Math.abs(G-le.y);if(Ee<=ca&&rt<=ca)return!0}return!1}var R=D(u.style,"touchAction"),F=R!==a,k="compute",fe="auto",xe="manipulation",Se="none",ke="pan-x",Oe="pan-y",qe=Le();function Xe(S,C){this.manager=S,this.set(C)}Xe.prototype={set:function(S){S==k&&(S=this.compute()),F&&this.manager.element.style&&qe[S]&&(this.manager.element.style[R]=S),this.actions=S.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var S=[];return m(this.manager.recognizers,function(C){M(C.options.enable,[C])&&(S=S.concat(C.getTouchAction()))}),Be(S.join(" "))},preventDefaults:function(S){var C=S.srcEvent,G=S.offsetDirection;if(this.manager.session.prevented){C.preventDefault();return}var Q=this.actions,le=B(Q,Se)&&!qe[Se],Ee=B(Q,Oe)&&!qe[Oe],rt=B(Q,ke)&&!qe[ke];if(le){var Wt=S.pointers.length===1,Yt=S.distance<2,nn=S.deltaTime<250;if(Wt&&Yt&&nn)return}if(!(rt&&Ee)&&(le||Ee&&G&Nt||rt&&G&Et))return this.preventSrc(C)},preventSrc:function(S){this.manager.session.prevented=!0,S.preventDefault()}};function Be(S){if(B(S,Se))return Se;var C=B(S,ke),G=B(S,Oe);return C&&G?Se:C||G?C?ke:Oe:B(S,xe)?xe:fe}function Le(){if(!F)return!1;var S={},C=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(G){S[G]=C?t.CSS.supports("touch-action",G):!0}),S}var Mt=1,Ye=2,Vt=4,yt=8,Tt=yt,tn=16,Kt=32;function Dt(S){this.options=x({},this.defaults,S||{}),this.id=K(),this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=Mt,this.simultaneous={},this.requireFail=[]}Dt.prototype={defaults:{},set:function(S){return x(this.options,S),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(S){if(v(S,"recognizeWith",this))return this;var C=this.simultaneous;return S=gr(S,this),C[S.id]||(C[S.id]=S,S.recognizeWith(this)),this},dropRecognizeWith:function(S){return v(S,"dropRecognizeWith",this)?this:(S=gr(S,this),delete this.simultaneous[S.id],this)},requireFailure:function(S){if(v(S,"requireFailure",this))return this;var C=this.requireFail;return S=gr(S,this),X(C,S)===-1&&(C.push(S),S.requireFailure(this)),this},dropRequireFailure:function(S){if(v(S,"dropRequireFailure",this))return this;S=gr(S,this);var C=X(this.requireFail,S);return C>-1&&this.requireFail.splice(C,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(S){return!!this.simultaneous[S.id]},emit:function(S){var C=this,G=this.state;function Q(le){C.manager.emit(le,S)}G<yt&&Q(C.options.event+pa(G)),Q(C.options.event),S.additionalEvent&&Q(S.additionalEvent),G>=yt&&Q(C.options.event+pa(G))},tryEmit:function(S){if(this.canEmit())return this.emit(S);this.state=Kt},canEmit:function(){for(var S=0;S<this.requireFail.length;){if(!(this.requireFail[S].state&(Kt|Mt)))return!1;S++}return!0},recognize:function(S){var C=x({},S);if(!M(this.options.enable,[this,C])){this.reset(),this.state=Kt;return}this.state&(Tt|tn|Kt)&&(this.state=Mt),this.state=this.process(C),this.state&(Ye|Vt|yt|tn)&&this.tryEmit(C)},process:function(S){},getTouchAction:function(){},reset:function(){}};function pa(S){return S&tn?"cancel":S&yt?"end":S&Vt?"move":S&Ye?"start":""}function qr(S){return S==Je?"down":S==st?"up":S==ft?"left":S==gt?"right":""}function gr(S,C){var G=C.manager;return G?G.get(S):S}function yn(){Dt.apply(this,arguments)}E(yn,Dt,{defaults:{pointers:1},attrTest:function(S){var C=this.options.pointers;return C===0||S.pointers.length===C},process:function(S){var C=this.state,G=S.eventType,Q=C&(Ye|Vt),le=this.attrTest(S);return Q&&(G&Ie||!le)?C|tn:Q||le?G&de?C|yt:C&Ye?C|Vt:Ye:Kt}});function bi(){yn.apply(this,arguments),this.pX=null,this.pY=null}E(bi,yn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Lt},getTouchAction:function(){var S=this.options.direction,C=[];return S&Nt&&C.push(Oe),S&Et&&C.push(ke),C},directionTest:function(S){var C=this.options,G=!0,Q=S.distance,le=S.direction,Ee=S.deltaX,rt=S.deltaY;return le&C.direction||(C.direction&Nt?(le=Ee===0?Ze:Ee<0?ft:gt,G=Ee!=this.pX,Q=Math.abs(S.deltaX)):(le=rt===0?Ze:rt<0?st:Je,G=rt!=this.pY,Q=Math.abs(S.deltaY))),S.direction=le,G&&Q>C.threshold&&le&C.direction},attrTest:function(S){return yn.prototype.attrTest.call(this,S)&&(this.state&Ye||!(this.state&Ye)&&this.directionTest(S))},emit:function(S){this.pX=S.deltaX,this.pY=S.deltaY;var C=qr(S.direction);C&&(S.additionalEvent=this.options.event+C),this._super.emit.call(this,S)}});function da(){yn.apply(this,arguments)}E(da,yn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(S){return this._super.attrTest.call(this,S)&&(Math.abs(S.scale-1)>this.options.threshold||this.state&Ye)},emit:function(S){if(S.scale!==1){var C=S.scale<1?"in":"out";S.additionalEvent=this.options.event+C}this._super.emit.call(this,S)}});function Ei(){Dt.apply(this,arguments),this._timer=null,this._input=null}E(Ei,Dt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[fe]},process:function(S){var C=this.options,G=S.pointers.length===C.pointers,Q=S.distance<C.threshold,le=S.deltaTime>C.time;if(this._input=S,!Q||!G||S.eventType&(de|Ie)&&!le)this.reset();else if(S.eventType&J)this.reset(),this._timer=d(function(){this.state=Tt,this.tryEmit()},C.time,this);else if(S.eventType&de)return Tt;return Kt},reset:function(){clearTimeout(this._timer)},emit:function(S){this.state===Tt&&(S&&S.eventType&de?this.manager.emit(this.options.event+"up",S):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function Cs(){yn.apply(this,arguments)}E(Cs,yn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(S){return this._super.attrTest.call(this,S)&&(Math.abs(S.rotation)>this.options.threshold||this.state&Ye)}});function va(){yn.apply(this,arguments)}E(va,yn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Nt|Et,pointers:1},getTouchAction:function(){return bi.prototype.getTouchAction.call(this)},attrTest:function(S){var C=this.options.direction,G;return C&(Nt|Et)?G=S.overallVelocity:C&Nt?G=S.overallVelocityX:C&Et&&(G=S.overallVelocityY),this._super.attrTest.call(this,S)&&C&S.offsetDirection&&S.distance>this.options.threshold&&S.maxPointers==this.options.pointers&&l(G)>this.options.velocity&&S.eventType&de},emit:function(S){var C=qr(S.offsetDirection);C&&this.manager.emit(this.options.event+C,S),this.manager.emit(this.options.event,S)}});function Lr(){Dt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}E(Lr,Dt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xe]},process:function(S){var C=this.options,G=S.pointers.length===C.pointers,Q=S.distance<C.threshold,le=S.deltaTime<C.time;if(this.reset(),S.eventType&J&&this.count===0)return this.failTimeout();if(Q&&le&&G){if(S.eventType!=de)return this.failTimeout();var Ee=this.pTime?S.timeStamp-this.pTime<C.interval:!0,rt=!this.pCenter||ht(this.pCenter,S.center)<C.posThreshold;this.pTime=S.timeStamp,this.pCenter=S.center,!rt||!Ee?this.count=1:this.count+=1,this._input=S;var Wt=this.count%C.taps;if(Wt===0)return this.hasRequireFailures()?(this._timer=d(function(){this.state=Tt,this.tryEmit()},C.interval,this),Ye):Tt}return Kt},failTimeout:function(){return this._timer=d(function(){this.state=Kt},this.options.interval,this),Kt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Tt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Vn(S,C){return C=C||{},C.recognizers=P(C.recognizers,Vn.defaults.preset),new ma(S,C)}Vn.VERSION="2.0.7",Vn.defaults={domEvents:!1,touchAction:k,enable:!0,inputTarget:null,inputClass:null,preset:[[Cs,{enable:!1}],[da,{enable:!1},["rotate"]],[va,{direction:Nt}],[bi,{direction:Nt},["swipe"]],[Lr],[Lr,{event:"doubletap",taps:2},["tap"]],[Ei]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Jf=1,Ps=2;function ma(S,C){this.options=x({},Vn.defaults,C||{}),this.options.inputTarget=this.options.inputTarget||S,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=S,this.input=zt(this),this.touchAction=new Xe(this,this.options.touchAction),ga(this,!0),m(this.options.recognizers,function(G){var Q=this.add(new G[0](G[1]));G[2]&&Q.recognizeWith(G[2]),G[3]&&Q.requireFailure(G[3])},this)}ma.prototype={set:function(S){return x(this.options,S),S.touchAction&&this.touchAction.update(),S.inputTarget&&(this.input.destroy(),this.input.target=S.inputTarget,this.input.init()),this},stop:function(S){this.session.stopped=S?Ps:Jf},recognize:function(S){var C=this.session;if(!C.stopped){this.touchAction.preventDefaults(S);var G,Q=this.recognizers,le=C.curRecognizer;(!le||le&&le.state&Tt)&&(le=C.curRecognizer=null);for(var Ee=0;Ee<Q.length;)G=Q[Ee],C.stopped!==Ps&&(!le||G==le||G.canRecognizeWith(le))?G.recognize(S):G.reset(),!le&&G.state&(Ye|Vt|yt)&&(le=C.curRecognizer=G),Ee++}},get:function(S){if(S instanceof Dt)return S;for(var C=this.recognizers,G=0;G<C.length;G++)if(C[G].options.event==S)return C[G];return null},add:function(S){if(v(S,"add",this))return this;var C=this.get(S.options.event);return C&&this.remove(C),this.recognizers.push(S),S.manager=this,this.touchAction.update(),S},remove:function(S){if(v(S,"remove",this))return this;if(S=this.get(S),S){var C=this.recognizers,G=X(C,S);G!==-1&&(C.splice(G,1),this.touchAction.update())}return this},on:function(S,C){if(S!==a&&C!==a){var G=this.handlers;return m(V(S),function(Q){G[Q]=G[Q]||[],G[Q].push(C)}),this}},off:function(S,C){if(S!==a){var G=this.handlers;return m(V(S),function(Q){C?G[Q]&&G[Q].splice(X(G[Q],C),1):delete G[Q]}),this}},emit:function(S,C){this.options.domEvents&&Qf(S,C);var G=this.handlers[S]&&this.handlers[S].slice();if(!(!G||!G.length)){C.type=S,C.preventDefault=function(){C.srcEvent.preventDefault()};for(var Q=0;Q<G.length;)G[Q](C),Q++}},destroy:function(){this.element&&ga(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ga(S,C){var G=S.element;if(G.style){var Q;m(S.options.cssProps,function(le,Ee){Q=D(G.style,Ee),C?(S.oldCssProps[Q]=G.style[Q],G.style[Q]=le):G.style[Q]=S.oldCssProps[Q]||""}),C||(S.oldCssProps={})}}function Qf(S,C){var G=n.createEvent("Event");G.initEvent(S,!0,!0),G.gesture=C,C.target.dispatchEvent(G)}x(Vn,{INPUT_START:J,INPUT_MOVE:Pe,INPUT_END:de,INPUT_CANCEL:Ie,STATE_POSSIBLE:Mt,STATE_BEGAN:Ye,STATE_CHANGED:Vt,STATE_ENDED:yt,STATE_RECOGNIZED:Tt,STATE_CANCELLED:tn,STATE_FAILED:Kt,DIRECTION_NONE:Ze,DIRECTION_LEFT:ft,DIRECTION_RIGHT:gt,DIRECTION_UP:st,DIRECTION_DOWN:Je,DIRECTION_HORIZONTAL:Nt,DIRECTION_VERTICAL:Et,DIRECTION_ALL:Lt,Manager:ma,Input:ot,TouchAction:Xe,TouchInput:mr,MouseInput:gn,PointerEventInput:Ln,TouchMouseInput:wi,SingleTouchInput:_i,Recognizer:Dt,AttrRecognizer:yn,Tap:Lr,Pan:bi,Swipe:va,Pinch:da,Rotate:Cs,Press:Ei,on:O,off:U,each:m,merge:w,extend:b,assign:x,inherit:E,bindFn:T,prefixed:D});var $o=typeof t<"u"?t:typeof self<"u"?self:{};$o.Hammer=Vn,typeof a=="function"&&a.amd?a(function(){return Vn}):e.exports?e.exports=Vn:t[r]=Vn})(window,document,"Hammer")})(El);var b0=El.exports;const Ml=w0(b0);function kr(){return new ko}function ko(){this.reset()}ko.prototype={constructor:ko,reset:function(){this.s=this.t=0},add:function(e){Tl(Xo,e,this.t),Tl(this,Xo.s,this.s),this.s?this.t+=Xo.t:this.s=Xo.t},valueOf:function(){return this.s}};var Xo=new ko;function Tl(e,t,n){var r=e.s=t+n,a=r-t,s=r-a;e.t=t-s+(n-a)}var oa=Math.PI,Sl=oa/2,Al=oa*2,Yo=180/oa,qo=oa/180,Ll=Math.atan2,jo=Math.cos,Xr=Math.sin,Rl=Math.sqrt;function E0(e){return e>1?Sl:e<-1?-Sl:Math.asin(e)}function Cl(e){return(e=Xr(e/2))*e}kr(),kr(),kr();function Pl(e,t){return[e>oa?e-Al:e<-oa?e+Al:e,t]}Pl.invert=Pl,kr();function Il(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function M0(e){return e.length===1&&(e=T0(e)),{left:function(t,n,r,a){for(r==null&&(r=0),a==null&&(a=t.length);r<a;){var s=r+a>>>1;e(t[s],n)<0?r=s+1:a=s}return r},right:function(t,n,r,a){for(r==null&&(r=0),a==null&&(a=t.length);r<a;){var s=r+a>>>1;e(t[s],n)>0?a=s:r=s+1}return r}}}function T0(e){return function(t,n){return Il(e(t),n)}}M0(Il),kr();function S0(e,t){var n=e[0]*qo,r=e[1]*qo,a=t[0]*qo,s=t[1]*qo,u=jo(r),f=Xr(r),h=jo(s),l=Xr(s),p=u*jo(n),d=u*Xr(n),v=h*jo(a),m=h*Xr(a),y=2*E0(Rl(Cl(s-r)+u*h*Cl(a-n))),x=Xr(y),b=y?function(w){var E=Xr(w*=y)/x,T=Xr(y-w)/x,M=T*p+E*v,P=T*d+E*m,O=T*f+E*l;return[Ll(P,M)*Yo,Ll(O,Rl(M*M+P*P))*Yo]}:function(){return[n*Yo,r*Yo]};return b.distance=y,b}kr(),kr(),kr();function Dl(){}Dl.prototype={constructor:Dl,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Ol(e,t){return[e,t]}Ol.invert=Ol;const bs=200,Zo=Math.PI*2,A0=100,L0=20,R0=200,Ul=Math.PI/180;function C0(e,t,n){return e<=t?t:e>=n?n:e}function Jo(e,t,n){const r=(90-e)*Ul,a=(t+180)*Ul;return new I(-n*Math.sin(r)*Math.cos(a),n*Math.cos(r),n*Math.sin(r)*Math.sin(a))}function P0(e){const t=e[0],n=e[1],r=e[2],a=e[3],s=Jo(t,n,bs),u=Jo(r,a,bs),f=C0(s.distanceTo(u)*.35,L0,R0),h=S0([n,t],[a,r]),l=h(.25),p=h(.75),d=Jo(l[1],l[0],bs+f),v=Jo(p[1],p[0],bs+f);return{start:s,end:u,spline:new gi(s,d,v,u)}}function I0(e,t){const n=/\{\{([^{}]+)\}\}/g;return e.replace(n,(a,s)=>{const u=s.trim().split(".");let f=t;for(const h of u)f=f[h];return f})}function D0(e,t,n,r){const a=window.innerWidth,s=window.innerHeight;return e+n>a&&(e=a-n),t+r>s&&(t=s-r),e=Math.max(0,e),t=Math.max(0,t),{x:e,y:t}}function O0(e,t,n=!1){let r=!1;const a=new IntersectionObserver(s=>{s.forEach(u=>{u.isIntersecting&&!r&&(t(),r=!0,a.disconnect())})});a.observe(e)}let Qo=0,jf=0,Fl=0,Nl=0,Es=1250;const Zf=new ao,nr=new jt(new We),Ar={container:null,camera:null,paths:[],isInersecting:!1,intersectingMeshId:null};function U0(e,t={}){const n=e.offsetWidth||window.innerWidth,r=e.offsetHeight||window.innerHeight,a=new Zt(30,n/r,1,1e4),s=new vf({antialias:!0,alpha:!0});Ar.camera=a,Ar.container=e;const u=B0(e,t.labelTemplateId),f=new _l,h=new me,l={};isNaN(t.zoomLevel)||(Es=t.zoomLevel),setTimeout(()=>{e.addEventListener("mousemove",v=>{const m=Ar.container.getBoundingClientRect(),y=(v.clientX-m.left)/m.width*2-1,x=-(v.clientY-m.top)/m.height*2+1;h.x=y,h.y=x,l.clientX=v.clientX,l.clientY=v.clientY;let b=!1;f.setFromCamera(h,Ar.camera),f.params.Points.threshold=.1,f.params.Line.threshold=.1,Ar.paths.forEach(w=>{const T=w.path.mesh,M=f.intersectObject(T);M.length>0&&M[0].object.uuid==T.uuid?(M[0].object.material.color.set(6809849),Ar.container.style.cursor="pointer",b=!0,u.show(l.clientX,l.clientY,{data:w.data.data})):(T.material.color.set(16777215),b||(Ar.container.style.cursor="auto",u.hide()))})})},2e3),nr.rotation.x=.49826628687325725,nr.rotation.y=2.9990576315611692;const p=()=>{nr.rotation.x+=Math.atan(jf/Es)*.2,nr.rotation.y+=Math.atan((Qo!=0?Qo:2)/Es)*.2,nr.rotation.x>Zo&&(nr.rotation.x-=Zo),nr.rotation.y>Zo&&(nr.rotation.y-=Zo),a.position.z=Es,Ar.paths.forEach(v=>{v.path.updateDrawRange()}),s.render(Zf,a),requestAnimationFrame(p)};s.setSize(n,r),e.appendChild(s.domElement),a.position.z=Es,Zf.add(nr);const d=new Ro(16777215,16777215,.93);Zf.add(d),F0(e),N0(e,a,s),zl(e,a,s),p()}function Bl(){Qo=0,jf=0,Fl=0,Nl=0}function F0(e){const t=new Ml.Manager(e);t.add(new Ml.Pan),t.on("pan",n=>{Qo=n.deltaX-Fl,jf=n.deltaY-Nl}),t.on("panstart",()=>{Bl(),e.style.cursor="move"}),t.on("panend",()=>{Bl(),e.style.cursor="auto"})}function N0(e,t,n){window.addEventListener("resize",()=>{zl(e,t,n)},!1)}function zl(e,t,n){const r=e.offsetWidth||window.innerWidth,a=e.offsetHeight||window.innerHeight;t.aspect=r/a,t.updateProjectionMatrix(),n.setSize(r,a)}function B0(e,t=null){const n=document.createElement("div");let r="";t&&(r=document.getElementById(t).innerHTML);function a(s={}){const u=I0(r,{data:s});n.innerHTML=u}return a(),n.style.cssText=`
    visibility: hidden;
    position: fixed;
    width: max-content;
    height: max-content;
    transition:  opacity 0.4s;
  `,e.appendChild(n),{show(s,u,f){const{data:h}=f;a(h);const l=n.getBoundingClientRect(),{x:p,y:d}=D0(s,u+25,l.width,l.height);n.style.top=`${d}px`,n.style.left=`${p}px`,n.style.visibility="visible",n.style.opacity="1"},hide(){n.style.visibility="hidden",n.style.opacity="0"}}}function z0(){const e=new Yi(bs,40,30),t=new Ef,n=new er({map:t.load("https://cdn.jsdelivr.net/gh/sayankundu009/webgl-globe/dist/earth-texture-4.jpg")}),r=new jt(e,n);nr.add(r)}var Ko={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Ko.exports,function(e,t){(function(){var n,r="4.17.21",a=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",f="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",l=500,p="__lodash_placeholder__",d=1,v=2,m=4,y=1,x=2,b=1,w=2,E=4,T=8,M=16,P=32,O=64,U=128,W=256,B=512,V=30,X="...",re=800,z=16,D=1,ee=2,K=3,te=1/0,$=9007199254740991,ue=17976931348623157e292,he=NaN,oe=4294967295,ve=oe-1,pe=oe>>>1,Ae=[["ary",U],["bind",b],["bindKey",w],["curry",T],["curryRight",M],["flip",B],["partial",P],["partialRight",O],["rearg",W]],Z="[object Arguments]",Ce="[object Array]",J="[object AsyncFunction]",Pe="[object Boolean]",de="[object Date]",Ie="[object DOMException]",Ze="[object Error]",ft="[object Function]",gt="[object GeneratorFunction]",st="[object Map]",Je="[object Number]",Nt="[object Null]",Et="[object Object]",Lt="[object Promise]",mn="[object Proxy]",an="[object RegExp]",ot="[object Set]",zt="[object String]",$e="[object Symbol]",q="[object Undefined]",ge="[object WeakMap]",Me="[object WeakSet]",Ne="[object ArrayBuffer]",be="[object DataView]",et="[object Float32Array]",lt="[object Float64Array]",ht="[object Int8Array]",Rt="[object Int16Array]",mt="[object Int32Array]",Jt="[object Uint8Array]",Qt="[object Uint8ClampedArray]",Gn="[object Uint16Array]",dr="[object Uint32Array]",gn=/\b__p \+= '';/g,Yr=/\b(__p \+=) '' \+/g,vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,rr=/&(?:amp|lt|gt|quot|#39);/g,Hn=/[&<>"']/g,Ln=RegExp(rr.source),ir=RegExp(Hn.source),Ms=/<%-([\s\S]+?)%>/g,Ts=/<%([\s\S]+?)%>/g,_i=/<%=([\s\S]+?)%>/g,Ss=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,As=/^\w*$/,fa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mr=/[\\^$.*+?()[\]{}|]/g,ha=RegExp(mr.source),xi=/^\s+/,ca=/\s/,wi=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ls=/\{\n\/\* \[wrapped with (.+)\] \*/,la=/,? & /,Rs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,R=/[()=,{}\[\]\/\s]/,F=/\\(\\)?/g,k=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,xe=/^[-+]0x[0-9a-f]+$/i,Se=/^0b[01]+$/i,ke=/^\[object .+?Constructor\]$/,Oe=/^0o[0-7]+$/i,qe=/^(?:0|[1-9]\d*)$/,Xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Be=/($^)/,Le=/['\n\r\u2028\u2029\\]/g,Mt="\\ud800-\\udfff",Ye="\\u0300-\\u036f",Vt="\\ufe20-\\ufe2f",yt="\\u20d0-\\u20ff",Tt=Ye+Vt+yt,tn="\\u2700-\\u27bf",Kt="a-z\\xdf-\\xf6\\xf8-\\xff",Dt="\\xac\\xb1\\xd7\\xf7",pa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qr="\\u2000-\\u206f",gr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",yn="A-Z\\xc0-\\xd6\\xd8-\\xde",bi="\\ufe0e\\ufe0f",da=Dt+pa+qr+gr,Ei="['’]",Cs="["+Mt+"]",va="["+da+"]",Lr="["+Tt+"]",Vn="\\d+",Jf="["+tn+"]",Ps="["+Kt+"]",ma="[^"+Mt+da+Vn+tn+Kt+yn+"]",ga="\\ud83c[\\udffb-\\udfff]",Qf="(?:"+Lr+"|"+ga+")",$o="[^"+Mt+"]",S="(?:\\ud83c[\\udde6-\\uddff]){2}",C="[\\ud800-\\udbff][\\udc00-\\udfff]",G="["+yn+"]",Q="\\u200d",le="(?:"+Ps+"|"+ma+")",Ee="(?:"+G+"|"+ma+")",rt="(?:"+Ei+"(?:d|ll|m|re|s|t|ve))?",Wt="(?:"+Ei+"(?:D|LL|M|RE|S|T|VE))?",Yt=Qf+"?",nn="["+bi+"]?",Wn="(?:"+Q+"(?:"+[$o,S,C].join("|")+")"+nn+Yt+")*",Y0="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",q0="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Hl=nn+Yt+Wn,j0="(?:"+[Jf,S,C].join("|")+")"+Hl,Z0="(?:"+[$o+Lr+"?",Lr,S,C,Cs].join("|")+")",J0=RegExp(Ei,"g"),Q0=RegExp(Lr,"g"),Kf=RegExp(ga+"(?="+ga+")|"+Z0+Hl,"g"),K0=RegExp([G+"?"+Ps+"+"+rt+"(?="+[va,G,"$"].join("|")+")",Ee+"+"+Wt+"(?="+[va,G+le,"$"].join("|")+")",G+"?"+le+"+"+rt,G+"+"+Wt,q0,Y0,Vn,j0].join("|"),"g"),$0=RegExp("["+Q+Mt+Tt+bi+"]"),e_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,t_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],n_=-1,Pt={};Pt[et]=Pt[lt]=Pt[ht]=Pt[Rt]=Pt[mt]=Pt[Jt]=Pt[Qt]=Pt[Gn]=Pt[dr]=!0,Pt[Z]=Pt[Ce]=Pt[Ne]=Pt[Pe]=Pt[be]=Pt[de]=Pt[Ze]=Pt[ft]=Pt[st]=Pt[Je]=Pt[Et]=Pt[an]=Pt[ot]=Pt[zt]=Pt[ge]=!1;var Ct={};Ct[Z]=Ct[Ce]=Ct[Ne]=Ct[be]=Ct[Pe]=Ct[de]=Ct[et]=Ct[lt]=Ct[ht]=Ct[Rt]=Ct[mt]=Ct[st]=Ct[Je]=Ct[Et]=Ct[an]=Ct[ot]=Ct[zt]=Ct[$e]=Ct[Jt]=Ct[Qt]=Ct[Gn]=Ct[dr]=!0,Ct[Ze]=Ct[ft]=Ct[ge]=!1;var r_={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},i_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},s_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},o_=parseFloat,u_=parseInt,Vl=typeof ws=="object"&&ws&&ws.Object===Object&&ws,f_=typeof self=="object"&&self&&self.Object===Object&&self,sn=Vl||f_||Function("return this")(),$f=t&&!t.nodeType&&t,Mi=$f&&!0&&e&&!e.nodeType&&e,Wl=Mi&&Mi.exports===$f,eh=Wl&&Vl.process,kn=function(){try{var Y=Mi&&Mi.require&&Mi.require("util").types;return Y||eh&&eh.binding&&eh.binding("util")}catch{}}(),kl=kn&&kn.isArrayBuffer,Xl=kn&&kn.isDate,Yl=kn&&kn.isMap,ql=kn&&kn.isRegExp,jl=kn&&kn.isSet,Zl=kn&&kn.isTypedArray;function Rn(Y,ie,ne){switch(ne.length){case 0:return Y.call(ie);case 1:return Y.call(ie,ne[0]);case 2:return Y.call(ie,ne[0],ne[1]);case 3:return Y.call(ie,ne[0],ne[1],ne[2])}return Y.apply(ie,ne)}function h_(Y,ie,ne,Te){for(var je=-1,_t=Y==null?0:Y.length;++je<_t;){var $t=Y[je];ie(Te,$t,ne($t),Y)}return Te}function Xn(Y,ie){for(var ne=-1,Te=Y==null?0:Y.length;++ne<Te&&ie(Y[ne],ne,Y)!==!1;);return Y}function c_(Y,ie){for(var ne=Y==null?0:Y.length;ne--&&ie(Y[ne],ne,Y)!==!1;);return Y}function Jl(Y,ie){for(var ne=-1,Te=Y==null?0:Y.length;++ne<Te;)if(!ie(Y[ne],ne,Y))return!1;return!0}function jr(Y,ie){for(var ne=-1,Te=Y==null?0:Y.length,je=0,_t=[];++ne<Te;){var $t=Y[ne];ie($t,ne,Y)&&(_t[je++]=$t)}return _t}function eu(Y,ie){var ne=Y==null?0:Y.length;return!!ne&&ya(Y,ie,0)>-1}function th(Y,ie,ne){for(var Te=-1,je=Y==null?0:Y.length;++Te<je;)if(ne(ie,Y[Te]))return!0;return!1}function Ot(Y,ie){for(var ne=-1,Te=Y==null?0:Y.length,je=Array(Te);++ne<Te;)je[ne]=ie(Y[ne],ne,Y);return je}function Zr(Y,ie){for(var ne=-1,Te=ie.length,je=Y.length;++ne<Te;)Y[je+ne]=ie[ne];return Y}function nh(Y,ie,ne,Te){var je=-1,_t=Y==null?0:Y.length;for(Te&&_t&&(ne=Y[++je]);++je<_t;)ne=ie(ne,Y[je],je,Y);return ne}function l_(Y,ie,ne,Te){var je=Y==null?0:Y.length;for(Te&&je&&(ne=Y[--je]);je--;)ne=ie(ne,Y[je],je,Y);return ne}function rh(Y,ie){for(var ne=-1,Te=Y==null?0:Y.length;++ne<Te;)if(ie(Y[ne],ne,Y))return!0;return!1}var p_=ih("length");function d_(Y){return Y.split("")}function v_(Y){return Y.match(Rs)||[]}function Ql(Y,ie,ne){var Te;return ne(Y,function(je,_t,$t){if(ie(je,_t,$t))return Te=_t,!1}),Te}function tu(Y,ie,ne,Te){for(var je=Y.length,_t=ne+(Te?1:-1);Te?_t--:++_t<je;)if(ie(Y[_t],_t,Y))return _t;return-1}function ya(Y,ie,ne){return ie===ie?A_(Y,ie,ne):tu(Y,Kl,ne)}function m_(Y,ie,ne,Te){for(var je=ne-1,_t=Y.length;++je<_t;)if(Te(Y[je],ie))return je;return-1}function Kl(Y){return Y!==Y}function $l(Y,ie){var ne=Y==null?0:Y.length;return ne?sh(Y,ie)/ne:he}function ih(Y){return function(ie){return ie==null?n:ie[Y]}}function ah(Y){return function(ie){return Y==null?n:Y[ie]}}function ep(Y,ie,ne,Te,je){return je(Y,function(_t,$t,St){ne=Te?(Te=!1,_t):ie(ne,_t,$t,St)}),ne}function g_(Y,ie){var ne=Y.length;for(Y.sort(ie);ne--;)Y[ne]=Y[ne].value;return Y}function sh(Y,ie){for(var ne,Te=-1,je=Y.length;++Te<je;){var _t=ie(Y[Te]);_t!==n&&(ne=ne===n?_t:ne+_t)}return ne}function oh(Y,ie){for(var ne=-1,Te=Array(Y);++ne<Y;)Te[ne]=ie(ne);return Te}function y_(Y,ie){return Ot(ie,function(ne){return[ne,Y[ne]]})}function tp(Y){return Y&&Y.slice(0,ap(Y)+1).replace(xi,"")}function Cn(Y){return function(ie){return Y(ie)}}function uh(Y,ie){return Ot(ie,function(ne){return Y[ne]})}function Is(Y,ie){return Y.has(ie)}function np(Y,ie){for(var ne=-1,Te=Y.length;++ne<Te&&ya(ie,Y[ne],0)>-1;);return ne}function rp(Y,ie){for(var ne=Y.length;ne--&&ya(ie,Y[ne],0)>-1;);return ne}function __(Y,ie){for(var ne=Y.length,Te=0;ne--;)Y[ne]===ie&&++Te;return Te}var x_=ah(r_),w_=ah(i_);function b_(Y){return"\\"+s_[Y]}function E_(Y,ie){return Y==null?n:Y[ie]}function _a(Y){return $0.test(Y)}function M_(Y){return e_.test(Y)}function T_(Y){for(var ie,ne=[];!(ie=Y.next()).done;)ne.push(ie.value);return ne}function fh(Y){var ie=-1,ne=Array(Y.size);return Y.forEach(function(Te,je){ne[++ie]=[je,Te]}),ne}function ip(Y,ie){return function(ne){return Y(ie(ne))}}function Jr(Y,ie){for(var ne=-1,Te=Y.length,je=0,_t=[];++ne<Te;){var $t=Y[ne];($t===ie||$t===p)&&(Y[ne]=p,_t[je++]=ne)}return _t}function nu(Y){var ie=-1,ne=Array(Y.size);return Y.forEach(function(Te){ne[++ie]=Te}),ne}function S_(Y){var ie=-1,ne=Array(Y.size);return Y.forEach(function(Te){ne[++ie]=[Te,Te]}),ne}function A_(Y,ie,ne){for(var Te=ne-1,je=Y.length;++Te<je;)if(Y[Te]===ie)return Te;return-1}function L_(Y,ie,ne){for(var Te=ne+1;Te--;)if(Y[Te]===ie)return Te;return Te}function xa(Y){return _a(Y)?C_(Y):p_(Y)}function ar(Y){return _a(Y)?P_(Y):d_(Y)}function ap(Y){for(var ie=Y.length;ie--&&ca.test(Y.charAt(ie)););return ie}var R_=ah(a_);function C_(Y){for(var ie=Kf.lastIndex=0;Kf.test(Y);)++ie;return ie}function P_(Y){return Y.match(Kf)||[]}function I_(Y){return Y.match(K0)||[]}var D_=function Y(ie){ie=ie==null?sn:wa.defaults(sn.Object(),ie,wa.pick(sn,t_));var ne=ie.Array,Te=ie.Date,je=ie.Error,_t=ie.Function,$t=ie.Math,St=ie.Object,hh=ie.RegExp,O_=ie.String,Yn=ie.TypeError,ru=ne.prototype,U_=_t.prototype,ba=St.prototype,iu=ie["__core-js_shared__"],au=U_.toString,bt=ba.hasOwnProperty,F_=0,sp=function(){var i=/[^.]+$/.exec(iu&&iu.keys&&iu.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),su=ba.toString,N_=au.call(St),B_=sn._,z_=hh("^"+au.call(bt).replace(mr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ou=Wl?ie.Buffer:n,Qr=ie.Symbol,uu=ie.Uint8Array,op=ou?ou.allocUnsafe:n,fu=ip(St.getPrototypeOf,St),up=St.create,fp=ba.propertyIsEnumerable,hu=ru.splice,hp=Qr?Qr.isConcatSpreadable:n,Ds=Qr?Qr.iterator:n,Ti=Qr?Qr.toStringTag:n,cu=function(){try{var i=Ci(St,"defineProperty");return i({},"",{}),i}catch{}}(),G_=ie.clearTimeout!==sn.clearTimeout&&ie.clearTimeout,H_=Te&&Te.now!==sn.Date.now&&Te.now,V_=ie.setTimeout!==sn.setTimeout&&ie.setTimeout,lu=$t.ceil,pu=$t.floor,ch=St.getOwnPropertySymbols,W_=ou?ou.isBuffer:n,cp=ie.isFinite,k_=ru.join,X_=ip(St.keys,St),en=$t.max,un=$t.min,Y_=Te.now,q_=ie.parseInt,lp=$t.random,j_=ru.reverse,lh=Ci(ie,"DataView"),Os=Ci(ie,"Map"),ph=Ci(ie,"Promise"),Ea=Ci(ie,"Set"),Us=Ci(ie,"WeakMap"),Fs=Ci(St,"create"),du=Us&&new Us,Ma={},Z_=Pi(lh),J_=Pi(Os),Q_=Pi(ph),K_=Pi(Ea),$_=Pi(Us),vu=Qr?Qr.prototype:n,Ns=vu?vu.valueOf:n,pp=vu?vu.toString:n;function A(i){if(Gt(i)&&!Qe(i)&&!(i instanceof pt)){if(i instanceof qn)return i;if(bt.call(i,"__wrapped__"))return dd(i)}return new qn(i)}var Ta=function(){function i(){}return function(o){if(!Bt(o))return{};if(up)return up(o);i.prototype=o;var c=new i;return i.prototype=n,c}}();function mu(){}function qn(i,o){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=n}A.templateSettings={escape:Ms,evaluate:Ts,interpolate:_i,variable:"",imports:{_:A}},A.prototype=mu.prototype,A.prototype.constructor=A,qn.prototype=Ta(mu.prototype),qn.prototype.constructor=qn;function pt(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=oe,this.__views__=[]}function ex(){var i=new pt(this.__wrapped__);return i.__actions__=_n(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=_n(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=_n(this.__views__),i}function tx(){if(this.__filtered__){var i=new pt(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function nx(){var i=this.__wrapped__.value(),o=this.__dir__,c=Qe(i),g=o<0,_=c?i.length:0,L=dw(0,_,this.__views__),N=L.start,H=L.end,j=H-N,ae=g?H:N-1,se=this.__iteratees__,ce=se.length,ye=0,De=un(j,this.__takeCount__);if(!c||!g&&_==j&&De==j)return Np(i,this.__actions__);var Ge=[];e:for(;j--&&ye<De;){ae+=o;for(var it=-1,He=i[ae];++it<ce;){var ct=se[it],dt=ct.iteratee,Dn=ct.type,dn=dt(He);if(Dn==ee)He=dn;else if(!dn){if(Dn==D)continue e;break e}}Ge[ye++]=He}return Ge}pt.prototype=Ta(mu.prototype),pt.prototype.constructor=pt;function Si(i){var o=-1,c=i==null?0:i.length;for(this.clear();++o<c;){var g=i[o];this.set(g[0],g[1])}}function rx(){this.__data__=Fs?Fs(null):{},this.size=0}function ix(i){var o=this.has(i)&&delete this.__data__[i];return this.size-=o?1:0,o}function ax(i){var o=this.__data__;if(Fs){var c=o[i];return c===h?n:c}return bt.call(o,i)?o[i]:n}function sx(i){var o=this.__data__;return Fs?o[i]!==n:bt.call(o,i)}function ox(i,o){var c=this.__data__;return this.size+=this.has(i)?0:1,c[i]=Fs&&o===n?h:o,this}Si.prototype.clear=rx,Si.prototype.delete=ix,Si.prototype.get=ax,Si.prototype.has=sx,Si.prototype.set=ox;function Rr(i){var o=-1,c=i==null?0:i.length;for(this.clear();++o<c;){var g=i[o];this.set(g[0],g[1])}}function ux(){this.__data__=[],this.size=0}function fx(i){var o=this.__data__,c=gu(o,i);if(c<0)return!1;var g=o.length-1;return c==g?o.pop():hu.call(o,c,1),--this.size,!0}function hx(i){var o=this.__data__,c=gu(o,i);return c<0?n:o[c][1]}function cx(i){return gu(this.__data__,i)>-1}function lx(i,o){var c=this.__data__,g=gu(c,i);return g<0?(++this.size,c.push([i,o])):c[g][1]=o,this}Rr.prototype.clear=ux,Rr.prototype.delete=fx,Rr.prototype.get=hx,Rr.prototype.has=cx,Rr.prototype.set=lx;function Cr(i){var o=-1,c=i==null?0:i.length;for(this.clear();++o<c;){var g=i[o];this.set(g[0],g[1])}}function px(){this.size=0,this.__data__={hash:new Si,map:new(Os||Rr),string:new Si}}function dx(i){var o=Ru(this,i).delete(i);return this.size-=o?1:0,o}function vx(i){return Ru(this,i).get(i)}function mx(i){return Ru(this,i).has(i)}function gx(i,o){var c=Ru(this,i),g=c.size;return c.set(i,o),this.size+=c.size==g?0:1,this}Cr.prototype.clear=px,Cr.prototype.delete=dx,Cr.prototype.get=vx,Cr.prototype.has=mx,Cr.prototype.set=gx;function Ai(i){var o=-1,c=i==null?0:i.length;for(this.__data__=new Cr;++o<c;)this.add(i[o])}function yx(i){return this.__data__.set(i,h),this}function _x(i){return this.__data__.has(i)}Ai.prototype.add=Ai.prototype.push=yx,Ai.prototype.has=_x;function sr(i){var o=this.__data__=new Rr(i);this.size=o.size}function xx(){this.__data__=new Rr,this.size=0}function wx(i){var o=this.__data__,c=o.delete(i);return this.size=o.size,c}function bx(i){return this.__data__.get(i)}function Ex(i){return this.__data__.has(i)}function Mx(i,o){var c=this.__data__;if(c instanceof Rr){var g=c.__data__;if(!Os||g.length<a-1)return g.push([i,o]),this.size=++c.size,this;c=this.__data__=new Cr(g)}return c.set(i,o),this.size=c.size,this}sr.prototype.clear=xx,sr.prototype.delete=wx,sr.prototype.get=bx,sr.prototype.has=Ex,sr.prototype.set=Mx;function dp(i,o){var c=Qe(i),g=!c&&Ii(i),_=!c&&!g&&ni(i),L=!c&&!g&&!_&&Ra(i),N=c||g||_||L,H=N?oh(i.length,O_):[],j=H.length;for(var ae in i)(o||bt.call(i,ae))&&!(N&&(ae=="length"||_&&(ae=="offset"||ae=="parent")||L&&(ae=="buffer"||ae=="byteLength"||ae=="byteOffset")||Or(ae,j)))&&H.push(ae);return H}function vp(i){var o=i.length;return o?i[Mh(0,o-1)]:n}function Tx(i,o){return Cu(_n(i),Li(o,0,i.length))}function Sx(i){return Cu(_n(i))}function dh(i,o,c){(c!==n&&!or(i[o],c)||c===n&&!(o in i))&&Pr(i,o,c)}function Bs(i,o,c){var g=i[o];(!(bt.call(i,o)&&or(g,c))||c===n&&!(o in i))&&Pr(i,o,c)}function gu(i,o){for(var c=i.length;c--;)if(or(i[c][0],o))return c;return-1}function Ax(i,o,c,g){return Kr(i,function(_,L,N){o(g,_,c(_),N)}),g}function mp(i,o){return i&&_r(o,rn(o),i)}function Lx(i,o){return i&&_r(o,wn(o),i)}function Pr(i,o,c){o=="__proto__"&&cu?cu(i,o,{configurable:!0,enumerable:!0,value:c,writable:!0}):i[o]=c}function vh(i,o){for(var c=-1,g=o.length,_=ne(g),L=i==null;++c<g;)_[c]=L?n:Zh(i,o[c]);return _}function Li(i,o,c){return i===i&&(c!==n&&(i=i<=c?i:c),o!==n&&(i=i>=o?i:o)),i}function jn(i,o,c,g,_,L){var N,H=o&d,j=o&v,ae=o&m;if(c&&(N=_?c(i,g,_,L):c(i)),N!==n)return N;if(!Bt(i))return i;var se=Qe(i);if(se){if(N=mw(i),!H)return _n(i,N)}else{var ce=fn(i),ye=ce==ft||ce==gt;if(ni(i))return Gp(i,H);if(ce==Et||ce==Z||ye&&!_){if(N=j||ye?{}:ad(i),!H)return j?aw(i,Lx(N,i)):iw(i,mp(N,i))}else{if(!Ct[ce])return _?i:{};N=gw(i,ce,H)}}L||(L=new sr);var De=L.get(i);if(De)return De;L.set(i,N),Od(i)?i.forEach(function(He){N.add(jn(He,o,c,He,i,L))}):Id(i)&&i.forEach(function(He,ct){N.set(ct,jn(He,o,c,ct,i,L))});var Ge=ae?j?Uh:Oh:j?wn:rn,it=se?n:Ge(i);return Xn(it||i,function(He,ct){it&&(ct=He,He=i[ct]),Bs(N,ct,jn(He,o,c,ct,i,L))}),N}function Rx(i){var o=rn(i);return function(c){return gp(c,i,o)}}function gp(i,o,c){var g=c.length;if(i==null)return!g;for(i=St(i);g--;){var _=c[g],L=o[_],N=i[_];if(N===n&&!(_ in i)||!L(N))return!1}return!0}function yp(i,o,c){if(typeof i!="function")throw new Yn(u);return Xs(function(){i.apply(n,c)},o)}function zs(i,o,c,g){var _=-1,L=eu,N=!0,H=i.length,j=[],ae=o.length;if(!H)return j;c&&(o=Ot(o,Cn(c))),g?(L=th,N=!1):o.length>=a&&(L=Is,N=!1,o=new Ai(o));e:for(;++_<H;){var se=i[_],ce=c==null?se:c(se);if(se=g||se!==0?se:0,N&&ce===ce){for(var ye=ae;ye--;)if(o[ye]===ce)continue e;j.push(se)}else L(o,ce,g)||j.push(se)}return j}var Kr=Xp(yr),_p=Xp(gh,!0);function Cx(i,o){var c=!0;return Kr(i,function(g,_,L){return c=!!o(g,_,L),c}),c}function yu(i,o,c){for(var g=-1,_=i.length;++g<_;){var L=i[g],N=o(L);if(N!=null&&(H===n?N===N&&!In(N):c(N,H)))var H=N,j=L}return j}function Px(i,o,c,g){var _=i.length;for(c=tt(c),c<0&&(c=-c>_?0:_+c),g=g===n||g>_?_:tt(g),g<0&&(g+=_),g=c>g?0:Fd(g);c<g;)i[c++]=o;return i}function xp(i,o){var c=[];return Kr(i,function(g,_,L){o(g,_,L)&&c.push(g)}),c}function on(i,o,c,g,_){var L=-1,N=i.length;for(c||(c=_w),_||(_=[]);++L<N;){var H=i[L];o>0&&c(H)?o>1?on(H,o-1,c,g,_):Zr(_,H):g||(_[_.length]=H)}return _}var mh=Yp(),wp=Yp(!0);function yr(i,o){return i&&mh(i,o,rn)}function gh(i,o){return i&&wp(i,o,rn)}function _u(i,o){return jr(o,function(c){return Ur(i[c])})}function Ri(i,o){o=ei(o,i);for(var c=0,g=o.length;i!=null&&c<g;)i=i[xr(o[c++])];return c&&c==g?i:n}function bp(i,o,c){var g=o(i);return Qe(i)?g:Zr(g,c(i))}function ln(i){return i==null?i===n?q:Nt:Ti&&Ti in St(i)?pw(i):Sw(i)}function yh(i,o){return i>o}function Ix(i,o){return i!=null&&bt.call(i,o)}function Dx(i,o){return i!=null&&o in St(i)}function Ox(i,o,c){return i>=un(o,c)&&i<en(o,c)}function _h(i,o,c){for(var g=c?th:eu,_=i[0].length,L=i.length,N=L,H=ne(L),j=1/0,ae=[];N--;){var se=i[N];N&&o&&(se=Ot(se,Cn(o))),j=un(se.length,j),H[N]=!c&&(o||_>=120&&se.length>=120)?new Ai(N&&se):n}se=i[0];var ce=-1,ye=H[0];e:for(;++ce<_&&ae.length<j;){var De=se[ce],Ge=o?o(De):De;if(De=c||De!==0?De:0,!(ye?Is(ye,Ge):g(ae,Ge,c))){for(N=L;--N;){var it=H[N];if(!(it?Is(it,Ge):g(i[N],Ge,c)))continue e}ye&&ye.push(Ge),ae.push(De)}}return ae}function Ux(i,o,c,g){return yr(i,function(_,L,N){o(g,c(_),L,N)}),g}function Gs(i,o,c){o=ei(o,i),i=fd(i,o);var g=i==null?i:i[xr(Jn(o))];return g==null?n:Rn(g,i,c)}function Ep(i){return Gt(i)&&ln(i)==Z}function Fx(i){return Gt(i)&&ln(i)==Ne}function Nx(i){return Gt(i)&&ln(i)==de}function Hs(i,o,c,g,_){return i===o?!0:i==null||o==null||!Gt(i)&&!Gt(o)?i!==i&&o!==o:Bx(i,o,c,g,Hs,_)}function Bx(i,o,c,g,_,L){var N=Qe(i),H=Qe(o),j=N?Ce:fn(i),ae=H?Ce:fn(o);j=j==Z?Et:j,ae=ae==Z?Et:ae;var se=j==Et,ce=ae==Et,ye=j==ae;if(ye&&ni(i)){if(!ni(o))return!1;N=!0,se=!1}if(ye&&!se)return L||(L=new sr),N||Ra(i)?nd(i,o,c,g,_,L):cw(i,o,j,c,g,_,L);if(!(c&y)){var De=se&&bt.call(i,"__wrapped__"),Ge=ce&&bt.call(o,"__wrapped__");if(De||Ge){var it=De?i.value():i,He=Ge?o.value():o;return L||(L=new sr),_(it,He,c,g,L)}}return ye?(L||(L=new sr),lw(i,o,c,g,_,L)):!1}function zx(i){return Gt(i)&&fn(i)==st}function xh(i,o,c,g){var _=c.length,L=_,N=!g;if(i==null)return!L;for(i=St(i);_--;){var H=c[_];if(N&&H[2]?H[1]!==i[H[0]]:!(H[0]in i))return!1}for(;++_<L;){H=c[_];var j=H[0],ae=i[j],se=H[1];if(N&&H[2]){if(ae===n&&!(j in i))return!1}else{var ce=new sr;if(g)var ye=g(ae,se,j,i,o,ce);if(!(ye===n?Hs(se,ae,y|x,g,ce):ye))return!1}}return!0}function Mp(i){if(!Bt(i)||ww(i))return!1;var o=Ur(i)?z_:ke;return o.test(Pi(i))}function Gx(i){return Gt(i)&&ln(i)==an}function Hx(i){return Gt(i)&&fn(i)==ot}function Vx(i){return Gt(i)&&Fu(i.length)&&!!Pt[ln(i)]}function Tp(i){return typeof i=="function"?i:i==null?bn:typeof i=="object"?Qe(i)?Lp(i[0],i[1]):Ap(i):qd(i)}function wh(i){if(!ks(i))return X_(i);var o=[];for(var c in St(i))bt.call(i,c)&&c!="constructor"&&o.push(c);return o}function Wx(i){if(!Bt(i))return Tw(i);var o=ks(i),c=[];for(var g in i)g=="constructor"&&(o||!bt.call(i,g))||c.push(g);return c}function bh(i,o){return i<o}function Sp(i,o){var c=-1,g=xn(i)?ne(i.length):[];return Kr(i,function(_,L,N){g[++c]=o(_,L,N)}),g}function Ap(i){var o=Nh(i);return o.length==1&&o[0][2]?od(o[0][0],o[0][1]):function(c){return c===i||xh(c,i,o)}}function Lp(i,o){return zh(i)&&sd(o)?od(xr(i),o):function(c){var g=Zh(c,i);return g===n&&g===o?Jh(c,i):Hs(o,g,y|x)}}function xu(i,o,c,g,_){i!==o&&mh(o,function(L,N){if(_||(_=new sr),Bt(L))kx(i,o,N,c,xu,g,_);else{var H=g?g(Hh(i,N),L,N+"",i,o,_):n;H===n&&(H=L),dh(i,N,H)}},wn)}function kx(i,o,c,g,_,L,N){var H=Hh(i,c),j=Hh(o,c),ae=N.get(j);if(ae){dh(i,c,ae);return}var se=L?L(H,j,c+"",i,o,N):n,ce=se===n;if(ce){var ye=Qe(j),De=!ye&&ni(j),Ge=!ye&&!De&&Ra(j);se=j,ye||De||Ge?Qe(H)?se=H:kt(H)?se=_n(H):De?(ce=!1,se=Gp(j,!0)):Ge?(ce=!1,se=Hp(j,!0)):se=[]:Ys(j)||Ii(j)?(se=H,Ii(H)?se=Nd(H):(!Bt(H)||Ur(H))&&(se=ad(j))):ce=!1}ce&&(N.set(j,se),_(se,j,g,L,N),N.delete(j)),dh(i,c,se)}function Rp(i,o){var c=i.length;if(c)return o+=o<0?c:0,Or(o,c)?i[o]:n}function Cp(i,o,c){o.length?o=Ot(o,function(L){return Qe(L)?function(N){return Ri(N,L.length===1?L[0]:L)}:L}):o=[bn];var g=-1;o=Ot(o,Cn(ze()));var _=Sp(i,function(L,N,H){var j=Ot(o,function(ae){return ae(L)});return{criteria:j,index:++g,value:L}});return g_(_,function(L,N){return rw(L,N,c)})}function Xx(i,o){return Pp(i,o,function(c,g){return Jh(i,g)})}function Pp(i,o,c){for(var g=-1,_=o.length,L={};++g<_;){var N=o[g],H=Ri(i,N);c(H,N)&&Vs(L,ei(N,i),H)}return L}function Yx(i){return function(o){return Ri(o,i)}}function Eh(i,o,c,g){var _=g?m_:ya,L=-1,N=o.length,H=i;for(i===o&&(o=_n(o)),c&&(H=Ot(i,Cn(c)));++L<N;)for(var j=0,ae=o[L],se=c?c(ae):ae;(j=_(H,se,j,g))>-1;)H!==i&&hu.call(H,j,1),hu.call(i,j,1);return i}function Ip(i,o){for(var c=i?o.length:0,g=c-1;c--;){var _=o[c];if(c==g||_!==L){var L=_;Or(_)?hu.call(i,_,1):Ah(i,_)}}return i}function Mh(i,o){return i+pu(lp()*(o-i+1))}function qx(i,o,c,g){for(var _=-1,L=en(lu((o-i)/(c||1)),0),N=ne(L);L--;)N[g?L:++_]=i,i+=c;return N}function Th(i,o){var c="";if(!i||o<1||o>$)return c;do o%2&&(c+=i),o=pu(o/2),o&&(i+=i);while(o);return c}function ut(i,o){return Vh(ud(i,o,bn),i+"")}function jx(i){return vp(Ca(i))}function Zx(i,o){var c=Ca(i);return Cu(c,Li(o,0,c.length))}function Vs(i,o,c,g){if(!Bt(i))return i;o=ei(o,i);for(var _=-1,L=o.length,N=L-1,H=i;H!=null&&++_<L;){var j=xr(o[_]),ae=c;if(j==="__proto__"||j==="constructor"||j==="prototype")return i;if(_!=N){var se=H[j];ae=g?g(se,j,H):n,ae===n&&(ae=Bt(se)?se:Or(o[_+1])?[]:{})}Bs(H,j,ae),H=H[j]}return i}var Dp=du?function(i,o){return du.set(i,o),i}:bn,Jx=cu?function(i,o){return cu(i,"toString",{configurable:!0,enumerable:!1,value:Kh(o),writable:!0})}:bn;function Qx(i){return Cu(Ca(i))}function Zn(i,o,c){var g=-1,_=i.length;o<0&&(o=-o>_?0:_+o),c=c>_?_:c,c<0&&(c+=_),_=o>c?0:c-o>>>0,o>>>=0;for(var L=ne(_);++g<_;)L[g]=i[g+o];return L}function Kx(i,o){var c;return Kr(i,function(g,_,L){return c=o(g,_,L),!c}),!!c}function wu(i,o,c){var g=0,_=i==null?g:i.length;if(typeof o=="number"&&o===o&&_<=pe){for(;g<_;){var L=g+_>>>1,N=i[L];N!==null&&!In(N)&&(c?N<=o:N<o)?g=L+1:_=L}return _}return Sh(i,o,bn,c)}function Sh(i,o,c,g){var _=0,L=i==null?0:i.length;if(L===0)return 0;o=c(o);for(var N=o!==o,H=o===null,j=In(o),ae=o===n;_<L;){var se=pu((_+L)/2),ce=c(i[se]),ye=ce!==n,De=ce===null,Ge=ce===ce,it=In(ce);if(N)var He=g||Ge;else ae?He=Ge&&(g||ye):H?He=Ge&&ye&&(g||!De):j?He=Ge&&ye&&!De&&(g||!it):De||it?He=!1:He=g?ce<=o:ce<o;He?_=se+1:L=se}return un(L,ve)}function Op(i,o){for(var c=-1,g=i.length,_=0,L=[];++c<g;){var N=i[c],H=o?o(N):N;if(!c||!or(H,j)){var j=H;L[_++]=N===0?0:N}}return L}function Up(i){return typeof i=="number"?i:In(i)?he:+i}function Pn(i){if(typeof i=="string")return i;if(Qe(i))return Ot(i,Pn)+"";if(In(i))return pp?pp.call(i):"";var o=i+"";return o=="0"&&1/i==-te?"-0":o}function $r(i,o,c){var g=-1,_=eu,L=i.length,N=!0,H=[],j=H;if(c)N=!1,_=th;else if(L>=a){var ae=o?null:fw(i);if(ae)return nu(ae);N=!1,_=Is,j=new Ai}else j=o?[]:H;e:for(;++g<L;){var se=i[g],ce=o?o(se):se;if(se=c||se!==0?se:0,N&&ce===ce){for(var ye=j.length;ye--;)if(j[ye]===ce)continue e;o&&j.push(ce),H.push(se)}else _(j,ce,c)||(j!==H&&j.push(ce),H.push(se))}return H}function Ah(i,o){return o=ei(o,i),i=fd(i,o),i==null||delete i[xr(Jn(o))]}function Fp(i,o,c,g){return Vs(i,o,c(Ri(i,o)),g)}function bu(i,o,c,g){for(var _=i.length,L=g?_:-1;(g?L--:++L<_)&&o(i[L],L,i););return c?Zn(i,g?0:L,g?L+1:_):Zn(i,g?L+1:0,g?_:L)}function Np(i,o){var c=i;return c instanceof pt&&(c=c.value()),nh(o,function(g,_){return _.func.apply(_.thisArg,Zr([g],_.args))},c)}function Lh(i,o,c){var g=i.length;if(g<2)return g?$r(i[0]):[];for(var _=-1,L=ne(g);++_<g;)for(var N=i[_],H=-1;++H<g;)H!=_&&(L[_]=zs(L[_]||N,i[H],o,c));return $r(on(L,1),o,c)}function Bp(i,o,c){for(var g=-1,_=i.length,L=o.length,N={};++g<_;){var H=g<L?o[g]:n;c(N,i[g],H)}return N}function Rh(i){return kt(i)?i:[]}function Ch(i){return typeof i=="function"?i:bn}function ei(i,o){return Qe(i)?i:zh(i,o)?[i]:pd(xt(i))}var $x=ut;function ti(i,o,c){var g=i.length;return c=c===n?g:c,!o&&c>=g?i:Zn(i,o,c)}var zp=G_||function(i){return sn.clearTimeout(i)};function Gp(i,o){if(o)return i.slice();var c=i.length,g=op?op(c):new i.constructor(c);return i.copy(g),g}function Ph(i){var o=new i.constructor(i.byteLength);return new uu(o).set(new uu(i)),o}function ew(i,o){var c=o?Ph(i.buffer):i.buffer;return new i.constructor(c,i.byteOffset,i.byteLength)}function tw(i){var o=new i.constructor(i.source,fe.exec(i));return o.lastIndex=i.lastIndex,o}function nw(i){return Ns?St(Ns.call(i)):{}}function Hp(i,o){var c=o?Ph(i.buffer):i.buffer;return new i.constructor(c,i.byteOffset,i.length)}function Vp(i,o){if(i!==o){var c=i!==n,g=i===null,_=i===i,L=In(i),N=o!==n,H=o===null,j=o===o,ae=In(o);if(!H&&!ae&&!L&&i>o||L&&N&&j&&!H&&!ae||g&&N&&j||!c&&j||!_)return 1;if(!g&&!L&&!ae&&i<o||ae&&c&&_&&!g&&!L||H&&c&&_||!N&&_||!j)return-1}return 0}function rw(i,o,c){for(var g=-1,_=i.criteria,L=o.criteria,N=_.length,H=c.length;++g<N;){var j=Vp(_[g],L[g]);if(j){if(g>=H)return j;var ae=c[g];return j*(ae=="desc"?-1:1)}}return i.index-o.index}function Wp(i,o,c,g){for(var _=-1,L=i.length,N=c.length,H=-1,j=o.length,ae=en(L-N,0),se=ne(j+ae),ce=!g;++H<j;)se[H]=o[H];for(;++_<N;)(ce||_<L)&&(se[c[_]]=i[_]);for(;ae--;)se[H++]=i[_++];return se}function kp(i,o,c,g){for(var _=-1,L=i.length,N=-1,H=c.length,j=-1,ae=o.length,se=en(L-H,0),ce=ne(se+ae),ye=!g;++_<se;)ce[_]=i[_];for(var De=_;++j<ae;)ce[De+j]=o[j];for(;++N<H;)(ye||_<L)&&(ce[De+c[N]]=i[_++]);return ce}function _n(i,o){var c=-1,g=i.length;for(o||(o=ne(g));++c<g;)o[c]=i[c];return o}function _r(i,o,c,g){var _=!c;c||(c={});for(var L=-1,N=o.length;++L<N;){var H=o[L],j=g?g(c[H],i[H],H,c,i):n;j===n&&(j=i[H]),_?Pr(c,H,j):Bs(c,H,j)}return c}function iw(i,o){return _r(i,Bh(i),o)}function aw(i,o){return _r(i,rd(i),o)}function Eu(i,o){return function(c,g){var _=Qe(c)?h_:Ax,L=o?o():{};return _(c,i,ze(g,2),L)}}function Sa(i){return ut(function(o,c){var g=-1,_=c.length,L=_>1?c[_-1]:n,N=_>2?c[2]:n;for(L=i.length>3&&typeof L=="function"?(_--,L):n,N&&pn(c[0],c[1],N)&&(L=_<3?n:L,_=1),o=St(o);++g<_;){var H=c[g];H&&i(o,H,g,L)}return o})}function Xp(i,o){return function(c,g){if(c==null)return c;if(!xn(c))return i(c,g);for(var _=c.length,L=o?_:-1,N=St(c);(o?L--:++L<_)&&g(N[L],L,N)!==!1;);return c}}function Yp(i){return function(o,c,g){for(var _=-1,L=St(o),N=g(o),H=N.length;H--;){var j=N[i?H:++_];if(c(L[j],j,L)===!1)break}return o}}function sw(i,o,c){var g=o&b,_=Ws(i);function L(){var N=this&&this!==sn&&this instanceof L?_:i;return N.apply(g?c:this,arguments)}return L}function qp(i){return function(o){o=xt(o);var c=_a(o)?ar(o):n,g=c?c[0]:o.charAt(0),_=c?ti(c,1).join(""):o.slice(1);return g[i]()+_}}function Aa(i){return function(o){return nh(Xd(kd(o).replace(J0,"")),i,"")}}function Ws(i){return function(){var o=arguments;switch(o.length){case 0:return new i;case 1:return new i(o[0]);case 2:return new i(o[0],o[1]);case 3:return new i(o[0],o[1],o[2]);case 4:return new i(o[0],o[1],o[2],o[3]);case 5:return new i(o[0],o[1],o[2],o[3],o[4]);case 6:return new i(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new i(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var c=Ta(i.prototype),g=i.apply(c,o);return Bt(g)?g:c}}function ow(i,o,c){var g=Ws(i);function _(){for(var L=arguments.length,N=ne(L),H=L,j=La(_);H--;)N[H]=arguments[H];var ae=L<3&&N[0]!==j&&N[L-1]!==j?[]:Jr(N,j);if(L-=ae.length,L<c)return Kp(i,o,Mu,_.placeholder,n,N,ae,n,n,c-L);var se=this&&this!==sn&&this instanceof _?g:i;return Rn(se,this,N)}return _}function jp(i){return function(o,c,g){var _=St(o);if(!xn(o)){var L=ze(c,3);o=rn(o),c=function(H){return L(_[H],H,_)}}var N=i(o,c,g);return N>-1?_[L?o[N]:N]:n}}function Zp(i){return Dr(function(o){var c=o.length,g=c,_=qn.prototype.thru;for(i&&o.reverse();g--;){var L=o[g];if(typeof L!="function")throw new Yn(u);if(_&&!N&&Lu(L)=="wrapper")var N=new qn([],!0)}for(g=N?g:c;++g<c;){L=o[g];var H=Lu(L),j=H=="wrapper"?Fh(L):n;j&&Gh(j[0])&&j[1]==(U|T|P|W)&&!j[4].length&&j[9]==1?N=N[Lu(j[0])].apply(N,j[3]):N=L.length==1&&Gh(L)?N[H]():N.thru(L)}return function(){var ae=arguments,se=ae[0];if(N&&ae.length==1&&Qe(se))return N.plant(se).value();for(var ce=0,ye=c?o[ce].apply(this,ae):se;++ce<c;)ye=o[ce].call(this,ye);return ye}})}function Mu(i,o,c,g,_,L,N,H,j,ae){var se=o&U,ce=o&b,ye=o&w,De=o&(T|M),Ge=o&B,it=ye?n:Ws(i);function He(){for(var ct=arguments.length,dt=ne(ct),Dn=ct;Dn--;)dt[Dn]=arguments[Dn];if(De)var dn=La(He),On=__(dt,dn);if(g&&(dt=Wp(dt,g,_,De)),L&&(dt=kp(dt,L,N,De)),ct-=On,De&&ct<ae){var Xt=Jr(dt,dn);return Kp(i,o,Mu,He.placeholder,c,dt,Xt,H,j,ae-ct)}var ur=ce?c:this,Nr=ye?ur[i]:i;return ct=dt.length,H?dt=Aw(dt,H):Ge&&ct>1&&dt.reverse(),se&&j<ct&&(dt.length=j),this&&this!==sn&&this instanceof He&&(Nr=it||Ws(Nr)),Nr.apply(ur,dt)}return He}function Jp(i,o){return function(c,g){return Ux(c,i,o(g),{})}}function Tu(i,o){return function(c,g){var _;if(c===n&&g===n)return o;if(c!==n&&(_=c),g!==n){if(_===n)return g;typeof c=="string"||typeof g=="string"?(c=Pn(c),g=Pn(g)):(c=Up(c),g=Up(g)),_=i(c,g)}return _}}function Ih(i){return Dr(function(o){return o=Ot(o,Cn(ze())),ut(function(c){var g=this;return i(o,function(_){return Rn(_,g,c)})})})}function Su(i,o){o=o===n?" ":Pn(o);var c=o.length;if(c<2)return c?Th(o,i):o;var g=Th(o,lu(i/xa(o)));return _a(o)?ti(ar(g),0,i).join(""):g.slice(0,i)}function uw(i,o,c,g){var _=o&b,L=Ws(i);function N(){for(var H=-1,j=arguments.length,ae=-1,se=g.length,ce=ne(se+j),ye=this&&this!==sn&&this instanceof N?L:i;++ae<se;)ce[ae]=g[ae];for(;j--;)ce[ae++]=arguments[++H];return Rn(ye,_?c:this,ce)}return N}function Qp(i){return function(o,c,g){return g&&typeof g!="number"&&pn(o,c,g)&&(c=g=n),o=Fr(o),c===n?(c=o,o=0):c=Fr(c),g=g===n?o<c?1:-1:Fr(g),qx(o,c,g,i)}}function Au(i){return function(o,c){return typeof o=="string"&&typeof c=="string"||(o=Qn(o),c=Qn(c)),i(o,c)}}function Kp(i,o,c,g,_,L,N,H,j,ae){var se=o&T,ce=se?N:n,ye=se?n:N,De=se?L:n,Ge=se?n:L;o|=se?P:O,o&=~(se?O:P),o&E||(o&=~(b|w));var it=[i,o,_,De,ce,Ge,ye,H,j,ae],He=c.apply(n,it);return Gh(i)&&hd(He,it),He.placeholder=g,cd(He,i,o)}function Dh(i){var o=$t[i];return function(c,g){if(c=Qn(c),g=g==null?0:un(tt(g),292),g&&cp(c)){var _=(xt(c)+"e").split("e"),L=o(_[0]+"e"+(+_[1]+g));return _=(xt(L)+"e").split("e"),+(_[0]+"e"+(+_[1]-g))}return o(c)}}var fw=Ea&&1/nu(new Ea([,-0]))[1]==te?function(i){return new Ea(i)}:tc;function $p(i){return function(o){var c=fn(o);return c==st?fh(o):c==ot?S_(o):y_(o,i(o))}}function Ir(i,o,c,g,_,L,N,H){var j=o&w;if(!j&&typeof i!="function")throw new Yn(u);var ae=g?g.length:0;if(ae||(o&=~(P|O),g=_=n),N=N===n?N:en(tt(N),0),H=H===n?H:tt(H),ae-=_?_.length:0,o&O){var se=g,ce=_;g=_=n}var ye=j?n:Fh(i),De=[i,o,c,g,_,se,ce,L,N,H];if(ye&&Mw(De,ye),i=De[0],o=De[1],c=De[2],g=De[3],_=De[4],H=De[9]=De[9]===n?j?0:i.length:en(De[9]-ae,0),!H&&o&(T|M)&&(o&=~(T|M)),!o||o==b)var Ge=sw(i,o,c);else o==T||o==M?Ge=ow(i,o,H):(o==P||o==(b|P))&&!_.length?Ge=uw(i,o,c,g):Ge=Mu.apply(n,De);var it=ye?Dp:hd;return cd(it(Ge,De),i,o)}function ed(i,o,c,g){return i===n||or(i,ba[c])&&!bt.call(g,c)?o:i}function td(i,o,c,g,_,L){return Bt(i)&&Bt(o)&&(L.set(o,i),xu(i,o,n,td,L),L.delete(o)),i}function hw(i){return Ys(i)?n:i}function nd(i,o,c,g,_,L){var N=c&y,H=i.length,j=o.length;if(H!=j&&!(N&&j>H))return!1;var ae=L.get(i),se=L.get(o);if(ae&&se)return ae==o&&se==i;var ce=-1,ye=!0,De=c&x?new Ai:n;for(L.set(i,o),L.set(o,i);++ce<H;){var Ge=i[ce],it=o[ce];if(g)var He=N?g(it,Ge,ce,o,i,L):g(Ge,it,ce,i,o,L);if(He!==n){if(He)continue;ye=!1;break}if(De){if(!rh(o,function(ct,dt){if(!Is(De,dt)&&(Ge===ct||_(Ge,ct,c,g,L)))return De.push(dt)})){ye=!1;break}}else if(!(Ge===it||_(Ge,it,c,g,L))){ye=!1;break}}return L.delete(i),L.delete(o),ye}function cw(i,o,c,g,_,L,N){switch(c){case be:if(i.byteLength!=o.byteLength||i.byteOffset!=o.byteOffset)return!1;i=i.buffer,o=o.buffer;case Ne:return!(i.byteLength!=o.byteLength||!L(new uu(i),new uu(o)));case Pe:case de:case Je:return or(+i,+o);case Ze:return i.name==o.name&&i.message==o.message;case an:case zt:return i==o+"";case st:var H=fh;case ot:var j=g&y;if(H||(H=nu),i.size!=o.size&&!j)return!1;var ae=N.get(i);if(ae)return ae==o;g|=x,N.set(i,o);var se=nd(H(i),H(o),g,_,L,N);return N.delete(i),se;case $e:if(Ns)return Ns.call(i)==Ns.call(o)}return!1}function lw(i,o,c,g,_,L){var N=c&y,H=Oh(i),j=H.length,ae=Oh(o),se=ae.length;if(j!=se&&!N)return!1;for(var ce=j;ce--;){var ye=H[ce];if(!(N?ye in o:bt.call(o,ye)))return!1}var De=L.get(i),Ge=L.get(o);if(De&&Ge)return De==o&&Ge==i;var it=!0;L.set(i,o),L.set(o,i);for(var He=N;++ce<j;){ye=H[ce];var ct=i[ye],dt=o[ye];if(g)var Dn=N?g(dt,ct,ye,o,i,L):g(ct,dt,ye,i,o,L);if(!(Dn===n?ct===dt||_(ct,dt,c,g,L):Dn)){it=!1;break}He||(He=ye=="constructor")}if(it&&!He){var dn=i.constructor,On=o.constructor;dn!=On&&"constructor"in i&&"constructor"in o&&!(typeof dn=="function"&&dn instanceof dn&&typeof On=="function"&&On instanceof On)&&(it=!1)}return L.delete(i),L.delete(o),it}function Dr(i){return Vh(ud(i,n,gd),i+"")}function Oh(i){return bp(i,rn,Bh)}function Uh(i){return bp(i,wn,rd)}var Fh=du?function(i){return du.get(i)}:tc;function Lu(i){for(var o=i.name+"",c=Ma[o],g=bt.call(Ma,o)?c.length:0;g--;){var _=c[g],L=_.func;if(L==null||L==i)return _.name}return o}function La(i){var o=bt.call(A,"placeholder")?A:i;return o.placeholder}function ze(){var i=A.iteratee||$h;return i=i===$h?Tp:i,arguments.length?i(arguments[0],arguments[1]):i}function Ru(i,o){var c=i.__data__;return xw(o)?c[typeof o=="string"?"string":"hash"]:c.map}function Nh(i){for(var o=rn(i),c=o.length;c--;){var g=o[c],_=i[g];o[c]=[g,_,sd(_)]}return o}function Ci(i,o){var c=E_(i,o);return Mp(c)?c:n}function pw(i){var o=bt.call(i,Ti),c=i[Ti];try{i[Ti]=n;var g=!0}catch{}var _=su.call(i);return g&&(o?i[Ti]=c:delete i[Ti]),_}var Bh=ch?function(i){return i==null?[]:(i=St(i),jr(ch(i),function(o){return fp.call(i,o)}))}:nc,rd=ch?function(i){for(var o=[];i;)Zr(o,Bh(i)),i=fu(i);return o}:nc,fn=ln;(lh&&fn(new lh(new ArrayBuffer(1)))!=be||Os&&fn(new Os)!=st||ph&&fn(ph.resolve())!=Lt||Ea&&fn(new Ea)!=ot||Us&&fn(new Us)!=ge)&&(fn=function(i){var o=ln(i),c=o==Et?i.constructor:n,g=c?Pi(c):"";if(g)switch(g){case Z_:return be;case J_:return st;case Q_:return Lt;case K_:return ot;case $_:return ge}return o});function dw(i,o,c){for(var g=-1,_=c.length;++g<_;){var L=c[g],N=L.size;switch(L.type){case"drop":i+=N;break;case"dropRight":o-=N;break;case"take":o=un(o,i+N);break;case"takeRight":i=en(i,o-N);break}}return{start:i,end:o}}function vw(i){var o=i.match(Ls);return o?o[1].split(la):[]}function id(i,o,c){o=ei(o,i);for(var g=-1,_=o.length,L=!1;++g<_;){var N=xr(o[g]);if(!(L=i!=null&&c(i,N)))break;i=i[N]}return L||++g!=_?L:(_=i==null?0:i.length,!!_&&Fu(_)&&Or(N,_)&&(Qe(i)||Ii(i)))}function mw(i){var o=i.length,c=new i.constructor(o);return o&&typeof i[0]=="string"&&bt.call(i,"index")&&(c.index=i.index,c.input=i.input),c}function ad(i){return typeof i.constructor=="function"&&!ks(i)?Ta(fu(i)):{}}function gw(i,o,c){var g=i.constructor;switch(o){case Ne:return Ph(i);case Pe:case de:return new g(+i);case be:return ew(i,c);case et:case lt:case ht:case Rt:case mt:case Jt:case Qt:case Gn:case dr:return Hp(i,c);case st:return new g;case Je:case zt:return new g(i);case an:return tw(i);case ot:return new g;case $e:return nw(i)}}function yw(i,o){var c=o.length;if(!c)return i;var g=c-1;return o[g]=(c>1?"& ":"")+o[g],o=o.join(c>2?", ":" "),i.replace(wi,`{
/* [wrapped with `+o+`] */
`)}function _w(i){return Qe(i)||Ii(i)||!!(hp&&i&&i[hp])}function Or(i,o){var c=typeof i;return o=o??$,!!o&&(c=="number"||c!="symbol"&&qe.test(i))&&i>-1&&i%1==0&&i<o}function pn(i,o,c){if(!Bt(c))return!1;var g=typeof o;return(g=="number"?xn(c)&&Or(o,c.length):g=="string"&&o in c)?or(c[o],i):!1}function zh(i,o){if(Qe(i))return!1;var c=typeof i;return c=="number"||c=="symbol"||c=="boolean"||i==null||In(i)?!0:As.test(i)||!Ss.test(i)||o!=null&&i in St(o)}function xw(i){var o=typeof i;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?i!=="__proto__":i===null}function Gh(i){var o=Lu(i),c=A[o];if(typeof c!="function"||!(o in pt.prototype))return!1;if(i===c)return!0;var g=Fh(c);return!!g&&i===g[0]}function ww(i){return!!sp&&sp in i}var bw=iu?Ur:rc;function ks(i){var o=i&&i.constructor,c=typeof o=="function"&&o.prototype||ba;return i===c}function sd(i){return i===i&&!Bt(i)}function od(i,o){return function(c){return c==null?!1:c[i]===o&&(o!==n||i in St(c))}}function Ew(i){var o=Ou(i,function(g){return c.size===l&&c.clear(),g}),c=o.cache;return o}function Mw(i,o){var c=i[1],g=o[1],_=c|g,L=_<(b|w|U),N=g==U&&c==T||g==U&&c==W&&i[7].length<=o[8]||g==(U|W)&&o[7].length<=o[8]&&c==T;if(!(L||N))return i;g&b&&(i[2]=o[2],_|=c&b?0:E);var H=o[3];if(H){var j=i[3];i[3]=j?Wp(j,H,o[4]):H,i[4]=j?Jr(i[3],p):o[4]}return H=o[5],H&&(j=i[5],i[5]=j?kp(j,H,o[6]):H,i[6]=j?Jr(i[5],p):o[6]),H=o[7],H&&(i[7]=H),g&U&&(i[8]=i[8]==null?o[8]:un(i[8],o[8])),i[9]==null&&(i[9]=o[9]),i[0]=o[0],i[1]=_,i}function Tw(i){var o=[];if(i!=null)for(var c in St(i))o.push(c);return o}function Sw(i){return su.call(i)}function ud(i,o,c){return o=en(o===n?i.length-1:o,0),function(){for(var g=arguments,_=-1,L=en(g.length-o,0),N=ne(L);++_<L;)N[_]=g[o+_];_=-1;for(var H=ne(o+1);++_<o;)H[_]=g[_];return H[o]=c(N),Rn(i,this,H)}}function fd(i,o){return o.length<2?i:Ri(i,Zn(o,0,-1))}function Aw(i,o){for(var c=i.length,g=un(o.length,c),_=_n(i);g--;){var L=o[g];i[g]=Or(L,c)?_[L]:n}return i}function Hh(i,o){if(!(o==="constructor"&&typeof i[o]=="function")&&o!="__proto__")return i[o]}var hd=ld(Dp),Xs=V_||function(i,o){return sn.setTimeout(i,o)},Vh=ld(Jx);function cd(i,o,c){var g=o+"";return Vh(i,yw(g,Lw(vw(g),c)))}function ld(i){var o=0,c=0;return function(){var g=Y_(),_=z-(g-c);if(c=g,_>0){if(++o>=re)return arguments[0]}else o=0;return i.apply(n,arguments)}}function Cu(i,o){var c=-1,g=i.length,_=g-1;for(o=o===n?g:o;++c<o;){var L=Mh(c,_),N=i[L];i[L]=i[c],i[c]=N}return i.length=o,i}var pd=Ew(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(fa,function(c,g,_,L){o.push(_?L.replace(F,"$1"):g||c)}),o});function xr(i){if(typeof i=="string"||In(i))return i;var o=i+"";return o=="0"&&1/i==-te?"-0":o}function Pi(i){if(i!=null){try{return au.call(i)}catch{}try{return i+""}catch{}}return""}function Lw(i,o){return Xn(Ae,function(c){var g="_."+c[0];o&c[1]&&!eu(i,g)&&i.push(g)}),i.sort()}function dd(i){if(i instanceof pt)return i.clone();var o=new qn(i.__wrapped__,i.__chain__);return o.__actions__=_n(i.__actions__),o.__index__=i.__index__,o.__values__=i.__values__,o}function Rw(i,o,c){(c?pn(i,o,c):o===n)?o=1:o=en(tt(o),0);var g=i==null?0:i.length;if(!g||o<1)return[];for(var _=0,L=0,N=ne(lu(g/o));_<g;)N[L++]=Zn(i,_,_+=o);return N}function Cw(i){for(var o=-1,c=i==null?0:i.length,g=0,_=[];++o<c;){var L=i[o];L&&(_[g++]=L)}return _}function Pw(){var i=arguments.length;if(!i)return[];for(var o=ne(i-1),c=arguments[0],g=i;g--;)o[g-1]=arguments[g];return Zr(Qe(c)?_n(c):[c],on(o,1))}var Iw=ut(function(i,o){return kt(i)?zs(i,on(o,1,kt,!0)):[]}),Dw=ut(function(i,o){var c=Jn(o);return kt(c)&&(c=n),kt(i)?zs(i,on(o,1,kt,!0),ze(c,2)):[]}),Ow=ut(function(i,o){var c=Jn(o);return kt(c)&&(c=n),kt(i)?zs(i,on(o,1,kt,!0),n,c):[]});function Uw(i,o,c){var g=i==null?0:i.length;return g?(o=c||o===n?1:tt(o),Zn(i,o<0?0:o,g)):[]}function Fw(i,o,c){var g=i==null?0:i.length;return g?(o=c||o===n?1:tt(o),o=g-o,Zn(i,0,o<0?0:o)):[]}function Nw(i,o){return i&&i.length?bu(i,ze(o,3),!0,!0):[]}function Bw(i,o){return i&&i.length?bu(i,ze(o,3),!0):[]}function zw(i,o,c,g){var _=i==null?0:i.length;return _?(c&&typeof c!="number"&&pn(i,o,c)&&(c=0,g=_),Px(i,o,c,g)):[]}function vd(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var _=c==null?0:tt(c);return _<0&&(_=en(g+_,0)),tu(i,ze(o,3),_)}function md(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var _=g-1;return c!==n&&(_=tt(c),_=c<0?en(g+_,0):un(_,g-1)),tu(i,ze(o,3),_,!0)}function gd(i){var o=i==null?0:i.length;return o?on(i,1):[]}function Gw(i){var o=i==null?0:i.length;return o?on(i,te):[]}function Hw(i,o){var c=i==null?0:i.length;return c?(o=o===n?1:tt(o),on(i,o)):[]}function Vw(i){for(var o=-1,c=i==null?0:i.length,g={};++o<c;){var _=i[o];g[_[0]]=_[1]}return g}function yd(i){return i&&i.length?i[0]:n}function Ww(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var _=c==null?0:tt(c);return _<0&&(_=en(g+_,0)),ya(i,o,_)}function kw(i){var o=i==null?0:i.length;return o?Zn(i,0,-1):[]}var Xw=ut(function(i){var o=Ot(i,Rh);return o.length&&o[0]===i[0]?_h(o):[]}),Yw=ut(function(i){var o=Jn(i),c=Ot(i,Rh);return o===Jn(c)?o=n:c.pop(),c.length&&c[0]===i[0]?_h(c,ze(o,2)):[]}),qw=ut(function(i){var o=Jn(i),c=Ot(i,Rh);return o=typeof o=="function"?o:n,o&&c.pop(),c.length&&c[0]===i[0]?_h(c,n,o):[]});function jw(i,o){return i==null?"":k_.call(i,o)}function Jn(i){var o=i==null?0:i.length;return o?i[o-1]:n}function Zw(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var _=g;return c!==n&&(_=tt(c),_=_<0?en(g+_,0):un(_,g-1)),o===o?L_(i,o,_):tu(i,Kl,_,!0)}function Jw(i,o){return i&&i.length?Rp(i,tt(o)):n}var Qw=ut(_d);function _d(i,o){return i&&i.length&&o&&o.length?Eh(i,o):i}function Kw(i,o,c){return i&&i.length&&o&&o.length?Eh(i,o,ze(c,2)):i}function $w(i,o,c){return i&&i.length&&o&&o.length?Eh(i,o,n,c):i}var eb=Dr(function(i,o){var c=i==null?0:i.length,g=vh(i,o);return Ip(i,Ot(o,function(_){return Or(_,c)?+_:_}).sort(Vp)),g});function tb(i,o){var c=[];if(!(i&&i.length))return c;var g=-1,_=[],L=i.length;for(o=ze(o,3);++g<L;){var N=i[g];o(N,g,i)&&(c.push(N),_.push(g))}return Ip(i,_),c}function Wh(i){return i==null?i:j_.call(i)}function nb(i,o,c){var g=i==null?0:i.length;return g?(c&&typeof c!="number"&&pn(i,o,c)?(o=0,c=g):(o=o==null?0:tt(o),c=c===n?g:tt(c)),Zn(i,o,c)):[]}function rb(i,o){return wu(i,o)}function ib(i,o,c){return Sh(i,o,ze(c,2))}function ab(i,o){var c=i==null?0:i.length;if(c){var g=wu(i,o);if(g<c&&or(i[g],o))return g}return-1}function sb(i,o){return wu(i,o,!0)}function ob(i,o,c){return Sh(i,o,ze(c,2),!0)}function ub(i,o){var c=i==null?0:i.length;if(c){var g=wu(i,o,!0)-1;if(or(i[g],o))return g}return-1}function fb(i){return i&&i.length?Op(i):[]}function hb(i,o){return i&&i.length?Op(i,ze(o,2)):[]}function cb(i){var o=i==null?0:i.length;return o?Zn(i,1,o):[]}function lb(i,o,c){return i&&i.length?(o=c||o===n?1:tt(o),Zn(i,0,o<0?0:o)):[]}function pb(i,o,c){var g=i==null?0:i.length;return g?(o=c||o===n?1:tt(o),o=g-o,Zn(i,o<0?0:o,g)):[]}function db(i,o){return i&&i.length?bu(i,ze(o,3),!1,!0):[]}function vb(i,o){return i&&i.length?bu(i,ze(o,3)):[]}var mb=ut(function(i){return $r(on(i,1,kt,!0))}),gb=ut(function(i){var o=Jn(i);return kt(o)&&(o=n),$r(on(i,1,kt,!0),ze(o,2))}),yb=ut(function(i){var o=Jn(i);return o=typeof o=="function"?o:n,$r(on(i,1,kt,!0),n,o)});function _b(i){return i&&i.length?$r(i):[]}function xb(i,o){return i&&i.length?$r(i,ze(o,2)):[]}function wb(i,o){return o=typeof o=="function"?o:n,i&&i.length?$r(i,n,o):[]}function kh(i){if(!(i&&i.length))return[];var o=0;return i=jr(i,function(c){if(kt(c))return o=en(c.length,o),!0}),oh(o,function(c){return Ot(i,ih(c))})}function xd(i,o){if(!(i&&i.length))return[];var c=kh(i);return o==null?c:Ot(c,function(g){return Rn(o,n,g)})}var bb=ut(function(i,o){return kt(i)?zs(i,o):[]}),Eb=ut(function(i){return Lh(jr(i,kt))}),Mb=ut(function(i){var o=Jn(i);return kt(o)&&(o=n),Lh(jr(i,kt),ze(o,2))}),Tb=ut(function(i){var o=Jn(i);return o=typeof o=="function"?o:n,Lh(jr(i,kt),n,o)}),Sb=ut(kh);function Ab(i,o){return Bp(i||[],o||[],Bs)}function Lb(i,o){return Bp(i||[],o||[],Vs)}var Rb=ut(function(i){var o=i.length,c=o>1?i[o-1]:n;return c=typeof c=="function"?(i.pop(),c):n,xd(i,c)});function wd(i){var o=A(i);return o.__chain__=!0,o}function Cb(i,o){return o(i),i}function Pu(i,o){return o(i)}var Pb=Dr(function(i){var o=i.length,c=o?i[0]:0,g=this.__wrapped__,_=function(L){return vh(L,i)};return o>1||this.__actions__.length||!(g instanceof pt)||!Or(c)?this.thru(_):(g=g.slice(c,+c+(o?1:0)),g.__actions__.push({func:Pu,args:[_],thisArg:n}),new qn(g,this.__chain__).thru(function(L){return o&&!L.length&&L.push(n),L}))});function Ib(){return wd(this)}function Db(){return new qn(this.value(),this.__chain__)}function Ob(){this.__values__===n&&(this.__values__=Ud(this.value()));var i=this.__index__>=this.__values__.length,o=i?n:this.__values__[this.__index__++];return{done:i,value:o}}function Ub(){return this}function Fb(i){for(var o,c=this;c instanceof mu;){var g=dd(c);g.__index__=0,g.__values__=n,o?_.__wrapped__=g:o=g;var _=g;c=c.__wrapped__}return _.__wrapped__=i,o}function Nb(){var i=this.__wrapped__;if(i instanceof pt){var o=i;return this.__actions__.length&&(o=new pt(this)),o=o.reverse(),o.__actions__.push({func:Pu,args:[Wh],thisArg:n}),new qn(o,this.__chain__)}return this.thru(Wh)}function Bb(){return Np(this.__wrapped__,this.__actions__)}var zb=Eu(function(i,o,c){bt.call(i,c)?++i[c]:Pr(i,c,1)});function Gb(i,o,c){var g=Qe(i)?Jl:Cx;return c&&pn(i,o,c)&&(o=n),g(i,ze(o,3))}function Hb(i,o){var c=Qe(i)?jr:xp;return c(i,ze(o,3))}var Vb=jp(vd),Wb=jp(md);function kb(i,o){return on(Iu(i,o),1)}function Xb(i,o){return on(Iu(i,o),te)}function Yb(i,o,c){return c=c===n?1:tt(c),on(Iu(i,o),c)}function bd(i,o){var c=Qe(i)?Xn:Kr;return c(i,ze(o,3))}function Ed(i,o){var c=Qe(i)?c_:_p;return c(i,ze(o,3))}var qb=Eu(function(i,o,c){bt.call(i,c)?i[c].push(o):Pr(i,c,[o])});function jb(i,o,c,g){i=xn(i)?i:Ca(i),c=c&&!g?tt(c):0;var _=i.length;return c<0&&(c=en(_+c,0)),Nu(i)?c<=_&&i.indexOf(o,c)>-1:!!_&&ya(i,o,c)>-1}var Zb=ut(function(i,o,c){var g=-1,_=typeof o=="function",L=xn(i)?ne(i.length):[];return Kr(i,function(N){L[++g]=_?Rn(o,N,c):Gs(N,o,c)}),L}),Jb=Eu(function(i,o,c){Pr(i,c,o)});function Iu(i,o){var c=Qe(i)?Ot:Sp;return c(i,ze(o,3))}function Qb(i,o,c,g){return i==null?[]:(Qe(o)||(o=o==null?[]:[o]),c=g?n:c,Qe(c)||(c=c==null?[]:[c]),Cp(i,o,c))}var Kb=Eu(function(i,o,c){i[c?0:1].push(o)},function(){return[[],[]]});function $b(i,o,c){var g=Qe(i)?nh:ep,_=arguments.length<3;return g(i,ze(o,4),c,_,Kr)}function eE(i,o,c){var g=Qe(i)?l_:ep,_=arguments.length<3;return g(i,ze(o,4),c,_,_p)}function tE(i,o){var c=Qe(i)?jr:xp;return c(i,Uu(ze(o,3)))}function nE(i){var o=Qe(i)?vp:jx;return o(i)}function rE(i,o,c){(c?pn(i,o,c):o===n)?o=1:o=tt(o);var g=Qe(i)?Tx:Zx;return g(i,o)}function iE(i){var o=Qe(i)?Sx:Qx;return o(i)}function aE(i){if(i==null)return 0;if(xn(i))return Nu(i)?xa(i):i.length;var o=fn(i);return o==st||o==ot?i.size:wh(i).length}function sE(i,o,c){var g=Qe(i)?rh:Kx;return c&&pn(i,o,c)&&(o=n),g(i,ze(o,3))}var oE=ut(function(i,o){if(i==null)return[];var c=o.length;return c>1&&pn(i,o[0],o[1])?o=[]:c>2&&pn(o[0],o[1],o[2])&&(o=[o[0]]),Cp(i,on(o,1),[])}),Du=H_||function(){return sn.Date.now()};function uE(i,o){if(typeof o!="function")throw new Yn(u);return i=tt(i),function(){if(--i<1)return o.apply(this,arguments)}}function Md(i,o,c){return o=c?n:o,o=i&&o==null?i.length:o,Ir(i,U,n,n,n,n,o)}function Td(i,o){var c;if(typeof o!="function")throw new Yn(u);return i=tt(i),function(){return--i>0&&(c=o.apply(this,arguments)),i<=1&&(o=n),c}}var Xh=ut(function(i,o,c){var g=b;if(c.length){var _=Jr(c,La(Xh));g|=P}return Ir(i,g,o,c,_)}),Sd=ut(function(i,o,c){var g=b|w;if(c.length){var _=Jr(c,La(Sd));g|=P}return Ir(o,g,i,c,_)});function Ad(i,o,c){o=c?n:o;var g=Ir(i,T,n,n,n,n,n,o);return g.placeholder=Ad.placeholder,g}function Ld(i,o,c){o=c?n:o;var g=Ir(i,M,n,n,n,n,n,o);return g.placeholder=Ld.placeholder,g}function Rd(i,o,c){var g,_,L,N,H,j,ae=0,se=!1,ce=!1,ye=!0;if(typeof i!="function")throw new Yn(u);o=Qn(o)||0,Bt(c)&&(se=!!c.leading,ce="maxWait"in c,L=ce?en(Qn(c.maxWait)||0,o):L,ye="trailing"in c?!!c.trailing:ye);function De(Xt){var ur=g,Nr=_;return g=_=n,ae=Xt,N=i.apply(Nr,ur),N}function Ge(Xt){return ae=Xt,H=Xs(ct,o),se?De(Xt):N}function it(Xt){var ur=Xt-j,Nr=Xt-ae,jd=o-ur;return ce?un(jd,L-Nr):jd}function He(Xt){var ur=Xt-j,Nr=Xt-ae;return j===n||ur>=o||ur<0||ce&&Nr>=L}function ct(){var Xt=Du();if(He(Xt))return dt(Xt);H=Xs(ct,it(Xt))}function dt(Xt){return H=n,ye&&g?De(Xt):(g=_=n,N)}function Dn(){H!==n&&zp(H),ae=0,g=j=_=H=n}function dn(){return H===n?N:dt(Du())}function On(){var Xt=Du(),ur=He(Xt);if(g=arguments,_=this,j=Xt,ur){if(H===n)return Ge(j);if(ce)return zp(H),H=Xs(ct,o),De(j)}return H===n&&(H=Xs(ct,o)),N}return On.cancel=Dn,On.flush=dn,On}var fE=ut(function(i,o){return yp(i,1,o)}),hE=ut(function(i,o,c){return yp(i,Qn(o)||0,c)});function cE(i){return Ir(i,B)}function Ou(i,o){if(typeof i!="function"||o!=null&&typeof o!="function")throw new Yn(u);var c=function(){var g=arguments,_=o?o.apply(this,g):g[0],L=c.cache;if(L.has(_))return L.get(_);var N=i.apply(this,g);return c.cache=L.set(_,N)||L,N};return c.cache=new(Ou.Cache||Cr),c}Ou.Cache=Cr;function Uu(i){if(typeof i!="function")throw new Yn(u);return function(){var o=arguments;switch(o.length){case 0:return!i.call(this);case 1:return!i.call(this,o[0]);case 2:return!i.call(this,o[0],o[1]);case 3:return!i.call(this,o[0],o[1],o[2])}return!i.apply(this,o)}}function lE(i){return Td(2,i)}var pE=$x(function(i,o){o=o.length==1&&Qe(o[0])?Ot(o[0],Cn(ze())):Ot(on(o,1),Cn(ze()));var c=o.length;return ut(function(g){for(var _=-1,L=un(g.length,c);++_<L;)g[_]=o[_].call(this,g[_]);return Rn(i,this,g)})}),Yh=ut(function(i,o){var c=Jr(o,La(Yh));return Ir(i,P,n,o,c)}),Cd=ut(function(i,o){var c=Jr(o,La(Cd));return Ir(i,O,n,o,c)}),dE=Dr(function(i,o){return Ir(i,W,n,n,n,o)});function vE(i,o){if(typeof i!="function")throw new Yn(u);return o=o===n?o:tt(o),ut(i,o)}function mE(i,o){if(typeof i!="function")throw new Yn(u);return o=o==null?0:en(tt(o),0),ut(function(c){var g=c[o],_=ti(c,0,o);return g&&Zr(_,g),Rn(i,this,_)})}function gE(i,o,c){var g=!0,_=!0;if(typeof i!="function")throw new Yn(u);return Bt(c)&&(g="leading"in c?!!c.leading:g,_="trailing"in c?!!c.trailing:_),Rd(i,o,{leading:g,maxWait:o,trailing:_})}function yE(i){return Md(i,1)}function _E(i,o){return Yh(Ch(o),i)}function xE(){if(!arguments.length)return[];var i=arguments[0];return Qe(i)?i:[i]}function wE(i){return jn(i,m)}function bE(i,o){return o=typeof o=="function"?o:n,jn(i,m,o)}function EE(i){return jn(i,d|m)}function ME(i,o){return o=typeof o=="function"?o:n,jn(i,d|m,o)}function TE(i,o){return o==null||gp(i,o,rn(o))}function or(i,o){return i===o||i!==i&&o!==o}var SE=Au(yh),AE=Au(function(i,o){return i>=o}),Ii=Ep(function(){return arguments}())?Ep:function(i){return Gt(i)&&bt.call(i,"callee")&&!fp.call(i,"callee")},Qe=ne.isArray,LE=kl?Cn(kl):Fx;function xn(i){return i!=null&&Fu(i.length)&&!Ur(i)}function kt(i){return Gt(i)&&xn(i)}function RE(i){return i===!0||i===!1||Gt(i)&&ln(i)==Pe}var ni=W_||rc,CE=Xl?Cn(Xl):Nx;function PE(i){return Gt(i)&&i.nodeType===1&&!Ys(i)}function IE(i){if(i==null)return!0;if(xn(i)&&(Qe(i)||typeof i=="string"||typeof i.splice=="function"||ni(i)||Ra(i)||Ii(i)))return!i.length;var o=fn(i);if(o==st||o==ot)return!i.size;if(ks(i))return!wh(i).length;for(var c in i)if(bt.call(i,c))return!1;return!0}function DE(i,o){return Hs(i,o)}function OE(i,o,c){c=typeof c=="function"?c:n;var g=c?c(i,o):n;return g===n?Hs(i,o,n,c):!!g}function qh(i){if(!Gt(i))return!1;var o=ln(i);return o==Ze||o==Ie||typeof i.message=="string"&&typeof i.name=="string"&&!Ys(i)}function UE(i){return typeof i=="number"&&cp(i)}function Ur(i){if(!Bt(i))return!1;var o=ln(i);return o==ft||o==gt||o==J||o==mn}function Pd(i){return typeof i=="number"&&i==tt(i)}function Fu(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=$}function Bt(i){var o=typeof i;return i!=null&&(o=="object"||o=="function")}function Gt(i){return i!=null&&typeof i=="object"}var Id=Yl?Cn(Yl):zx;function FE(i,o){return i===o||xh(i,o,Nh(o))}function NE(i,o,c){return c=typeof c=="function"?c:n,xh(i,o,Nh(o),c)}function BE(i){return Dd(i)&&i!=+i}function zE(i){if(bw(i))throw new je(s);return Mp(i)}function GE(i){return i===null}function HE(i){return i==null}function Dd(i){return typeof i=="number"||Gt(i)&&ln(i)==Je}function Ys(i){if(!Gt(i)||ln(i)!=Et)return!1;var o=fu(i);if(o===null)return!0;var c=bt.call(o,"constructor")&&o.constructor;return typeof c=="function"&&c instanceof c&&au.call(c)==N_}var jh=ql?Cn(ql):Gx;function VE(i){return Pd(i)&&i>=-$&&i<=$}var Od=jl?Cn(jl):Hx;function Nu(i){return typeof i=="string"||!Qe(i)&&Gt(i)&&ln(i)==zt}function In(i){return typeof i=="symbol"||Gt(i)&&ln(i)==$e}var Ra=Zl?Cn(Zl):Vx;function WE(i){return i===n}function kE(i){return Gt(i)&&fn(i)==ge}function XE(i){return Gt(i)&&ln(i)==Me}var YE=Au(bh),qE=Au(function(i,o){return i<=o});function Ud(i){if(!i)return[];if(xn(i))return Nu(i)?ar(i):_n(i);if(Ds&&i[Ds])return T_(i[Ds]());var o=fn(i),c=o==st?fh:o==ot?nu:Ca;return c(i)}function Fr(i){if(!i)return i===0?i:0;if(i=Qn(i),i===te||i===-te){var o=i<0?-1:1;return o*ue}return i===i?i:0}function tt(i){var o=Fr(i),c=o%1;return o===o?c?o-c:o:0}function Fd(i){return i?Li(tt(i),0,oe):0}function Qn(i){if(typeof i=="number")return i;if(In(i))return he;if(Bt(i)){var o=typeof i.valueOf=="function"?i.valueOf():i;i=Bt(o)?o+"":o}if(typeof i!="string")return i===0?i:+i;i=tp(i);var c=Se.test(i);return c||Oe.test(i)?u_(i.slice(2),c?2:8):xe.test(i)?he:+i}function Nd(i){return _r(i,wn(i))}function jE(i){return i?Li(tt(i),-$,$):i===0?i:0}function xt(i){return i==null?"":Pn(i)}var ZE=Sa(function(i,o){if(ks(o)||xn(o)){_r(o,rn(o),i);return}for(var c in o)bt.call(o,c)&&Bs(i,c,o[c])}),Bd=Sa(function(i,o){_r(o,wn(o),i)}),Bu=Sa(function(i,o,c,g){_r(o,wn(o),i,g)}),JE=Sa(function(i,o,c,g){_r(o,rn(o),i,g)}),QE=Dr(vh);function KE(i,o){var c=Ta(i);return o==null?c:mp(c,o)}var $E=ut(function(i,o){i=St(i);var c=-1,g=o.length,_=g>2?o[2]:n;for(_&&pn(o[0],o[1],_)&&(g=1);++c<g;)for(var L=o[c],N=wn(L),H=-1,j=N.length;++H<j;){var ae=N[H],se=i[ae];(se===n||or(se,ba[ae])&&!bt.call(i,ae))&&(i[ae]=L[ae])}return i}),eM=ut(function(i){return i.push(n,td),Rn(zd,n,i)});function tM(i,o){return Ql(i,ze(o,3),yr)}function nM(i,o){return Ql(i,ze(o,3),gh)}function rM(i,o){return i==null?i:mh(i,ze(o,3),wn)}function iM(i,o){return i==null?i:wp(i,ze(o,3),wn)}function aM(i,o){return i&&yr(i,ze(o,3))}function sM(i,o){return i&&gh(i,ze(o,3))}function oM(i){return i==null?[]:_u(i,rn(i))}function uM(i){return i==null?[]:_u(i,wn(i))}function Zh(i,o,c){var g=i==null?n:Ri(i,o);return g===n?c:g}function fM(i,o){return i!=null&&id(i,o,Ix)}function Jh(i,o){return i!=null&&id(i,o,Dx)}var hM=Jp(function(i,o,c){o!=null&&typeof o.toString!="function"&&(o=su.call(o)),i[o]=c},Kh(bn)),cM=Jp(function(i,o,c){o!=null&&typeof o.toString!="function"&&(o=su.call(o)),bt.call(i,o)?i[o].push(c):i[o]=[c]},ze),lM=ut(Gs);function rn(i){return xn(i)?dp(i):wh(i)}function wn(i){return xn(i)?dp(i,!0):Wx(i)}function pM(i,o){var c={};return o=ze(o,3),yr(i,function(g,_,L){Pr(c,o(g,_,L),g)}),c}function dM(i,o){var c={};return o=ze(o,3),yr(i,function(g,_,L){Pr(c,_,o(g,_,L))}),c}var vM=Sa(function(i,o,c){xu(i,o,c)}),zd=Sa(function(i,o,c,g){xu(i,o,c,g)}),mM=Dr(function(i,o){var c={};if(i==null)return c;var g=!1;o=Ot(o,function(L){return L=ei(L,i),g||(g=L.length>1),L}),_r(i,Uh(i),c),g&&(c=jn(c,d|v|m,hw));for(var _=o.length;_--;)Ah(c,o[_]);return c});function gM(i,o){return Gd(i,Uu(ze(o)))}var yM=Dr(function(i,o){return i==null?{}:Xx(i,o)});function Gd(i,o){if(i==null)return{};var c=Ot(Uh(i),function(g){return[g]});return o=ze(o),Pp(i,c,function(g,_){return o(g,_[0])})}function _M(i,o,c){o=ei(o,i);var g=-1,_=o.length;for(_||(_=1,i=n);++g<_;){var L=i==null?n:i[xr(o[g])];L===n&&(g=_,L=c),i=Ur(L)?L.call(i):L}return i}function xM(i,o,c){return i==null?i:Vs(i,o,c)}function wM(i,o,c,g){return g=typeof g=="function"?g:n,i==null?i:Vs(i,o,c,g)}var Hd=$p(rn),Vd=$p(wn);function bM(i,o,c){var g=Qe(i),_=g||ni(i)||Ra(i);if(o=ze(o,4),c==null){var L=i&&i.constructor;_?c=g?new L:[]:Bt(i)?c=Ur(L)?Ta(fu(i)):{}:c={}}return(_?Xn:yr)(i,function(N,H,j){return o(c,N,H,j)}),c}function EM(i,o){return i==null?!0:Ah(i,o)}function MM(i,o,c){return i==null?i:Fp(i,o,Ch(c))}function TM(i,o,c,g){return g=typeof g=="function"?g:n,i==null?i:Fp(i,o,Ch(c),g)}function Ca(i){return i==null?[]:uh(i,rn(i))}function SM(i){return i==null?[]:uh(i,wn(i))}function AM(i,o,c){return c===n&&(c=o,o=n),c!==n&&(c=Qn(c),c=c===c?c:0),o!==n&&(o=Qn(o),o=o===o?o:0),Li(Qn(i),o,c)}function LM(i,o,c){return o=Fr(o),c===n?(c=o,o=0):c=Fr(c),i=Qn(i),Ox(i,o,c)}function RM(i,o,c){if(c&&typeof c!="boolean"&&pn(i,o,c)&&(o=c=n),c===n&&(typeof o=="boolean"?(c=o,o=n):typeof i=="boolean"&&(c=i,i=n)),i===n&&o===n?(i=0,o=1):(i=Fr(i),o===n?(o=i,i=0):o=Fr(o)),i>o){var g=i;i=o,o=g}if(c||i%1||o%1){var _=lp();return un(i+_*(o-i+o_("1e-"+((_+"").length-1))),o)}return Mh(i,o)}var CM=Aa(function(i,o,c){return o=o.toLowerCase(),i+(c?Wd(o):o)});function Wd(i){return Qh(xt(i).toLowerCase())}function kd(i){return i=xt(i),i&&i.replace(Xe,x_).replace(Q0,"")}function PM(i,o,c){i=xt(i),o=Pn(o);var g=i.length;c=c===n?g:Li(tt(c),0,g);var _=c;return c-=o.length,c>=0&&i.slice(c,_)==o}function IM(i){return i=xt(i),i&&ir.test(i)?i.replace(Hn,w_):i}function DM(i){return i=xt(i),i&&ha.test(i)?i.replace(mr,"\\$&"):i}var OM=Aa(function(i,o,c){return i+(c?"-":"")+o.toLowerCase()}),UM=Aa(function(i,o,c){return i+(c?" ":"")+o.toLowerCase()}),FM=qp("toLowerCase");function NM(i,o,c){i=xt(i),o=tt(o);var g=o?xa(i):0;if(!o||g>=o)return i;var _=(o-g)/2;return Su(pu(_),c)+i+Su(lu(_),c)}function BM(i,o,c){i=xt(i),o=tt(o);var g=o?xa(i):0;return o&&g<o?i+Su(o-g,c):i}function zM(i,o,c){i=xt(i),o=tt(o);var g=o?xa(i):0;return o&&g<o?Su(o-g,c)+i:i}function GM(i,o,c){return c||o==null?o=0:o&&(o=+o),q_(xt(i).replace(xi,""),o||0)}function HM(i,o,c){return(c?pn(i,o,c):o===n)?o=1:o=tt(o),Th(xt(i),o)}function VM(){var i=arguments,o=xt(i[0]);return i.length<3?o:o.replace(i[1],i[2])}var WM=Aa(function(i,o,c){return i+(c?"_":"")+o.toLowerCase()});function kM(i,o,c){return c&&typeof c!="number"&&pn(i,o,c)&&(o=c=n),c=c===n?oe:c>>>0,c?(i=xt(i),i&&(typeof o=="string"||o!=null&&!jh(o))&&(o=Pn(o),!o&&_a(i))?ti(ar(i),0,c):i.split(o,c)):[]}var XM=Aa(function(i,o,c){return i+(c?" ":"")+Qh(o)});function YM(i,o,c){return i=xt(i),c=c==null?0:Li(tt(c),0,i.length),o=Pn(o),i.slice(c,c+o.length)==o}function qM(i,o,c){var g=A.templateSettings;c&&pn(i,o,c)&&(o=n),i=xt(i),o=Bu({},o,g,ed);var _=Bu({},o.imports,g.imports,ed),L=rn(_),N=uh(_,L),H,j,ae=0,se=o.interpolate||Be,ce="__p += '",ye=hh((o.escape||Be).source+"|"+se.source+"|"+(se===_i?k:Be).source+"|"+(o.evaluate||Be).source+"|$","g"),De="//# sourceURL="+(bt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++n_+"]")+`
`;i.replace(ye,function(He,ct,dt,Dn,dn,On){return dt||(dt=Dn),ce+=i.slice(ae,On).replace(Le,b_),ct&&(H=!0,ce+=`' +
__e(`+ct+`) +
'`),dn&&(j=!0,ce+=`';
`+dn+`;
__p += '`),dt&&(ce+=`' +
((__t = (`+dt+`)) == null ? '' : __t) +
'`),ae=On+He.length,He}),ce+=`';
`;var Ge=bt.call(o,"variable")&&o.variable;if(!Ge)ce=`with (obj) {
`+ce+`
}
`;else if(R.test(Ge))throw new je(f);ce=(j?ce.replace(gn,""):ce).replace(Yr,"$1").replace(vr,"$1;"),ce="function("+(Ge||"obj")+`) {
`+(Ge?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(H?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ce+`return __p
}`;var it=Yd(function(){return _t(L,De+"return "+ce).apply(n,N)});if(it.source=ce,qh(it))throw it;return it}function jM(i){return xt(i).toLowerCase()}function ZM(i){return xt(i).toUpperCase()}function JM(i,o,c){if(i=xt(i),i&&(c||o===n))return tp(i);if(!i||!(o=Pn(o)))return i;var g=ar(i),_=ar(o),L=np(g,_),N=rp(g,_)+1;return ti(g,L,N).join("")}function QM(i,o,c){if(i=xt(i),i&&(c||o===n))return i.slice(0,ap(i)+1);if(!i||!(o=Pn(o)))return i;var g=ar(i),_=rp(g,ar(o))+1;return ti(g,0,_).join("")}function KM(i,o,c){if(i=xt(i),i&&(c||o===n))return i.replace(xi,"");if(!i||!(o=Pn(o)))return i;var g=ar(i),_=np(g,ar(o));return ti(g,_).join("")}function $M(i,o){var c=V,g=X;if(Bt(o)){var _="separator"in o?o.separator:_;c="length"in o?tt(o.length):c,g="omission"in o?Pn(o.omission):g}i=xt(i);var L=i.length;if(_a(i)){var N=ar(i);L=N.length}if(c>=L)return i;var H=c-xa(g);if(H<1)return g;var j=N?ti(N,0,H).join(""):i.slice(0,H);if(_===n)return j+g;if(N&&(H+=j.length-H),jh(_)){if(i.slice(H).search(_)){var ae,se=j;for(_.global||(_=hh(_.source,xt(fe.exec(_))+"g")),_.lastIndex=0;ae=_.exec(se);)var ce=ae.index;j=j.slice(0,ce===n?H:ce)}}else if(i.indexOf(Pn(_),H)!=H){var ye=j.lastIndexOf(_);ye>-1&&(j=j.slice(0,ye))}return j+g}function e1(i){return i=xt(i),i&&Ln.test(i)?i.replace(rr,R_):i}var t1=Aa(function(i,o,c){return i+(c?" ":"")+o.toUpperCase()}),Qh=qp("toUpperCase");function Xd(i,o,c){return i=xt(i),o=c?n:o,o===n?M_(i)?I_(i):v_(i):i.match(o)||[]}var Yd=ut(function(i,o){try{return Rn(i,n,o)}catch(c){return qh(c)?c:new je(c)}}),n1=Dr(function(i,o){return Xn(o,function(c){c=xr(c),Pr(i,c,Xh(i[c],i))}),i});function r1(i){var o=i==null?0:i.length,c=ze();return i=o?Ot(i,function(g){if(typeof g[1]!="function")throw new Yn(u);return[c(g[0]),g[1]]}):[],ut(function(g){for(var _=-1;++_<o;){var L=i[_];if(Rn(L[0],this,g))return Rn(L[1],this,g)}})}function i1(i){return Rx(jn(i,d))}function Kh(i){return function(){return i}}function a1(i,o){return i==null||i!==i?o:i}var s1=Zp(),o1=Zp(!0);function bn(i){return i}function $h(i){return Tp(typeof i=="function"?i:jn(i,d))}function u1(i){return Ap(jn(i,d))}function f1(i,o){return Lp(i,jn(o,d))}var h1=ut(function(i,o){return function(c){return Gs(c,i,o)}}),c1=ut(function(i,o){return function(c){return Gs(i,c,o)}});function ec(i,o,c){var g=rn(o),_=_u(o,g);c==null&&!(Bt(o)&&(_.length||!g.length))&&(c=o,o=i,i=this,_=_u(o,rn(o)));var L=!(Bt(c)&&"chain"in c)||!!c.chain,N=Ur(i);return Xn(_,function(H){var j=o[H];i[H]=j,N&&(i.prototype[H]=function(){var ae=this.__chain__;if(L||ae){var se=i(this.__wrapped__),ce=se.__actions__=_n(this.__actions__);return ce.push({func:j,args:arguments,thisArg:i}),se.__chain__=ae,se}return j.apply(i,Zr([this.value()],arguments))})}),i}function l1(){return sn._===this&&(sn._=B_),this}function tc(){}function p1(i){return i=tt(i),ut(function(o){return Rp(o,i)})}var d1=Ih(Ot),v1=Ih(Jl),m1=Ih(rh);function qd(i){return zh(i)?ih(xr(i)):Yx(i)}function g1(i){return function(o){return i==null?n:Ri(i,o)}}var y1=Qp(),_1=Qp(!0);function nc(){return[]}function rc(){return!1}function x1(){return{}}function w1(){return""}function b1(){return!0}function E1(i,o){if(i=tt(i),i<1||i>$)return[];var c=oe,g=un(i,oe);o=ze(o),i-=oe;for(var _=oh(g,o);++c<i;)o(c);return _}function M1(i){return Qe(i)?Ot(i,xr):In(i)?[i]:_n(pd(xt(i)))}function T1(i){var o=++F_;return xt(i)+o}var S1=Tu(function(i,o){return i+o},0),A1=Dh("ceil"),L1=Tu(function(i,o){return i/o},1),R1=Dh("floor");function C1(i){return i&&i.length?yu(i,bn,yh):n}function P1(i,o){return i&&i.length?yu(i,ze(o,2),yh):n}function I1(i){return $l(i,bn)}function D1(i,o){return $l(i,ze(o,2))}function O1(i){return i&&i.length?yu(i,bn,bh):n}function U1(i,o){return i&&i.length?yu(i,ze(o,2),bh):n}var F1=Tu(function(i,o){return i*o},1),N1=Dh("round"),B1=Tu(function(i,o){return i-o},0);function z1(i){return i&&i.length?sh(i,bn):0}function G1(i,o){return i&&i.length?sh(i,ze(o,2)):0}return A.after=uE,A.ary=Md,A.assign=ZE,A.assignIn=Bd,A.assignInWith=Bu,A.assignWith=JE,A.at=QE,A.before=Td,A.bind=Xh,A.bindAll=n1,A.bindKey=Sd,A.castArray=xE,A.chain=wd,A.chunk=Rw,A.compact=Cw,A.concat=Pw,A.cond=r1,A.conforms=i1,A.constant=Kh,A.countBy=zb,A.create=KE,A.curry=Ad,A.curryRight=Ld,A.debounce=Rd,A.defaults=$E,A.defaultsDeep=eM,A.defer=fE,A.delay=hE,A.difference=Iw,A.differenceBy=Dw,A.differenceWith=Ow,A.drop=Uw,A.dropRight=Fw,A.dropRightWhile=Nw,A.dropWhile=Bw,A.fill=zw,A.filter=Hb,A.flatMap=kb,A.flatMapDeep=Xb,A.flatMapDepth=Yb,A.flatten=gd,A.flattenDeep=Gw,A.flattenDepth=Hw,A.flip=cE,A.flow=s1,A.flowRight=o1,A.fromPairs=Vw,A.functions=oM,A.functionsIn=uM,A.groupBy=qb,A.initial=kw,A.intersection=Xw,A.intersectionBy=Yw,A.intersectionWith=qw,A.invert=hM,A.invertBy=cM,A.invokeMap=Zb,A.iteratee=$h,A.keyBy=Jb,A.keys=rn,A.keysIn=wn,A.map=Iu,A.mapKeys=pM,A.mapValues=dM,A.matches=u1,A.matchesProperty=f1,A.memoize=Ou,A.merge=vM,A.mergeWith=zd,A.method=h1,A.methodOf=c1,A.mixin=ec,A.negate=Uu,A.nthArg=p1,A.omit=mM,A.omitBy=gM,A.once=lE,A.orderBy=Qb,A.over=d1,A.overArgs=pE,A.overEvery=v1,A.overSome=m1,A.partial=Yh,A.partialRight=Cd,A.partition=Kb,A.pick=yM,A.pickBy=Gd,A.property=qd,A.propertyOf=g1,A.pull=Qw,A.pullAll=_d,A.pullAllBy=Kw,A.pullAllWith=$w,A.pullAt=eb,A.range=y1,A.rangeRight=_1,A.rearg=dE,A.reject=tE,A.remove=tb,A.rest=vE,A.reverse=Wh,A.sampleSize=rE,A.set=xM,A.setWith=wM,A.shuffle=iE,A.slice=nb,A.sortBy=oE,A.sortedUniq=fb,A.sortedUniqBy=hb,A.split=kM,A.spread=mE,A.tail=cb,A.take=lb,A.takeRight=pb,A.takeRightWhile=db,A.takeWhile=vb,A.tap=Cb,A.throttle=gE,A.thru=Pu,A.toArray=Ud,A.toPairs=Hd,A.toPairsIn=Vd,A.toPath=M1,A.toPlainObject=Nd,A.transform=bM,A.unary=yE,A.union=mb,A.unionBy=gb,A.unionWith=yb,A.uniq=_b,A.uniqBy=xb,A.uniqWith=wb,A.unset=EM,A.unzip=kh,A.unzipWith=xd,A.update=MM,A.updateWith=TM,A.values=Ca,A.valuesIn=SM,A.without=bb,A.words=Xd,A.wrap=_E,A.xor=Eb,A.xorBy=Mb,A.xorWith=Tb,A.zip=Sb,A.zipObject=Ab,A.zipObjectDeep=Lb,A.zipWith=Rb,A.entries=Hd,A.entriesIn=Vd,A.extend=Bd,A.extendWith=Bu,ec(A,A),A.add=S1,A.attempt=Yd,A.camelCase=CM,A.capitalize=Wd,A.ceil=A1,A.clamp=AM,A.clone=wE,A.cloneDeep=EE,A.cloneDeepWith=ME,A.cloneWith=bE,A.conformsTo=TE,A.deburr=kd,A.defaultTo=a1,A.divide=L1,A.endsWith=PM,A.eq=or,A.escape=IM,A.escapeRegExp=DM,A.every=Gb,A.find=Vb,A.findIndex=vd,A.findKey=tM,A.findLast=Wb,A.findLastIndex=md,A.findLastKey=nM,A.floor=R1,A.forEach=bd,A.forEachRight=Ed,A.forIn=rM,A.forInRight=iM,A.forOwn=aM,A.forOwnRight=sM,A.get=Zh,A.gt=SE,A.gte=AE,A.has=fM,A.hasIn=Jh,A.head=yd,A.identity=bn,A.includes=jb,A.indexOf=Ww,A.inRange=LM,A.invoke=lM,A.isArguments=Ii,A.isArray=Qe,A.isArrayBuffer=LE,A.isArrayLike=xn,A.isArrayLikeObject=kt,A.isBoolean=RE,A.isBuffer=ni,A.isDate=CE,A.isElement=PE,A.isEmpty=IE,A.isEqual=DE,A.isEqualWith=OE,A.isError=qh,A.isFinite=UE,A.isFunction=Ur,A.isInteger=Pd,A.isLength=Fu,A.isMap=Id,A.isMatch=FE,A.isMatchWith=NE,A.isNaN=BE,A.isNative=zE,A.isNil=HE,A.isNull=GE,A.isNumber=Dd,A.isObject=Bt,A.isObjectLike=Gt,A.isPlainObject=Ys,A.isRegExp=jh,A.isSafeInteger=VE,A.isSet=Od,A.isString=Nu,A.isSymbol=In,A.isTypedArray=Ra,A.isUndefined=WE,A.isWeakMap=kE,A.isWeakSet=XE,A.join=jw,A.kebabCase=OM,A.last=Jn,A.lastIndexOf=Zw,A.lowerCase=UM,A.lowerFirst=FM,A.lt=YE,A.lte=qE,A.max=C1,A.maxBy=P1,A.mean=I1,A.meanBy=D1,A.min=O1,A.minBy=U1,A.stubArray=nc,A.stubFalse=rc,A.stubObject=x1,A.stubString=w1,A.stubTrue=b1,A.multiply=F1,A.nth=Jw,A.noConflict=l1,A.noop=tc,A.now=Du,A.pad=NM,A.padEnd=BM,A.padStart=zM,A.parseInt=GM,A.random=RM,A.reduce=$b,A.reduceRight=eE,A.repeat=HM,A.replace=VM,A.result=_M,A.round=N1,A.runInContext=Y,A.sample=nE,A.size=aE,A.snakeCase=WM,A.some=sE,A.sortedIndex=rb,A.sortedIndexBy=ib,A.sortedIndexOf=ab,A.sortedLastIndex=sb,A.sortedLastIndexBy=ob,A.sortedLastIndexOf=ub,A.startCase=XM,A.startsWith=YM,A.subtract=B1,A.sum=z1,A.sumBy=G1,A.template=qM,A.times=E1,A.toFinite=Fr,A.toInteger=tt,A.toLength=Fd,A.toLower=jM,A.toNumber=Qn,A.toSafeInteger=jE,A.toString=xt,A.toUpper=ZM,A.trim=JM,A.trimEnd=QM,A.trimStart=KM,A.truncate=$M,A.unescape=e1,A.uniqueId=T1,A.upperCase=t1,A.upperFirst=Qh,A.each=bd,A.eachRight=Ed,A.first=yd,ec(A,function(){var i={};return yr(A,function(o,c){bt.call(A.prototype,c)||(i[c]=o)}),i}(),{chain:!1}),A.VERSION=r,Xn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){A[i].placeholder=A}),Xn(["drop","take"],function(i,o){pt.prototype[i]=function(c){c=c===n?1:en(tt(c),0);var g=this.__filtered__&&!o?new pt(this):this.clone();return g.__filtered__?g.__takeCount__=un(c,g.__takeCount__):g.__views__.push({size:un(c,oe),type:i+(g.__dir__<0?"Right":"")}),g},pt.prototype[i+"Right"]=function(c){return this.reverse()[i](c).reverse()}}),Xn(["filter","map","takeWhile"],function(i,o){var c=o+1,g=c==D||c==K;pt.prototype[i]=function(_){var L=this.clone();return L.__iteratees__.push({iteratee:ze(_,3),type:c}),L.__filtered__=L.__filtered__||g,L}}),Xn(["head","last"],function(i,o){var c="take"+(o?"Right":"");pt.prototype[i]=function(){return this[c](1).value()[0]}}),Xn(["initial","tail"],function(i,o){var c="drop"+(o?"":"Right");pt.prototype[i]=function(){return this.__filtered__?new pt(this):this[c](1)}}),pt.prototype.compact=function(){return this.filter(bn)},pt.prototype.find=function(i){return this.filter(i).head()},pt.prototype.findLast=function(i){return this.reverse().find(i)},pt.prototype.invokeMap=ut(function(i,o){return typeof i=="function"?new pt(this):this.map(function(c){return Gs(c,i,o)})}),pt.prototype.reject=function(i){return this.filter(Uu(ze(i)))},pt.prototype.slice=function(i,o){i=tt(i);var c=this;return c.__filtered__&&(i>0||o<0)?new pt(c):(i<0?c=c.takeRight(-i):i&&(c=c.drop(i)),o!==n&&(o=tt(o),c=o<0?c.dropRight(-o):c.take(o-i)),c)},pt.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},pt.prototype.toArray=function(){return this.take(oe)},yr(pt.prototype,function(i,o){var c=/^(?:filter|find|map|reject)|While$/.test(o),g=/^(?:head|last)$/.test(o),_=A[g?"take"+(o=="last"?"Right":""):o],L=g||/^find/.test(o);_&&(A.prototype[o]=function(){var N=this.__wrapped__,H=g?[1]:arguments,j=N instanceof pt,ae=H[0],se=j||Qe(N),ce=function(ct){var dt=_.apply(A,Zr([ct],H));return g&&ye?dt[0]:dt};se&&c&&typeof ae=="function"&&ae.length!=1&&(j=se=!1);var ye=this.__chain__,De=!!this.__actions__.length,Ge=L&&!ye,it=j&&!De;if(!L&&se){N=it?N:new pt(this);var He=i.apply(N,H);return He.__actions__.push({func:Pu,args:[ce],thisArg:n}),new qn(He,ye)}return Ge&&it?i.apply(this,H):(He=this.thru(ce),Ge?g?He.value()[0]:He.value():He)})}),Xn(["pop","push","shift","sort","splice","unshift"],function(i){var o=ru[i],c=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",g=/^(?:pop|shift)$/.test(i);A.prototype[i]=function(){var _=arguments;if(g&&!this.__chain__){var L=this.value();return o.apply(Qe(L)?L:[],_)}return this[c](function(N){return o.apply(Qe(N)?N:[],_)})}}),yr(pt.prototype,function(i,o){var c=A[o];if(c){var g=c.name+"";bt.call(Ma,g)||(Ma[g]=[]),Ma[g].push({name:o,func:c})}}),Ma[Mu(n,w).name]=[{name:"wrapper",func:n}],pt.prototype.clone=ex,pt.prototype.reverse=tx,pt.prototype.value=nx,A.prototype.at=Pb,A.prototype.chain=Ib,A.prototype.commit=Db,A.prototype.next=Ob,A.prototype.plant=Fb,A.prototype.reverse=Nb,A.prototype.toJSON=A.prototype.valueOf=A.prototype.value=Bb,A.prototype.first=A.prototype.head,Ds&&(A.prototype[Ds]=Ub),A},wa=D_();Mi?((Mi.exports=wa)._=wa,$f._=wa):sn._=wa}).call(ws)}(Ko,Ko.exports),Ko.exports;const G0=5,H0=1;function V0(e,t){const{spline:n}=P0(e),r=new Xi(n,A0,H0,G0,!1);r.setDrawRange(0,0),this.mesh=new jt(r,t);const a=new Yi(2,32,32),s=new vn({color:16777215}),u=new jt(a,s),f=new jt(a,s),h=n.getPointAt(0),l=n.getPointAt(1);u.position.copy(h),f.position.copy(l),this.mesh.add(u),this.mesh.add(f),this.drawStart=0,this.drawEnd=0,this.drawRangeIncrement=30,this.boxDrawEnd=0,this.boxRangeIncrement=5,this.updateDrawRange=()=>{this.drawEnd+=this.drawRangeIncrement,r.setDrawRange(Math.min(this.drawStart,this.drawEnd),Math.max(this.drawStart,this.drawEnd))}}function W0(e,t){const n=new jt,r=[];nr.add(n),O0(t.container,()=>{e.forEach((a,s)=>{const u=new vn({blending:Hu,opacity:1,transparent:!1,color:268435455}),f=new V0(a.coordinates,u);n.add(f.mesh),setTimeout(()=>{r.push(f.mesh),Ar.paths.push({data:a,path:f})},100*s)})})}function k0(e,t){U0(e,t),z0(),setTimeout(()=>{let n=[];if(t.jsonTemplateId){const r=document.getElementById(t.jsonTemplateId);n=JSON.parse(r.innerHTML)}W0(n,{container:e})},500)}function X0(e){const t={};try{const n=new URL(e);for(const[r,a]of n.searchParams.entries())t[r]=a}catch(n){return console.error("Error parsing URL:",n),t}return t}let ua={};if(window.document.currentScript){const e=window.document.currentScript.src;ua=X0(e)}const Gl=document.getElementById(ua.containerId||"root-globe");Gl&&k0(Gl,{labelTemplateId:ua.labelTemplateId,jsonTemplateId:ua.jsonTemplateId,zoomLevel:parseInt(ua.zoomLevel),rotationSpeed:parseInt(ua.rotationSpeed)})})();
